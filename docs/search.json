[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "GEOU9SP GIS Workbook",
    "section": "",
    "text": "Welcome!\nThis e-book was created as a lab companion for the GEOU9SP - Geographic Information Systems module at University of Stirling. It contains all the practical exercises that will be covered throughout the module.\nThis book is not a replacement to Canvas, so make sure you are engaging with the material on Canvas on a weekly basis!\nThe content of this book is organised into sections, which will correspond to the teaching weeks and practical lab sessions. You will always see the main content in the center window, with a detailed menu covering all entries in the book on the left, and a chapter-specific table of contents on the right. The Canvas pages for each lab session will always link to the corresponding chapter in this book.\nIf you have any questions follow the instructions on Canvas on how to contact the module coordinator.\nYou can download PDf versions of each week’s material from here",
    "crumbs": [
      "Welcome!"
    ]
  },
  {
    "objectID": "sec_w1_intro_toGIS.html",
    "href": "sec_w1_intro_toGIS.html",
    "title": "Week 1 - Introduction",
    "section": "",
    "text": "ILOs covered",
    "crumbs": [
      "Week 1 - Introduction"
    ]
  },
  {
    "objectID": "sec_w1_intro_toGIS.html#ilos-covered",
    "href": "sec_w1_intro_toGIS.html#ilos-covered",
    "title": "Week 1 - Introduction",
    "section": "",
    "text": "Understand the structure of spatial data and choose appropriate data types and models for storing and representing it;\nObtain and assess the quality of spatial data from online and offline sources and produce new spatial data using computer and field methods;\nCreate map visualisations that adhere to cartographic principles and can be easily and unambiguously interpreted by the non-specialist public;",
    "crumbs": [
      "Week 1 - Introduction"
    ]
  },
  {
    "objectID": "sec_w1_intro_toGIS.html#what-will-you-learn",
    "href": "sec_w1_intro_toGIS.html#what-will-you-learn",
    "title": "Week 1 - Introduction",
    "section": "What will you learn",
    "text": "What will you learn\nFor every week, we will list the main theoretical and practical learning goals. Use these as a ‘checklist’ to gauge your learning for each week. If you don’t feel confident you have learned any specific topic, then revisit the week’s material!\n\nTheoretical knowledge for Week 1:\n\nWhat are Geomatics, GIS, Remote Sensing and associated terms and fields?\nWhat is spatial data?\nWhat is a datum?\nWhat is a map projection?\nWhat is a Coordinate Reference System?\n\n\n\nPractical knowledge:\n1  Lab 1: QGIS overview and file management\n\nHow to launch QGIS\nHow to load a spatial data file\nHow to navigate the main QGIS interface\nHow to identify features\nHow to do basic measurements\nHow to do basic styling of spatial data\nHow to enter the layout editor\nHow to make and export a simple map layout\n\n2  Lab 2: Coordinate Reference Systems\n\nHow to check the Coordinate Reference System of a spatial file\nHow to set the CRS of a QGIS project\nHow to set the CRS of a spatial file when it is already known.\nHow to reproject(convert) a spatial file from one CRS to another\nWhat are the main CRSs you should be familiar with.",
    "crumbs": [
      "Week 1 - Introduction"
    ]
  },
  {
    "objectID": "lab_intro.html",
    "href": "lab_intro.html",
    "title": "1  Lab 1: QGIS overview and file management",
    "section": "",
    "text": "1.1 Before you start!",
    "crumbs": [
      "Week 1 - Introduction",
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Lab 1: QGIS overview and file management</span>"
    ]
  },
  {
    "objectID": "lab_intro.html#before-you-start",
    "href": "lab_intro.html#before-you-start",
    "title": "1  Lab 1: QGIS overview and file management",
    "section": "",
    "text": "Go through the Week 1 preparatory session on Canvas, and watch the seminar recording if you have missed it.\nRead this document to understand how the British National Grid indexing system works.",
    "crumbs": [
      "Week 1 - Introduction",
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Lab 1: QGIS overview and file management</span>"
    ]
  },
  {
    "objectID": "lab_intro.html#GE1",
    "href": "lab_intro.html#GE1",
    "title": "1  Lab 1: QGIS overview and file management",
    "section": "1.2 Guided Exercise 1 - Managing and loading files",
    "text": "1.2 Guided Exercise 1 - Managing and loading files\nIn this exercise, you will download some data, prepare a folder structure to organise the files in your GIS projects, then create a QGIS project file and add some GIS data to it.\n\n1.2.1 Downloading the required data\nFor this practical you will use the “OS open road” and “OS Terrain 50 Digital Terrain Model” spatial datasets, specifically for the NS89 tile of the Ordnance Survey British National Grid. (Read about what these datasets are here: OS Open Roads , OS Terrain 50).\n\nHead to the Digimap website, and if you haven’t already, make sure you accept the user licenses for all datasets, as show on the instructions video avaiable on Canvas.\nGo the Ordnance Survey section of the site, and then pick the View maps and download data option on the right.\nFollowing the steps shown on the instructions video, download the following datasets for the NS89 BNG tile only:\n\n\nOS Open Roads (under Vector Data) - choose the SHP format\n“OS Terrain 50 Digital Terrain Model” (NOT Terrain 5 and NOT Contours!, under Land and Height Data) - choose the ASC format\n\nIf you have correctly searched for tile NS89 and checked the required datatsets, you will see a screen like this:\n\n\n\n1.2.2 Creating a project structure\nGIS projects generate a lot of different files, and quickly, so project organization is essential. The folder structure below is my personal suggestion for organizing GIS projects files and associated data. As you get comfortable managing your own projects, feel free to change the organization structure to something that best suits your own workflow and the specific project you are working on!\n\nCreate a folder on your computer with the module name (GEOU9SP), off of your main work folder. For Windows this will usually be Documents. For Linux and Mac, create it on you home folder. (If you prefer and are comfortable with saving at another location on your computer, go for it!)\n\nWindows:\n\nmac OS:\n\n\n\n\n\n\n\nWarning\n\n\n\n\nHaving complex file paths can sometimes create problems. That is why we try to keep our main projects on a base folder. If you would like to keep a copy of your data on your OneDrive folder you are encouraged to do so, but I don’t recommend working directly from it. That is because the full path to a OneDrive folder will to be very long and likely contain spaces. Mine, for example is C:\\Users\\Thiago\\OneDrive - University of Stirling\\Documents. Those spaces in the name may create problems later. So I recommend instead to copy the completed lab data to your OneDrive folder at the end of each lab.\nFor the same reason, never use spaces or special symbols on your folder and file names. Limit yourself to using letters A-Z and a-z, numbers 1-9 and just the underline (_) and dash (-) symbols.\nWindows does not differentiate letter case, so if you create a file named filename1.txt and then a second file named Filename1.txt in the same folder, the second will overwrite the first. Mac OS does differentiate upper and lower case letters, so Filename1.txt and filename1.txt are considered different names and can co-exist in the same folder.\n\n\n\n\nInside the new GEOU9SP folder, create a subfolder called lab_1 (notice I am avoiding spaces by using the underline)\nInside lab_1, create the following folder structure. On the diagram below, the folder raster is a folder inside the folder 01_raw_data, which is inside lab_1 and so on.\n\n.\n└── GEOU9SP/\n    └── lab_1/\n        ├── 00_qgis\n        ├── 01_raw_data/\n        │   ├── raster\n        │   └── vector\n        ├── 02_processing\n        ├── 03_final_products\n        └── 04_notes\nI like to start folder names start with double digits so they are kept in order. These folders will be used as follows:\n\n00_qgis: we will use this folder to save our QGIS project files.\n01_raw_data: this folder will keep all the original data files you download. This way you can always go back to the start if something goes wrong. You can optionally use the subfolders vector and raster to easily know which kind of data you are working with, but this may not be necessary for small projects. As you obtain data you will create additional subfolders for each individual dataset to keep data organized.\n02_processing: here we will keep all the intermediate files you generate as part of your work. Make ample use of subfolders to identify each step of the workflow.\n03_final_products: here we will keep the final products of our intended analysis. This makes it easy for us to find the latest version of our final results, without risking confusing it with intermediate files. This can also include maps, reports and any other ’deliverable’resulting from your analysis.\n04_notes: here we will keep all our non-GIS files. For example, it may be a good idea to keep a text file documenting the project steps as you work on it. You could also save here screen grabs of specific steps. Again, use subfolders as needed to keep your data tidy.\n\n\nNow move the data you’ve downloaded into your organized project folders and extract (unzip) them if necessary. The terrain data folder (terrain-50-dtm_xxxxxxx) should go into the raster folder within 01_raw_data and the roads folder (open-roads_xxxxxxx) into the vector folder. The citations_orders.xxxx.txt and contents_order_xxx text files should go into your 04_notes folder. Your folder structure should look like this:\n\n.\n└── GEOU9SP/\n    └── lab_1/\n        ├── 00_qgis\n        ├── 01_raw_data/\n        │   ├── raster/\n        │   │   └── OS_terrain_50/\n        │   │       └── ...\n        │   └── vector/\n        │       └── OS_roads/\n        │           └── ...\n        ├── 02_processing\n        ├── 03_final_products\n        └── 04_notes\n\n\n\n\n\n\nStop and Think\n\n\n\nWhat are the citations_orders.xxxx.txt and contents_order_xxx files? What information do they contain?\n\n\n\n\n\n\n\n\nClick for answer\n\n\n\n\n\nThey are both plain text files. citations_orders.xxxx.txt is very handy as it gives us the proper way to cite the data sources on reports. contents_order_xxx is just a summary of your Digimap order.\n\n\n\n\nStart a new text file (a Word .doc file or a Notepad .txt file) in your 04_notes folder, and write a few lines documenting the steps you took until now. If you prefer handwritten notes on a paper notebook, feel free to use it instead! The important thing is to keep track of the steps you are taking. As projects get more complicated, it is easy to forget which steps we took, and in what order!\n\n\n\n1.2.3 Creating a QGIS project and adding data to it\nA QGIS project is a file, which will remember all the data layers you have loaded, their stacking order, the styling of each layer, and some other information such as the coordinate reference system. It will also keep any map layouts that you create. But he project file will NOT store the data files themselves!!. It will only link to the data. That is why we need good project folder organisation. If a data file is moved or renamed, the QGIS project file will lose track of it.\n\nCreate a new project in QGIS by clicking on Project &gt; New... or pressing Ctrl-N:\n\n\n\nAdd to your project the layers NS_RoadLink.shp from the OS Roads dataset and the NS89.asc terrain data from your organized project folders. Don’t worry if the extents don’t match - it’s just that the OS DEM and the OS Roads are distributed in different sized ‘chunks’.\nSave your project inside the 00_qgis folder. You can save your project by clicking on the Save button, going to Project &gt; Save menu, or by holding the keys Ctrl+S (Command+S on Mac).\nOpen the project settings by clicking on the menu Project &gt; Properties.... You will then see this window:\n\n\n\nThe main things to set on your new project are the project home folder, the coordinate reference system (CRS) and the measurement units.\n\nAs the project home on the General tab, select the lab_1 folder you created. This helps quick navigation when opening and saving data.\nFor measurement units, make sure distance units are set in meters, and area units in squared meters, also on the General tab. Any QGIS operations that calculate distances or areas will use the units set by the project.\n\n\n\nFor the CRS, go to the CRS tab (to the left) and search for 27700 in the Filter box. That is the EPSG code that identifies the OSGB 1936 British National Grid coordinate reference system (CRS). Select it by clicking on it - you may need to expand your search results by clicking on the small arrows besides Projected and Transverse Mercator.\n\n\n\n\n\n\n\nNote\n\n\n\nEPSG stands for “European Petroleum Survey Group”, and designates a database with standard codes for hundreds of coordinate reference systems. Over time, you will probably memorize the EPSG codes for the CRSs you use more often.\n\n\n\nSave your project again.",
    "crumbs": [
      "Week 1 - Introduction",
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Lab 1: QGIS overview and file management</span>"
    ]
  },
  {
    "objectID": "lab_intro.html#guided-exercise-2---organizing-and-styling-your-layers",
    "href": "lab_intro.html#guided-exercise-2---organizing-and-styling-your-layers",
    "title": "1  Lab 1: QGIS overview and file management",
    "section": "1.3 Guided Exercise 2 - Organizing and styling your layers",
    "text": "1.3 Guided Exercise 2 - Organizing and styling your layers\nOne of the most powerful aspects of GIS software is the ability to style spatial data in very specific ways, by specifying colors, line widths, line types, simbols, etc. As we progress in the module you will learn more and more ways to style your data.\n\nOn the Layers panel to the left of the screen, select the NS89 layer, and drag it to the bottom of the layers list if not there already.\nTurn the roads layer off for now, by unchecking the box besides its name.\nRight-click on the NS89 layer name and choose Rename Layer. Rename it to Digital Elevation Model (50m).\nOpen the file explorer in your system, and find the NS89.asc file that holds the actual elevation data, which you downloaded from Digimap.\n\n\n\n\n\n\n\nStop and Think\n\n\n\nWill changing a layer name in the layer panel also change the name of the source data file for that layer?\n\n\n\n\n\n\n\n\nClick for answer\n\n\n\n\n\nNo, layer names within the project are independent of file names - but as default QGIS will use the file name as layer name when you add new data. But you should always change them into nice, readable and properly spelled names within your project, where you are free to use spaces. The actual file name linked by the project will stay the same and can always be seen by right-clicking on the layer name and selecting Properties...&gt; Information.\n\n\n\n\nRight click on the newly renamed terrain layer and choose Zoom to Layer. This is a very handy tool to “find yourself” if you end up zooming or panning the map too far.\nRight click on the terrain layer name again and select Properties..., then go to the Symbology tab.\nOn the Min and Max boxes, type 0 and 500 respectively. This determines the range of layer values to be visualised.\nSelect Rendering type to be Single Band Pseudocolor, and change the Color ramp option by clicling on the down-arrow button to the right and picking the spectral colour ramp. If you click on the colour ramp itself it will open a new window to custmize it. This is now what we need for now, so just close it and use the down-arrow.\nClick on Classify (under the dropdown menu that says * Mode: continuous*). The colours will be matched to the range of elevation values in the layer.\nClick again on the little down-arrow button beside the colour palette button and select Invert Color Ramp at the top of the options, so that the lowest heights are coloured blue. Then click on OK.\nNote how the legend for you terrain layer has changed on the Layers panel. it now shows the minimum and maximum elevations and the colour ramp. Save your project.\n\n\n\n\n\n\n\nStop and Think\n\n\n\nWhy do we bother inverting the colour ramp for this dataset?\n\n\n\n\n\n\n\n\nClick for answer\n\n\n\n\n\nWe should always try to use colours that reinforce map interpretation. The color blue is usually associated with water, and water accumulates on the lowest elevations, so setting the lowest elevations to blue helps map users read and interpret the map.\n\n\n\n\nRename the NS_RoadLink layer to Road Network.\nGo to its Symbology properties, like you did for the terrain layer, Notice that the symbology options are data-specific (vector vs. raster). Seclet Simple Line in the symbology window (under the main Line option). Then under the window, go to the Color option an click on the down-arrow menu to change the line color to a dark grey. If you click on the actual colour, a more complex colour-picking window will appear. You can use either the quicker colour dropdown or the main colour window, whatever you prefer.\nChange the Stroke width (line width) to 0.3. Click OK. Reactivate the layer if needed to visualise it.",
    "crumbs": [
      "Week 1 - Introduction",
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Lab 1: QGIS overview and file management</span>"
    ]
  },
  {
    "objectID": "lab_intro.html#guided-exercise-3-processing-data-using-gis-operations",
    "href": "lab_intro.html#guided-exercise-3-processing-data-using-gis-operations",
    "title": "1  Lab 1: QGIS overview and file management",
    "section": "1.4 Guided Exercise 3: Processing data using GIS operations",
    "text": "1.4 Guided Exercise 3: Processing data using GIS operations\nThe core of GIS work is to use the many built-in operations (also known as functions or tools) of GIS software to process the data in some way, and thus create additional information. For this exercise, we will use an operation that creates a new layer representing the boundaries of the terrain data layer, and then use a second operation to cut the roads layer to the same shape and extent as this new layer.\n\nGo to the Vector menu and select Research Tools &gt; Extract Layer Extent.... Select the terrain layer as your Input layer, and click Run to generate a temporary layer. Temporary layers are not kept once you close QGIS, unless you save it manually later. The Extract Layer Extent window will not close automatically after you run the operation, so click on Close when you are done.\nGo to Vector &gt; Geoprocessing Tools &gt; Clip.... Select the roads layer as the Input Layer and the new temporary layer as the Overlay Layer.\nThis time, we will save the output. Click on the ... button to the right of the Clipped text box, and then choose Save to file. Save your new layer on the folder GEOU9SP/lab_1/02_processing/, naming it clipped_roads.shp. Make sure the SHP file format is selected below the file name. Then click on Run to execute the operation. Close the window.\nTurn the original roads layer on and off to see the result of your operation. Then right-click on the original roads layer, and select Styles &gt; Copy Style &gt; All Style Categories. Then right click on the new (Clipped) roads layer and select Styles &gt; Paste Style &gt; All Style Categories. This is a great way top style several layers ion the same way wirthout effort.\nRemove the original roads layer from your project by right clicking on it and selecting Remove Layer..., and then rename you clipped layer to “Roads”. Save your project.\nClose QGIS. It will give you a warning - read it carefully and then confirm it.\nReopen QGIS, and load back your project. Notice it remembers exactly where you last saved it, including zoom level, layer names and layer styles. The “Extent” layer will still be on your list, but will appear empty - it has been deleted once you closed QGIS. Remove it from the project and save again.\n\n\n\n\n\n\n\nStop and Think\n\n\n\n\nWhat are the names of the two GIS functions you just used in this exercise?\nWhy did you have to create a new layer representing the extent of the terrain data before clipping the roads layer?\nWhat does the warning given by QGIS when you closed your project means?\n\n\n\n\n\n\n\n\n\nClick for answer\n\n\n\n\n\n\nThe functions are called Clip and Extract Layer Extent.\nThe Clip function requires two vector files as input, but the terrain data is a raster file (i.e. an image). The Extract Layer Extent creates a vector file representing the extent of any given layer. Each specific tool will require different kinds of data to work properly. We will learn more about vectors and rasters on weeks 2 and 3.\nWhen we created the extent layer, we produced a temporary layer, which is discarded by QGIS when the program is closed. QGIS was letting you know that will happen, to give you the chance to go back and save it. Temporary layers are also lost when QGIS crashes (yes when, not if - it will happen). So never use them for important stuff - only for quick tests if you are not sure what the output of a function will be.",
    "crumbs": [
      "Week 1 - Introduction",
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Lab 1: QGIS overview and file management</span>"
    ]
  },
  {
    "objectID": "lab_intro.html#guided-exercise-4-creating-a-map-layout",
    "href": "lab_intro.html#guided-exercise-4-creating-a-map-layout",
    "title": "1  Lab 1: QGIS overview and file management",
    "section": "1.5 Guided Exercise 4: Creating a map layout",
    "text": "1.5 Guided Exercise 4: Creating a map layout\nThe main QGIS interface (or any other GIS software) is developed and optimised for interactive work. But very often as part of our GIS analysis we will want to generate nice maps and figures following proper design rules (and not just grabbing a screen capture of the QGIS window and dumping it on a page - hint for your assignment reports). For that, we use the QGIS Map Layout Editor.\n\nClick on Project &gt; New Print Layout and name it Lab 1 Layout. A new window will open showing the QGIS Layout Editor. Notice that the main QGIS window remains open as well. These windows are ‘linked’, so that the map layout reflects any styling changes you make on the main window.\nAdd a new map to the layout by clicking on the  icon. Drag it through the page so it covers about 2/3 of it horizontally, and the full height of the page (minus some borders).\nUse the Interactive Extent tool  to pan (click and grag) and zoom (mouse wheel) until your data covers the entire map box. But make sure you don’t hide the edges of the data by zooming in too much!\nNow fine tune the map scale by changing the Scale value on the bottom right panel. Remember that this value means “1:value”, i.e. one unit on the page is equal to that many units (value) in the real world. This means larger numbers will “zoom out”, and smaller numbers will “zoom in”. Try to make the map fill as much as possible of the map box, without clipping the edges.\nGo to the menu Add Item &gt; Add Legend... in the Map Layout Window (or guess the icon for this option on the side toolbar). Click the area beside the map box and drag to add a legend.\nGo back to the main QGIS window, right click on the terrain layer name, then select Properties..., and on the Symbology tab, change the Mode under the class color box to Equal Interval. Then select the number of Classes to 10 (to the right of the Equal Interval box). Go back top the Map Layout editor.\nGo to the menu Add Item &gt; Add Scalebar in the Map Layout Window (or guess the icon for this option on the side toolbar). Click and drag in the area below the legend to add it to the map layout.\nAdd a title to your map using the Add Label... tool (either on the Add Item menu or selecting the tool directly from the left sidebar). You can change the text by replacing the “Lorem ipsum” placeholder text with your own text on the left pane. Try to make it bold with a font size of 16 (hint: always use the down-arrow buttons for ‘quick settings’).\nRearrange the items on the page until you are pleased with the results. Then go to Layout &gt; Export as PDF..., and export your map, naming it properly and saving it on GEOU9SP/lab_1/final_products. It is a good idea to export as PDF if you want your map to be a standalone document. If you are exporting to insert the map into a report, then use Layout &gt; Export as Image... instead.\n\nFor reference, my map looked like this at this stage:\n\n\nThen close the Map Layout window, save your project on the main QGIS window, and close QGIS. Reopen QGIS, and go to Project &gt; Layout Manager. The layout you created previously should appear on the list. Select it and click on Show to reopen the Map Layout window.\n\nCongratulations! You have successfully finished your first GIS project, using proper file management practices! As a final suggestion, create a “workflow_notes” file on GEOU9SP/lab1/notes and write up a quick overview of what you did, along with any specific notes you would like to remember later.",
    "crumbs": [
      "Week 1 - Introduction",
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Lab 1: QGIS overview and file management</span>"
    ]
  },
  {
    "objectID": "lab_intro.html#independent-exercise-1",
    "href": "lab_intro.html#independent-exercise-1",
    "title": "1  Lab 1: QGIS overview and file management",
    "section": "1.6 Independent Exercise 1",
    "text": "1.6 Independent Exercise 1\nAt the end of each lab, you will have the opportunity to reinforce what you learned by going through ‘independent’ exercises. These will use the same operations you learned with the guided exercises, but it may require you to figure out small bits of new functionality, and will not have step by step instructions.\nAs the module progresses, the independent exercises will give you less and less directions, to reflect real-world GIs usage. Make sure you do the independent exercises - it is easy to fall into a false sense of ‘I got this’ when only following step-by-step directions.\n\nCreate a new project folder structure for this project, under your main GEOU9SP work folder.\nDownload the zipfile containing the Air Photo Mosaic and the Stirling Council Geospatial Data from here.\nExtract the data from the zipfiles and move them to the proper project folders.\nOpen QGIS and create a new project that uses the OSGB British Grid (EPSG 27700) coordinate reference system.\nImport the airphoto raster image and the vector files for Buildings, Roads, Railway Track, Electricity Transmission Lines, and Functional Sites into your QGIS project.\nOrganize your layers so that, from top to bottom, you have transmission lines, railways, roads, buildings, functional sites, and then the airphoto image.\nStyle your layers so that transmission lines are styled as thin dashed red lines, railways as thick white lines, roads as thick grey lines, buildings as filled yellow polygons and functional sites with a thick dark blue outline and no fill colour (hint: check the Fill style options).\nClip all your vector layers to the extent of the airphoto image.\nCreate a map layout covering the entire extent of the airphoto. Add a title, legend and scale bar to your layout and export it as a PNG image. Then insert your exported file as a figure into a MS Word document.\n\n\n\n\n\n\n\nClick here to see what the final layout should look like.\n\n\n\n\n\n\n\n\n\n\nNow answer the questions below:\n\n\nHow far is the Pathfoot Building from the Cottrell Bulding? Calculate it both “as the crow flies” (linear distance) and as if you were walking. (Hint: use the Measuring tool).\nWhat is the total surface area of the water bodies in the University of Stirling Campus? (Hint: also the Measuring tool).\nWhat is the classification of the UoS campus polygon within the “Functional Site” layer? (Hint: use the Indentify Features tool).",
    "crumbs": [
      "Week 1 - Introduction",
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Lab 1: QGIS overview and file management</span>"
    ]
  },
  {
    "objectID": "lab_crs.html",
    "href": "lab_crs.html",
    "title": "2  Lab 2: Coordinate Reference Systems",
    "section": "",
    "text": "2.1 Guided Exercise 1: Understanding Coordinate Reference Systems\nIn this exercise, you will learn how to use QGIS to identify the coordinate reference system (CRS, sometimes wrongly called as just “projection”) of spatial data you acquire, and also how to manage data and project coordinate reference systems.",
    "crumbs": [
      "Week 1 - Introduction",
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Lab 2: Coordinate Reference Systems</span>"
    ]
  },
  {
    "objectID": "lab_crs.html#guided-exercise-1-understanding-coordinate-reference-systems",
    "href": "lab_crs.html#guided-exercise-1-understanding-coordinate-reference-systems",
    "title": "2  Lab 2: Coordinate Reference Systems",
    "section": "",
    "text": "Stop and Think\n\n\n\nWhy are coordinate reference systems and ‘projections’ not the same thing?\n\n\n\n\n\n\n\n\nClick for answer\n\n\n\n\n\nCoordinate reference systems combine a datum, which defines a geometric representation of the Earth’s shape and how it ‘intersects’ with the real surface of the Earth, a coordinate system (for example latitude and longitude or northings and eastings) and a map projection which is a set of mathematical rules to project the 3D surface of the datum’s ellpisoid into a flat plane (such as a screen or a map).\n\n\n\n\n2.1.1 Obtaining the required data\n\nDownload the 2020 country boundary data in GeoJSON format, at the 1:20 million scale, from the link below. The GeoJSON format is a more recent GIS file format, commonly used for web-based mapping. It is derived from the JavaScript Object Notation (JSON) data file format, widely used to exchange data among websites and web servers. More info here.\n\nhttps://ec.europa.eu/eurostat/web/gisco/geodata/administrative-units/countries\n\n\n\n\n\n\n\nStop and Think\n\n\n\n\nWhat is the source of the data you are downloading? Does it seem reliable?\nWhat are the conditions (provisions) of use for the data?\n\n\n\n\n\n\n\n\n\nClick for answer\n\n\n\n\n\n\nThe page providing the data is managed by Eurostat, the statistical office of the European Union. Therefore you would be inclined to trust in the quality and correctness of the data provided.\nThe webpage presents a link to “dowload rules’ which describe the authorised uses of the data. This informartion can also be found in the data’s metadata file.\n\n\n\n\n\nCreate a lab_2 folder in your GEOU9SP main folder. Then create a simple folder structure to organise the data, and extract the zipped downloaded data in its proper location. If you are not sure how to do this, please revisit Chapter 1.\nOpen QGIS and start a new project. Save it as lab_2 in its proper folder. Then look at the contents of the folder holding the country data, using the QGIS browser panel. If the panel is not available, you can enable it by going to the View &gt; Panels menu and checking the box for browser. You should see several layers on tghe folder:\n\n\n\nLoad the CNTR_BN_20M_2020_4326 file into your project. Pay attention to the file name as there are many files with similar names.\n\n\n\n\n\n\n\nStop and Think\n\n\n\nGood file names are always informative of their content. Can you gess the contents of the different GeoJSON files you have downloaded based on their names?\n\n\n\n\n\n\n\n\nClick for answer\n\n\n\n\n\nAll file names start with CNTR for ‘countries’, followed by a two letter code. BN seems to stand for ‘boundary’(vector lines), RG for ‘region’(vector polygons), and LB for ‘labels’ (vector points). Then 2020 specified the reference year, and 20M indicates the 1:20 million mapping scale. the final four-letter number indicates the EPSG code for the data CRS: 4326 (‘unprojected’ WGS84), 3857 (WGS 84 with Pseudo-Mercator projection) or 3035 (ETRS89-extended / Lambert Azimuthal Equal Area for Europe).\n\n\n\n\n\n2.1.2 Visualising data with different CRS\n\nSet the symbology for the outline and fill as you prefer. Try to manipulate more visual variables than just colour.\n\n\n\n\n\n\n\nStop and Think\n\n\n\nWhy can’t you set a fill color for the countries?\n\n\n\n\n\n\n\n\nClick for answer\n\n\n\n\n\nBecause the BN files are vector lines, not polygons. Lines only have one dimension, and thus the inner parts of the countries in this dataset are actually empty. If you load the RG dataset instead, you can set the fill, as vector polygons represent 2D areas.\n\n\n\n\nRight-click on this layer’s name and go to Properties &gt; Information.\n\n\n\n\n\n\n\nStop and Think\n\n\n\nWhat is the Coordinate Reference System (CRS) for this dataset?\n\n\n\n\n\n\n\n\nClick for answer\n\n\n\n\n\nThe information tab will have a section called Coordinate Reference System, as below:\nName: EPSG:4326 - WGS 84 Units: Geographic (uses latitude and longitude for coordinates) Type: Geographic (2D) Method: Lat/long (Geodetic alias) Celestial Body: Earth Accuracy: Based on World Geodetic System 1984 ensemble (EPSG:6326), which has a limited accuracy of at best 2 meters. Reference: Dynamic (relies on a datum which is not plate-fixed)\n\n\n\n\nNote, on the bottom QGIS status bar, that as you move your mouse pointer around, the coordinates for the mouse position are updated in real time. Also note what the map scale is, how it changes as zoom in and out. You can also type the second part of a scale nuber to zoom at the desired map scale (for example 50000 if you want to see the map at a 1:50000 scale)\n\n\n\n\n\n\n\n\nStop and Think\n\n\n\n\nWhy doesn’t the scale shown on the bar match the “advertised” scale for the dataset (1:10 million)?\nThe box on the very bottom right of the QGIS status bar tells you what is the current project CRS. How is it different from a layer CRS?\n\n\n\n\n\n\n\n\n\nClick for answer\n\n\n\n\n\n\nThe 20M scale refers to the scale used when digitising the coastline, i.e., what is the ‘closest’ you can view the dataset without loss of detail.\nThe project CRS defines the ‘viewing’ CRS for the map canvas. Any data that uses a different CRS than the project will be re-projected ‘on the fly’ to match the CRS of the project - but continue with the exercise to learn why that can be a problem.\n\n\n\n\n\nZoom to the UK in the shown layer. Note how the scale at the bottom status bar changes with your zoom.\n\n\n\n\n\n\n\nStop and Think\n\n\n\nDoes the shape of the UK look “right” to you? If not, what is the issue and what is the cause?\n\n\n\n\n\n\n\n\nClick for answer\n\n\n\n\n\nThe UK looks ‘squished` vertically. That is because the data is being viewed in the EPSG 4326 (’unprjected’ WGS84) CRS. EPSG 4236 uses what is effectively the Plate Carrée or Equidistant cylindrical projection, the simplest possible map projection - lat and long degrees are just linearly converted to x,y coordinates. This projection does not preserve area nor shape (conformal) and increasingly distorts features as you approach the poles.\n\n\n\n\nClick on the project projection box at the bottom right of the status bar (or go to Project &gt; Properties... &gt; CRS tab). On the Filter text box, search for EPSG:3035. Select this projection for the project and click OK. A warning box will appear, make sure you read it through before selecting OK again.\n\n\n\n\n\n\n\nStop and Think\n\n\n\n\nwhat is the name of the Coordinate Reference System specified by EPSG 3035?\nWhat did the warning window warned you about?\n\n\n\n\n\n\n\n\n\nClick for answer\n\n\n\n\n\n\nEPSG 3035 is called ETRS89-extended / LAEA Europe and is the official projection for cartographic data from the European Union. It uses the European Terrestrial Reference System 1989 datum and the Lambert Azimuthal Equal Area projection, which preserves areas and can be considered conformal for Europe.\nIt warned you that there is more than one option for the ‘on the fly’ reprojection of your layer from ESPG 4326 to EPSG 3035. It showed you the options with the most accurate (1m) selected by default. But this option is only valid for Europe.\n\n\n\n\nIt is important to not “freak out” when an unexpected warning or error appear. Take a breath, and read through the window or error message, most often the explanation is right there. You just have to dare to look.\nIf you did click through it without looking, here is a screen capture of it:\n\n\nLook at the shape of the UK again after changing the project CRS. Then right click on the layer name and select “Zoom to Layer(s).”\n\n\n\n\n\n\n\nStop and Think\n\n\n\n\nHow does the rest of the world look now? Why?\nWhen you move your mouse, what unit are the coordinates in?\n\n\n\n\n\n\n\n\n\nClick for answer\n\n\n\n\n\n\nAs you move further away from the centre of the projection, shape gets progressively more distorted. This is because the LAEA projection is only conformal at its centre. But areas are all correct.\nIn metres. You can check that on the layer’s Properties &gt; Information tab.\n\n\n\n\n\nNow add to the project the file called CNTR_BN_20M_2020_3035.geojson. Notice the different last four numbers on the file name.\n\n\n\n\n\n\n\nStop and Think\n\n\n\nWhat is the CRS for this new layer, and how well dos it visually align with the p[revious layer.\n\n\n\n\n\n\n\n\nClick for answer\n\n\n\n\n\nThis second layers uses the EPSG 3035 CRS, while the previous layer used EPSG 4326. Notice how ech layer maintains its original CRS when added to the project, but if necessary they are reprojected ‘on the fly’ to match up visually.\n\n\n\n\nChange the project CRS back to EPSG:4326.\nNow go back to the project CRS properties and check the box that says No CRS at the top of the window. This disables the on-the-fly projection. Then click OK and go back to your map.\nRight click on the 4326 layer and select Zoom to Layer. Then select the zoom out tool (the loupe with a minus sign) at the top button row, and start clicking at the centre of the map. Keep clicking as it gets really smalll - you should click about 17 times until the second dataset is fully visible. Check the properties of each layer to make sure they still have the same CRS of when you loaded them.\n\n\n\n\n\n\n\nStop and Think\n\n\n\nWhat has happened? Why are the two datasets suddenly very different in size?\n\n\n\n\n\n\n\n\nClick for answer\n\n\n\n\n\nSince you turned off on-the-fly reprojection, each dataset is now drawn at their original coordinates - but one is in meters and the other in degrees, so their x,y positions and scale become very different.\n\n\n\n\n\n2.1.3 Potential issues with using mismatched data\n\nDownload this vector shapefile (link), unzip it and add it to your QGIS project. Check what is the CRS of this layer.\nSet the Project CRS back to EPSG:3035. Then go to the top menu bar and select Vector &gt; Geoprocessing &gt; Clip. Select the layer that has the EPSG 3035 projection as your Input Layer, and the new “clip_bounds” layer as your Overlay Layer. You can just leave the output as a temporary file. Click Run.\nTurn off the visibility of all layers except the new “Clipped” layer to see the result of the Clip operation.\nRename the “Clipped” layer to “Clipped_3035” by right clicking on it and selecting Rename layer. Then repeat the Clip operation, this time selecting the 4326 world layer as Input, and “clip_bounds” as Overlay again. Rename the result to “Clipped_4326.”\n\nUsing what you learned on the previous lab activities, pick two contrasting colours for each “Clipped_…” layer, and make the lines thicker. Zoom in at the lines of each clipped layer and check if they overlap perfectly.\n\n\n\n\n\n\nStop and Think\n\n\n\nWhy are the clipping results different even though the initial 3035 and 4236 layers looked perfectly aligned?\n\n\n\n\n\n\n\n\nClick for answer\n\n\n\n\n\nBecause although they have been reprojected visually to match on screen, the files still have different CRSs, and this affects the lining up of the Input and overlay layers. To get proper results, you need permanently translate (reproject) both datasets to the same CRS.\n\n\n\n\nNow go to Vector &gt; Data Management Tools &gt; Reproject Layer. Select the 4326 world layer as your Input Layer, and EPSG:3035 as your Target CRS. Let the result be a temporary file and click OK. The new layer will be automatically named as “Reprojected”. What is the CRS of this new layer (check on the layer properties window)?\nNow repeat the use of the Clip tool using “Reprojected” as the Input Layer and “clip_bounds” as the Overlay Layer. Rename the resulting layer to ‘Clipped_Reprojected’. Which of the two originally clipped layers (“Clipped_3035” or “Clipped_4236?) better matches the”Clipped_Reprojected” layer?\n\n\n\n\n\n\n\nStop and Think\n\n\n\nWhat does the Reproject operation do?\n\n\n\n\n\n\n\n\nClick for answer\n\n\n\n\n\nIt actually applies a permament mathematical transformation to the coordinates of the input data, translating the data from one CRS to another. For any GIS project that involves multiple data layers with different CRSs, you should pick the CRS that makes more sense for your project as the ‘project CRS’, and then reproject all layers to the same CRS before anything else.\n\n\n\nThis is the end of Lab 2! You shoudl now understand why different datasets may have different Coordinate Reference Systems, what are the problems with working with data that has mismatched CRSs, and how to reproject data to match a given CRS. As this is your first week, there are no additional independent exercises - lets take it easy!\nIf you still want to practice more, check the exercises from the QGIS Training Manual!",
    "crumbs": [
      "Week 1 - Introduction",
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Lab 2: Coordinate Reference Systems</span>"
    ]
  },
  {
    "objectID": "sec_w2_vectors.html",
    "href": "sec_w2_vectors.html",
    "title": "Week 2 - Vector data",
    "section": "",
    "text": "ILOs covered",
    "crumbs": [
      "Week 2 - Vector data"
    ]
  },
  {
    "objectID": "sec_w2_vectors.html#ilos-covered",
    "href": "sec_w2_vectors.html#ilos-covered",
    "title": "Week 2 - Vector data",
    "section": "",
    "text": "Understand the structure of spatial data and choose appropriate data types and models for storing and representing it;\nObtain and assess the quality of spatial data from online and offline sources and produce new spatial data using computer and field methods;\nCreate map visualisations that adhere to cartographic principles and can be easily and unambiguously interpreted by the non-specialist public;\nPlan and execute GIS analytical steps to solve spatial problems successfully;",
    "crumbs": [
      "Week 2 - Vector data"
    ]
  },
  {
    "objectID": "sec_w2_vectors.html#what-will-you-learn",
    "href": "sec_w2_vectors.html#what-will-you-learn",
    "title": "Week 2 - Vector data",
    "section": "What will you learn",
    "text": "What will you learn\nUse this list as a ‘check-list’ to gauge your learning for each week. If you don’t feel confident you have learned any specific topic, then revisit the week’s material!\n\nTheoretical knowledge for Week 2:\n\nWhat are data models vs data formats (file formats) vs data types (attribute types)?\nWhat is the vector data model?\n\nHow are vectors represented?\nWhat are the components of a vector file (geometry + attribute)?\n\nWhat are the main vector file formats?\nWhat are the main data types we use to represent attributes?\nWhat kinds of data can we represent using vector data?\nWhat kinds of questions can we answer using attributes?\nWhat kinds of questions can we answer using geometries?\nWhat kinds of questions can we answer using both (i.e. geometry-based attribute calculations).\n\n\n\nPractical knowledge:\n3  Lab 3: Working with vector attributes\n\nHow to identify a vector file format\nHow to load a vector file\nHow to use the identify tool to get information on the fly\nThe concept of ‘selecting’ a feature.\nHow to select features using the click tools in QGIS\nHow to access the attribute table\nHow to use the statistical summary tool\n\nGlobal summaries vs summaries on selected data\n\nHow to select using simple queries (filter) on attributes\n\nBoolean operators\nString based operators\n\nHow to use attributes to set symbology\n\nSingle symbol\nCategorised\nGraduated\n\n\n4  Lab 4: Working with vector geometries\n\nHow to do combined attribute queries (AND / OR)\nHow to calculate new attributes\n\nNumeric attributes\nString attributes\nGeometry attributes\n\n\nHow to convert data types if needed\nAttribute selection vs attribute filtering\nHow to select based on location\n\nThe different selection options\nImportance of CRS matching\nSelect by location vs clipping -How to combine spatial and attribute selection\nSelecting within selections or saving intermediate results",
    "crumbs": [
      "Week 2 - Vector data"
    ]
  },
  {
    "objectID": "lab_vectors_1.html",
    "href": "lab_vectors_1.html",
    "title": "3  Lab 3: Working with vector attributes",
    "section": "",
    "text": "3.1 Before you start!",
    "crumbs": [
      "Week 2 - Vector data",
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Lab 3: Working with vector attributes</span>"
    ]
  },
  {
    "objectID": "lab_vectors_1.html#before-you-start",
    "href": "lab_vectors_1.html#before-you-start",
    "title": "3  Lab 3: Working with vector attributes",
    "section": "",
    "text": "Go through the Week 2 preparatory session on Canvas, and watch the seminar recording if you have missed it.",
    "crumbs": [
      "Week 2 - Vector data",
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Lab 3: Working with vector attributes</span>"
    ]
  },
  {
    "objectID": "lab_vectors_1.html#guided-exercise-1---basic-work-with-vector-data",
    "href": "lab_vectors_1.html#guided-exercise-1---basic-work-with-vector-data",
    "title": "3  Lab 3: Working with vector attributes",
    "section": "3.2 Guided Exercise 1 - Basic work with Vector Data",
    "text": "3.2 Guided Exercise 1 - Basic work with Vector Data\nIn this exercise, you will learn how to open and read vector data.\n\nDownload the data for this exercise from here, then extract the zip files (make sure all the data are unzipped! Sometimes you have zipfiles inside zipfiles…) and organise them to your preference (use a similar folder structure as from week 1).\nLoad all three datasets in QGIS and inspect them. The file names are: global_earthquakes_2011.gpkg, MajorRivers.shp, and ne_50m_admin_0_countries.shp.\n\n\n\n\n\n\n\nStop and Think\n\n\n\n\nWhat are the datasets you have?\nWhat are the data models used by these datasets?\nWhat are the file formats you have to work with?\nWhich of these files contain metadata about your datasets?\nWhat is the CRS of each data layer you have?\n\n\n\n\n\n\n\n\n\nClick for answer\n\n\n\n\n\n\nYou can use the file names, the metadata, and the visual appearance of the layers to answer data. The global_earthquakes_2011.gpkg file seems to hold point data on recorded Earthquake locations in the year 2011. The MajorRivers.shp layer seems to hold line data on the world’s largest rivers. The ne_50m_admin_0_countries.shp seems to have boundaries for the world countries.\nAll three files use the vector data model, being a point vector, line vector and polygon vector respectively.\nThe earthquakes layer is given in the geopackage file format, while the other two layers are given in the shapefile file format. Notice that data model and file format are two different things, and they don’t necessarily imply each other. Geopackages, for example, can hold both vector and raster data.\nThe rivers layer has a plain text metadata file with a link that points to the source of the data, where more information can be found. The countries layer has an HTML file that holds metadata about the file. The earthquakes data has no metadata.\nAll three layers are using EPSG 4236 (WGS84 ‘unprojected’) as CRS. You check it by right clicking on the layer name and selecting Layer CRS, or by selecting Properties &gt; Information.\n\n\n\n\n\nCheck your Project properties to make sure they are correct (does the project CRS match the layers? What are the measurement units set for this project? Have you set the base folder?). Then save your project file within your folder structure as in previous labs.\nNow inspect the attribute table for each layer, by right-clicking on each layer name and then on Open Attribute Table. Then answer the following questions:\n\n\n\n\n\n\n\nStop and Think\n\n\n\n\nHow many features does each layer have?\nHow many attributes does each feature have?\n\nTip: if you go to Properties &gt; Fields, you get a list of all attributes ordered by ID, which is a sequential number. That makes it easier to count attributes when there are many.\n\n\n\n\n\n\n\n\nClick for answer\n\n\n\n\n\n\nEarthquakes: 15272; Rivers: 98; Countries: 241.\nEarthquakes: 5 (fid, Event, latitude, longitude, Magnitude, Date); Rivers: 4 (NAME, SYSTEM, MILES, KILOMETERS); Countries: 94 (featurecla, scalerank, etc…).\n\nIf you looked at Properties &gt; Fields, the last ID is 93, but the first one is 0, so 94 in total.\n\n\n\n\nRename your layers on the layer list to human-readable, informative names, then save your project. Remember, these new names will appear within this project only, the name of the source files in your folders will not change.\nOrganize the layer order and play with different layer superpositions to make the most readable visualisation for all datasets involved. Then experiment with the symbology of each layer to improve your visualization.",
    "crumbs": [
      "Week 2 - Vector data",
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Lab 3: Working with vector attributes</span>"
    ]
  },
  {
    "objectID": "lab_vectors_1.html#guided-exercise-2-visualising-layer-attributes",
    "href": "lab_vectors_1.html#guided-exercise-2-visualising-layer-attributes",
    "title": "3  Lab 3: Working with vector attributes",
    "section": "3.3 Guided Exercise 2: Visualising layer attributes",
    "text": "3.3 Guided Exercise 2: Visualising layer attributes\nOne of the main applications of vector data is the ability to select and then summarise the different attributes of each layer to extract relevant information.\n\nTurn off the “Rivers” and “Earthquakes” layers. (Tip: to turn multiple layers off or on at once, highlight all the layers you need to make hidden (or visible) by holding down the Control key of your keyboard while you click, then hit the spacebar on your keyboard).\nGo to Layer Properties &gt; Symbology for the World Countries layer, and change the top option from Single Symbol to Categorized. This lets you assign different colours based on attribute values. We will colour the countries based on the main region where they are. So for Value, choose the REGION_UN attribute. Leave the Symbol option as is, and for Color Ramp, select Random Colors if not already. Then click on the Classify button on the bottom left of the large white space in the middle of the window. Then click on OK.\nLook at your layer and notice how it has been styled. Try to manually change the colours of each region to your liking.\n\nNow lets use visualisation to understand the distribution of world population.\n\nReturn to the Symbology window and select Graduated instead of Categorized. Change your Value to the POP_EST attribute. Choose Magma as your colour ramp (click on the little arrow to the right), and select the Invert Color Ramp option.\nChange the classification Mode (above the classify button) to Equal interval, leave the number of Classes as 5 (to the left of Mode), and then click on Classify, then OK.\n\n\n\n\n\n\n\nStop and Think\n\n\n\n\nWhat is the difference between the Categorized and Graduated options?\nDoes the Equal Interval classification give a good visualization of the distribution of world population?\n\n\n\n\n\n\n\n\n\nClick for answer\n\n\n\n\n\n\nCategorized is for categorical, non-numeric variables (i.e. names, classes, etc.). Graduated is for continuous variables (i.e. quantities, measurements).\nNo, because China, India and to a lesser extent the US have much numbers than the rest, which biases the breakpoints. We will fix it in the next step.\n\n\n\n\n\nReturn to the Symbology window, and change the Mode from Equal Interval to Natural Breaks (Jenks), and increase the number of Classes to 10. Click on OK.\n\nWhen you are mapping your own data, make sure you explore the different methods for calculating breakpoints, and also play with the number of classes. You can see the ful explanation of each Mode on the QGIS Documentation.",
    "crumbs": [
      "Week 2 - Vector data",
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Lab 3: Working with vector attributes</span>"
    ]
  },
  {
    "objectID": "lab_vectors_1.html#guided-exercise-3-selections-based-on-layer-attributes",
    "href": "lab_vectors_1.html#guided-exercise-3-selections-based-on-layer-attributes",
    "title": "3  Lab 3: Working with vector attributes",
    "section": "3.4 Guided Exercise 3: Selections based on layer attributes",
    "text": "3.4 Guided Exercise 3: Selections based on layer attributes\nNow we will look into using expressions to search and select specific features according to their attributes. As GIS vector data emerged from the database world, these searches as sometimes refered to as queries.\n\nChange the symbology of the Countries layer to Single Symbol, and pick a dark gray. Then turn on the Rivers layer, change its symbology to a light blue, and make sure it is on top of the Countries layer.\nOpen the Rivers layer attribute table (right click on its name then on Open attribute table). Then click on the Select features using expression button (). You will see a new window with three panels, like the one below. If you only see two panels, then click on Show help:\n\n\nYou will encounter this expression window in other parts of QGIS as well. The way it works is that you type your expression on the left window, using the middle and right panels to browse and select operators to add to your expression. It will make more sense with an example:\n\nIn the middle panel, expand the Fields and Values item and then double click on KILOMETERS. It will add this attribute name to the left panel. Notice that it is enclosed by double quotes. In the expression window, any word between double quotes means it is an attribute’s name. You can also type names directly in the window if you prefer, and QGIS will offer autocomplete suggestions based on the existing attributes.\nNow complete the expression by typing the remainder, so that the final expression is \"KILOMETERS\" &gt; 5000. This expression means “Select all River features that have a length - represented by the KILOMETERS attribute - larger than 5000”. Then click on the Select features button.\nCheck the results of your selection on the Attribute Table. The number of selected features should be shown on the top of the window (11), and selected features will be highlighted in blue. On the bottom left of the window, you can change from Show all features to Show selected features if you only want to see the selected features.\nAlso check the results of your selection on the Map canvas. All selected features will be highlighted in yellow. Tip: if you ever set the symbology of a feature yellow, remember to not confuse it with selected objects. When in doubt, check the attribute table.\n\n\n\n\n\n\n\nStop and Think\n\n\n\nIt seems the selection is missing a few of the longest rivers in the world, such as the Amazon River. Why would that be?\nHint: try to use the manual selection tool () to click on the Amazon River and investigate.\n\n\n\n\n\n\n\n\nClick for answer\n\n\n\n\n\nThe different segments of the Amazon River officially receive different names: Amazonas (lower Amazon), Solimões (central Amazon) and Ucayali (upper Amazon). In this dataset, it is broken down into two features: Amazon (with 3042 km) and Ucayali (with 2088 km). Since these are two separate features, neither is selected by our expression.\n\n\n\n\nReturn to the attribute table and make sure that the rivers larger than 5000km are still selected. Then create a new expression: SYSTEM\" = 'Amazon'. Notice that we enclose the word Amazon with single quotes. This identifies this as a string, i.e. a character value, and differentiates it from an attribute name. Then instead of clicking on Select Features, click on the small arrow to the right and click in Add to Current Selection. Now your selection should include all river features that are longer than 5000 km or belong to the Amazon system (26 features in total).\n\nTip: If you can’t remember all the possible values of an attribute, select the attribute under Fields and Values and then on the right panel, double click on All Unique. QGIS will list all possible value options for that particular attribute.\n\nNow deselect all features by clicking on the Deselect button in the Attribute Table () or the Deselect from all layers button in the main QGIS toolbar (). It is always good to clear selections when you are done with a certain analysis, to avoid unexpected consequences.\n\nWe can use several operators to create expressions. For numeric values, we can use all logical operators: ‘greater than’ (&gt;), ‘lesser than’ (&lt;), their ‘or equal’ variants (&lt;=, &gt;=) as well as ‘equal’ (=) or ‘not equal’ (&lt;&gt;). For strings (text), = and &lt;&gt; also work, but you can use the operators IS and IS NOT (all upper case) instead. In the example above, we could have used \"SYSTEM\" IS 'Amazon' to get the same result.\nAnother class of useful operators are called Boolean operators: AND, OR and NOT. They allow us to create compound expressions with multiple criteria:\n\nReturn to the attribute table and this time use the following expression: \"KILOMETERS\" &gt; 5000 OR \"SYSTEM\" = 'Amazon'. You should get the same results as when you used two separate selections with Add to Current Selection. But boolean operators can be more powerful.\nClear your selection and create a new one with the expression \"KILOMETERS\" &gt; 1000 AND \"SYSTEM\" = 'Amazon'. When you use the AND operator, each feature must fulfil both criteria (like an intersection in set theory, if you remember your maths). When you use the OR keyword, then each feature can fulfil either criteria (a mathematical union).\nNow change the expression to \"KILOMETERS\" &gt; 1000 AND \"SYSTEM\" IS NOT 'Amazon' and see what you get. Do you understand the effect of using the NOToperator?\n\nFinally, we have two useful operators for partial matching on strings. They are useful when you need to select based on a subset of string (word) values of an attribute:\n\nClear your selection and create a new one with the expression \"NAME\" LIKE 'Am%'. This should select all three rivers whose name starts with ‘Am’ (Amazon, Amu Darya and Amur). The ‘%’ symbol in this case is what we call a ‘wildcard’, and it means ‘anything else’.\nNow use the expression \"NAME\" LIKE 'C____' (four underscores, ’_‘). This should select all rivers whose name starts with ’C’ followed by any four characters (So it picks Congo and Chire).\n\n\n\n\n\n\n\nStop and Think\n\n\n\nHow many rivers would you get if you changed the above expression to \"NAME\" LIKE 'C%'?\n\n\n\n\n\n\n\n\nClick for answer\n\n\n\n\n\nFour (Columbia, Colorado, Congo, Chire). When you use the ‘%’ wildcard it means ‘any amount of any character’.\n\n\n\n\nFinally, create a selection with the expression \"NAME\" LIKE 'AM%' (notice the uppercase). You won’t get any results. Then change the expression to \"NAME\" ILIKE 'AM%'. You should get the same three rivers starting with ‘Am’ again.\n\n\n\n\n\n\n\nStop and Think\n\n\n\nWhat is the difference between LIKE and ILIKE?\n\n\n\n\n\n\n\n\nClick for answer\n\n\n\n\n\nThe LIKE operator is case sensitive, while ILIKE is case insensitive.\n\n\n\n\nBefore you move on to the next exercise, make sure you clear your selection.",
    "crumbs": [
      "Week 2 - Vector data",
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Lab 3: Working with vector attributes</span>"
    ]
  },
  {
    "objectID": "lab_vectors_1.html#guided-exercise-3-summarising-layer-attributes",
    "href": "lab_vectors_1.html#guided-exercise-3-summarising-layer-attributes",
    "title": "3  Lab 3: Working with vector attributes",
    "section": "3.5 Guided Exercise 3: Summarising layer attributes",
    "text": "3.5 Guided Exercise 3: Summarising layer attributes\nThe Statisitcal Summary Tool () is a quick way to summarise attribute values, and can be quite powerful when combined with attribute selections.\n\nOn the main QGIS window, click on the Statistical Summary tool button. A new panel will open on the bottom left corner of the QGIS window.\n\n\n\nSelect the “Rivers” layer as input, then select the KILOMETERS attribute on the drop-down menu. You will get a table with several summary statistics calculated for all features in the layer.\n\n\n\n\n\n\n\nStop and Think\n\n\n\nWhat are the longest, shortest, and mean kilometre lengths in the dataset?\n\n\n\n\n\n\n\n\nClick for answer\n\n\n\n\n\nMax: 9207.1 km; Min: 194.9 km; Mean: 2663.6 km\n\n\n\n\nNow repeat the attribute selection you did before using the expression \"KILOMETERS\" &gt; 5000, and then return to the Statistical Summary panel. Then check the Selected Features Only box at the bottom of the window. Now the stats will be re-calculated for the selected features only.\nThe Statistical Summary panel is smart enough to know how to summarise different data types. For example, select the SYSTEM attribute, and see how the stats change - now it gives you how many features in total (Count), how many unique values (Count(Distinct)), how many missing values (Count(Missing)), the Minimum and Maximum string values (they don’t have a clear meaning here), the least (Minority) and most (Majority) common unique values, and the Minimum length and Maximum length in number of characters.\n\n\n\n\n\n\n\nStop and Think\n\n\n\nWhy do you get a blank value for Majority and a 0 for Minimum Lenght?\n\n\n\n\n\n\n\n\nClick for answer\n\n\n\n\n\nFor the rivers dataset, Majority is blank and Minimum length is 0 because we have several NULL (missing) values. They have zero length, and they are in fact the most common unique value.",
    "crumbs": [
      "Week 2 - Vector data",
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Lab 3: Working with vector attributes</span>"
    ]
  },
  {
    "objectID": "lab_vectors_1.html#guided-exercise-4-calculating-new-attributes",
    "href": "lab_vectors_1.html#guided-exercise-4-calculating-new-attributes",
    "title": "3  Lab 3: Working with vector attributes",
    "section": "3.6 Guided Exercise 4: Calculating new attributes",
    "text": "3.6 Guided Exercise 4: Calculating new attributes\nAnother powerful way to derive information from vector attributes is to make calculations involving multiple attributes. For that, we can use the Field Calculator tool (), accessible either from the Attribute table or the main QGIS toolbar.\n\nBefore your start, make sure you clear your selections.\nGo back to the Attribute Table window for the Rivers layer and click on the Field Calculator button to open it. It should look like this:\n\n\n\nOn the new window, make sure the Only update selected features option is not checked. Then name the new field Mi_to_Km, and change the output data type to Decimal Number. Output field length tells you the maximum number of digits that can be stored per attribute value, and the Precision field tells you how many of these digits should be decimal places.\nOn the expression window, write \"MILES\" / \"KILOMETERS\". Note the warning at the bottom. Now click on OK.\nNow turn off editing mode by clicking on the Toggle Editing () button in the Attribute Table. When asked, confirm you want to save the layer changes.\n\n\n\n\n\n\n\nWarning\n\n\n\nTurning on editing mode is one of the most dangerous options in QGIS, as it lets you freely change both the geometry and the attribute values of a layer. Using the Field calculator automatically puts you on editing mode, so always make sure you turn it off immediately after you have finished a calculation. Once you make any changes and then save the changes, there is no turning back. I’ll often first export a copy of the layer if I need to do any edits, so I aways have the original as a backup if something goes wrong. We’ll revisit editing mode on week 4, when we learn how to digitise and edit geometries by hand.\n\n\n\n\n\n\n\n\nStop and Think\n\n\n\nDoes the Miles to Km proportion you calculated seem right?\n\n\n\n\n\n\n\n\nClick for answer\n\n\n\n\n\nYes, 1 Mile = 1.609 kilometres.\n\n\n\n\nThis new attribute you calculated is not very useful. Let us get rid of it. Put the attribute table back into editing mode, then click on the Delete Field button (), and select your Mi_to_Km field. Click OK. It’s gone! Remember to save the changes and exit edit mode.\n\nTip: if you want to rename an attribute, create a new one with the new name and just use the name of the old one as the expression on the Field Calculator. It will copy all values to the new attribute. Then remove the old one.\n\nWe will continue working with this data in the next lab. If you want to keeo your project, this is the best way to do it: on your computer’s file explorer, find the root folder for the project (lab_3, or whatever you have named it as). Then right click on it and select (on Windows) Compress to Zip file. That will create a new zipfile of the folder contents, with the same name as the folder. Then you can copy this zip file to your OneDrive folder or to an external drive.\n\nGood job, we have now finished our first guided tour of vector attributes. We will revisit it in the next lab, when we also learn about geometry-based selections.\nMake sure you have a go at the independent exercise below, to make sure you feel comfortable with attribute selections, calculations and summaries. You will keep using these skills for the rest of the module (and your GIS life).",
    "crumbs": [
      "Week 2 - Vector data",
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Lab 3: Working with vector attributes</span>"
    ]
  },
  {
    "objectID": "lab_vectors_1.html#independent-exercise",
    "href": "lab_vectors_1.html#independent-exercise",
    "title": "3  Lab 3: Working with vector attributes",
    "section": "3.7 Independent Exercise",
    "text": "3.7 Independent Exercise\nUsing the earthquakes layer you downloaded (global_earthquakes_2011.gpkg), do the following:\n\nFind out how many earthquakes of magnitude equal or larger than 7 have occurred in the Northern Hemisphere in 2011.\nWhat was the average magnitude of all earthquakes that occurred in Japan in 2011? (Tip: make sure you enlarge the event column of the attribute table to the whole values).\nCreate a new Text (string) attribute that indicates if an earthquake is located on the western (W) or eastern (E) hemisphere.",
    "crumbs": [
      "Week 2 - Vector data",
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Lab 3: Working with vector attributes</span>"
    ]
  },
  {
    "objectID": "lab_vectors_2.html",
    "href": "lab_vectors_2.html",
    "title": "4  Lab 4: Working with vector geometries",
    "section": "",
    "text": "4.1 Before you start!",
    "crumbs": [
      "Week 2 - Vector data",
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>Lab 4: Working with vector geometries</span>"
    ]
  },
  {
    "objectID": "lab_vectors_2.html#before-you-start",
    "href": "lab_vectors_2.html#before-you-start",
    "title": "4  Lab 4: Working with vector geometries",
    "section": "",
    "text": "Go through the Week 2 preparatory session on Canvas, and watch the seminar recording if you have missed it. Also make sure you have completed Lab 3.",
    "crumbs": [
      "Week 2 - Vector data",
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>Lab 4: Working with vector geometries</span>"
    ]
  },
  {
    "objectID": "lab_vectors_2.html#guided-exercise-1---spatial-queries",
    "href": "lab_vectors_2.html#guided-exercise-1---spatial-queries",
    "title": "4  Lab 4: Working with vector geometries",
    "section": "4.2 Guided Exercise 1 - Spatial Queries",
    "text": "4.2 Guided Exercise 1 - Spatial Queries\nWe will continue with the Earthquakes, Rivers and Countries dataset from the previous lab.\n\nIf you have zipped your project from the last session, just unzip it and get to work. If not, then download the data again, and redo your project organization. As a reminder, the files to be loaded are: global_earthquakes_2011.gpkg, MajorRivers.shp, and ne_50m_admin_0_countries.shp.\n\nFor our next step in the analysis, we would like to focus only on earthquakes on land (i.e. not ocean). This information is not contained in the Earthquakes layer, but we do have a Countries layer that separates land from ocean. Could we use that to make a selection?\n\nGo to the menu Vector &gt; Research Tools &gt; Select by Location..., or click on the  button on the main QGIS toolbar. You will get this window:\n\n\n\nSelect the Earthquakes layer as Select features from. Then check only the Are within query option. Then pick your World Countries layer for By comparing to the fetaures from. Click Run, and after it is finished, click Close.\nVisually inspect the results of your selection, and then open the Attribute Table for the Earthquakes layer.\n\n\n\n\n\n\n\nStop and Think\n\n\n\nHow many Earthquakes were originated on land in 2011?\n\n\n\n\n\n\n\n\nClick for answer\n\n\n\n\n\n3742 earthquakes.\n\n\n\nNow that we identified the earthquakes on the continents, we may want to add this information to the Earthquakes layer as an attribute, in case we need the information later.\n\nStill on the Attribute Table of the Earthquakes layer, open the Field Calculator, and create a new Text(string) field called Origin. Make sure the option Only update selected features is enabled this time. Then on the Expression window, just write 'Land'. That means the word Land will be added as the attribute value for every selected feature.\nNow back on the Attribute Table window, click on the Invert Selection button ().\nReturn to the Field Calculator and this time use the Update Existing Field option to the right, instead of Create a new field. Make sure the option Only update selected features is still enabled. Pick Origin as the field to be updated, and now just write 'Ocean' on the Expression window. Click OK.\nNow use the Origin attribute to style the colour or shape of your Earthquake points differently for land and ocean, using the Symbology options. Pick the Categorized symbology option at the top, and then the set the Value to the Originattribute, and then Classify.\n\n\n\n\n\n\n\nStop and Think\n\n\n\nDo you understand why you did the steps above?\n\n\n\n\n\n\n\n\nClick for answer\n\n\n\n\n\nWe wanted to create a new string attribute designating an Earthquake as either Ocean or Land. But the information on where the Earthquake is depends on whether it overlaps with the Countries layer. So we need to combine select by location with the Field Calculator. First we create a selection of land quakes based on location, and then we add a new field to the Earthquakes layer, to be filled with the word Land. But since we checked the Only update selected features option, only the selected features will be filled, and the rest will remain blank (Null). We then invert our selection so that only ocean quakes are selected, and update the existing field by filling in the word Ocean just for these selected features.\nCreating this new attribute adds the possibility of styling the points by Origin, which would not be possible just based on the selection.\n\n\n\nNow, let us find details about earthquake originating on a specific continent.\n\nOn the World layer, use Attribute selection (as in Exercise 3) to select all countries from South America. Then go to Vector &gt; Research Tools &gt; Select by Location... and select all Earthquakes that are within the Countries layer (same process as above), but this time make sure you turn on the option Selected features only.\nAnother way to make a selection ‘permanent’ is to export it as a new layer. While you still have the above selection on, right-click on the Earthquakes layer name and choose Export &gt; Save selected features as.... Name your exported file as Land_earthquakes_2011_south_america. Choose an appropriate folder to save it within your project structure by clicking on the ... button to the left of the file name box, and select your format of choice (geopackage or shapefile). Click on OK. Save your project.",
    "crumbs": [
      "Week 2 - Vector data",
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>Lab 4: Working with vector geometries</span>"
    ]
  },
  {
    "objectID": "lab_vectors_2.html#guided-exercise-2---geometry-based-attribute-calculations",
    "href": "lab_vectors_2.html#guided-exercise-2---geometry-based-attribute-calculations",
    "title": "4  Lab 4: Working with vector geometries",
    "section": "4.3 Guided Exercise 2 - Geometry-based attribute calculations",
    "text": "4.3 Guided Exercise 2 - Geometry-based attribute calculations\nAnother way to relate geometries to attributes is when we want to store some property of the geometry as an attribute itself, such as area, length or perimeter. QGIS also has tools for that.\nAs an example, let us calculate the areas and border length (perimeter) of all the World’s countries.\n\nBefore using any of the geometry-based operators, we need to set up our desired units for the project. Go to the menu File &gt; Properties... to open your project properties. Then on the General tab, set the Units for distance measurement to Kilometers and the Units for area measurement to Square Kilometers (yes, we will use SI units because we scientists!).\n\nIt is always important to think about your problem before choosing the units for length and area calculations. In this case, using the default of meters and squared meters would not make sense for things as large as countries.\n\nNow open the Attribute Table for the Countries layer and launch the Field Calculator. Create a new attribute called Area_km2 (it is always a good idea to add the units to the name to avoid any confusion) that is a decimal number with two decimal places. Then on the centre panel, find and expand the Geometry heading, and double click on the $area option to add it to the expression window. Then click on OK to calculate the field.\nRemember to deactivate editing mode!\n\n\n\n\n\n\n\nStop and Think\n\n\n\n\nWhat is the difference between $area and area? Hint: look at the help text on the right panel.\nWhy should we use $area instead of area here?\n\n\n\n\n\n\n\n\n\nClick for answer\n\n\n\n\n\n\nThe $area operator calculates geodesic area, meaning it takes into consideration the curved surface of the ellipsoid (defined by the projects CRS). It will also use the units specified in the project properties. The area operator will calculate planimetric area (i.e. a flat surface) and will derive the units from the CRS of the layer.\nSince we are calculating very large areas, geodesic area will be more correct than planimetric area (unless the dataset uses an equal-area map projection). Moreover, the data is in EPSG24326 (WGS 84), which has degrees as units. If we used area we would get areas in squared degrees, which don’t make a lot of sense.\n\n\n\n\n\nNow repeat the process above, and calculate Per_km as a new attribute, using the $perimeter operator (we use it instead of perimeter for the same reason above).\n\n\n\n\n\n\n\nStop and Think\n\n\n\nThe perimeter/area (PA) ratio is often used as a measurement of polygon complexity. Can you answer which country has the most complex border in the world?\n\n\n\n\n\n\n\n\nClick for answer\n\n\n\n\n\nUse the Field Calculator to calculate areas and perimeters (you just did), then use it to create a new PA_ratio attribute (decimal number) using the expression \"Per_km\" / \"Area_km2\" (assuming these are the attribute names you used). Then use the Summary Statistics tool to find the maximum PA_ratio value in the dataset (4.592). The use Select by expression to select which feature has \"PA_ratio\" = 4.592. That would be the Vatican!  A quicker way to answer this (that only works for min/max values) is to click on thePA_ratio` attribute name on the Attribute Table twice, to sort it in ascending and then descending order, and then checking which country is the top row after sorting.\n\n\n\nGood job! You now know all you need to query, create, delete, update and summarise attributes. You will use these tools a lot whenever you are doing any GIS work, so it is important to know them well.\nTo further solidify your knowledge, do the Independent Exercise below, which reviews all your learning from the past week and this week.",
    "crumbs": [
      "Week 2 - Vector data",
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>Lab 4: Working with vector geometries</span>"
    ]
  },
  {
    "objectID": "lab_vectors_2.html#independent-exercise---supporting-wildcat-conservation-in-scotland.",
    "href": "lab_vectors_2.html#independent-exercise---supporting-wildcat-conservation-in-scotland.",
    "title": "4  Lab 4: Working with vector geometries",
    "section": "4.4 Independent Exercise - Supporting Wildcat conservation in Scotland.",
    "text": "4.4 Independent Exercise - Supporting Wildcat conservation in Scotland.\nYou want to investigate how priority areas for wildcat conservation (WPAs) overlap with protected areas, and the risk of wildcat roadkill.\nFor that, obtain the following layers from the NatureScot Open Data Hub. Get them in shapefile format.\n\nWildcat Priority Areas (WPA)\nSites of Special Scientific Interest (SSSI)\n\nThen obtain the Open Roads layer for all of the UK from the Ordnance Survey OS Open Data hub (it is a large file and it may take a while to download).\nFinally, obtain the UK country boundaries from the Global Administrative Boundaries (GADM) hub. Get the GeoJSON file at Level 1 (Level 0 is the UK border without countries, level 1 is countries, level 2 is counties/council areas, etc.)\nOrganize the data and create a new project where you load all four datasets. Order and style them as you prefer. Then:\n\nAnswer the questions:\n\nWhat is the data model of each layer?\nWhat is the file format of each layer?\nWhat is the CRS of each layer?\nHow many features does the WPA dataset have?\nHow many attributes does the WPA dataset have?\n\nThe UK boundaries file has a different CRS from the rest, and it also contains all countries. Reproject this layer to the same CRS as the other layers, and then create a new layer containing the Scotland boundary only. Remove the UK layer from the project after that.\nThe roads layer covers all of the UK, making it very heavy and slow to use. But our analysis concerns Scotland only, so create a new layer containing only the road links (lines) inside the Scottish boundaries. Remove the full UK layer from the project after that.\nThe attribute Shape_Area of the WPA dataset does not indicate any units. It is always useful to have field names that hint at the unit for the values, making the data more self-explanatory. Recalculate the area of each WPA in square km, naming the new field ‘Area_km2’. Then delete the ‘Shape_Area’ attribute from the dataset to avoid confusion for future users.\nThe Sites of Specific Scientific Interest (SSSIs) are a category of protected area in Scotland. These may offer additional protection to wildcats. Find all the SSSIs that overlap with WPAs, and create a new layer containing only these sites. Then calculate the total area of these SSSIs.\nA major threat to wildlife is roadkill. Using the OS Open Data Open Roads dataset, answer the questions below:\n\nHow many road segments overlap with WPAs? (Create a new layer containing only, the selected data, to use below).\nWhat is the total length of roads within WPAs?\nNot all roads present the same risk. In the UK, roads are classified as:\n\nMotorways: high-speed expressways typically reserved for longer journeys between major cities;\nA roads: major roads intended to provide large-scale transport links;\nB roads: roads intended to connect different areas, and to feed traffic between A roads and smaller roads on the network;\nClassified Unnumbered – smaller roads intended to connect together unclassified roads with A and B roads, and often linking a housing estate or a village to the rest of the network;\nUnclassified – local roads intended for local traffic. The vast majority (60%) of roads in the UK fall within this category.\n\n\n\nWhat is the total length per road class for all roads intersecting WPAs?\nYou will notice a ‘problem’ with the terms used in the road classification attribute - its unique values don’t match the terms above. You will need to create a new field called class_fix that keeps the classification of Motorway A, B, Classified Unnumbered and Unclassified unchanged, but changes the records labelled as both Not Classified and Unknown to Unclassified.\n\nAlong with road class, the length of the road segment is also important in determining overall traffic speed. To take that into consideration, select all roads within WPAs that are of either Motorway, A or B class and have 100m or more in length. Create a new layer from this selection.\nGIS analyses will almost always have a visual component, as maps are a natural way to tell a ‘spatial story’. To finalise your exercise, organise and style your layers to show, in the most readable way possible (i.e. think about orders, line colours, widths and styles, fill colours, etc):\n\n\nThe Scottish boundary;\nThe WPAs;\nThe boundaries of the SSSIs, distinguishing between those that do and do not overlap with WPAs;\nAll Scottish roads differentiated by class using line width;\nAll the road segments that are Motorways, A or B roads within WPAs that are longer than 100m. These should use the same line widths as above to differentiate road class, but have a different colour from other roads.",
    "crumbs": [
      "Week 2 - Vector data",
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>Lab 4: Working with vector geometries</span>"
    ]
  },
  {
    "objectID": "sec_w3_rasters.html",
    "href": "sec_w3_rasters.html",
    "title": "Week 3 - Raster data",
    "section": "",
    "text": "ILOs covered",
    "crumbs": [
      "Week 3 - Raster data"
    ]
  },
  {
    "objectID": "sec_w3_rasters.html#ilos-covered",
    "href": "sec_w3_rasters.html#ilos-covered",
    "title": "Week 3 - Raster data",
    "section": "",
    "text": "Understand the structure of spatial data and choose appropriate data types and models for storing and representing it;\nObtain and assess the quality of spatial data from online and offline sources and produce new spatial data using computer and field methods;\nCreate map visualisations that adhere to cartographic principles and can be easily and unambiguously interpreted by the non-specialist public;\nPlan and execute GIS analytical steps to solve spatial problems successfully;",
    "crumbs": [
      "Week 3 - Raster data"
    ]
  },
  {
    "objectID": "sec_w3_rasters.html#what-will-you-learn",
    "href": "sec_w3_rasters.html#what-will-you-learn",
    "title": "Week 3 - Raster data",
    "section": "What will you learn",
    "text": "What will you learn\nFor every week, we will list the main theoretical and practical learning goals. Use these as a ‘checklist’ to gauge your learning for each week. If you don’t feel confident you have learned any specific topic, then revisit the week’s material!\n\nTheoretical knowledge for Week 3:\n\nWhat is the raster data model?\n\nHow are rasters represented?\n\nWhat are the components of a raster file (rows, columns, bands/channels, resolution)?\nWhat are the main raster file formats?\nWhat data types can rasters represent?\nWhat kinds of data can we represent using raster data?\nRaster / vector component equivalence\nRaster / vector tool equivalence\n\nNo concept of ‘ selection’\n\nWhat kinds of questions can we answer using rasters?\nHow can we transform rasters to vectors and vice-versa\n\nThe concept of raster resampling\nThe concept of raster contrast manipulation\n\n\n\n\nPractical knowledge:\n5  Lab 5: Working with raster data\n\nHow to identify raster files\nHow to load raster files\nHow to get raster properties\nHow to reproject raster data\nHow to mask rasters\nHow to set raster symbology\n\nContinuous variables\nCategorical variables\n\nHow to use the identify tool to get raster information on the fly\nWorking with Digital Elevation Models\n\nCalculating slope, aspect and viewshed\n\n\n6  Lab 6: The raster calculator and other rastery bits\n\nHow to calculate raster statistics\nHow to ‘select’ using the raster calculator\n\nBoolean operators on the same band\nBoolean operators between bands\nBand arithmetic\nMaking flowcharts\n\nMosaicking rasters\nHow to adjust the stretch of a raster\nStyling raster Images\nResampling methods",
    "crumbs": [
      "Week 3 - Raster data"
    ]
  },
  {
    "objectID": "lab_rasters_1.html",
    "href": "lab_rasters_1.html",
    "title": "5  Lab 5: Working with raster data",
    "section": "",
    "text": "5.1 Before you start!",
    "crumbs": [
      "Week 3 - Raster data",
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>Lab 5: Working with raster data</span>"
    ]
  },
  {
    "objectID": "lab_rasters_1.html#before-you-start",
    "href": "lab_rasters_1.html#before-you-start",
    "title": "5  Lab 5: Working with raster data",
    "section": "",
    "text": "Go through the Week 3 preparatory session on Canvas, and watch the seminar recording if you have missed it.",
    "crumbs": [
      "Week 3 - Raster data",
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>Lab 5: Working with raster data</span>"
    ]
  },
  {
    "objectID": "lab_rasters_1.html#guided-exercise-1---opening-and-inspecting-raster-data",
    "href": "lab_rasters_1.html#guided-exercise-1---opening-and-inspecting-raster-data",
    "title": "5  Lab 5: Working with raster data",
    "section": "5.2 Guided Exercise 1 - Opening and inspecting raster data",
    "text": "5.2 Guided Exercise 1 - Opening and inspecting raster data\n\nFor this exercise we will look at three different raster layers. The data has been pre-packaged and can be downloaded here. It includes the following datasets:\n\n\nUK SRTM: This is a single-band raster containing data from the [Shuttle Radar Topography Mission (SRTM)] (https://en.wikipedia.org/wiki/Shuttle_Radar_Topography_Mission), a global dataset of surface elevation. The data can be obtained from a variety of sources online.\nUK Bioclim: The BIOCLIM suite of climate data has been developed to support biodiversity studies and species distribution modelling. It is a single multiband raster file. Read this page for a description of which variable each band represents.\nCORINE land cover: CORINE is a EU-wide land cover map that is produced by the Copernicus Space Program. The pixel values are numerical codes that specify the different land cover classes. A description of each land cover number is given here.\nUK administrative boundaries from the GADM website, in geopackage vector file format.\n\n\nDownload the required data and organise it as you have learned. Create a new QGIS project and add the UK_SRTM.tif, UK_Bioclim.tif and CLC2018_CLC2018_V2018_20_UKclip.tif raster files to your project. All files are in GeoTIFF’ format, which is the most common and standard spatial raster file format.\nFor each of the raster layers, right-click on the layer name and go to Properties &gt; Information, then:\n\n\n\n\n\n\n\nStop and Think\n\n\n\n\nWhat is the data model of these files?\nWhat is the file format of these files?\nWhat are the data types of each raster file? Why is that important?\nWhat are the CRSs of each dataset you have?\nWhat are the dimensions (rows, columns) of each raster dataset?\nHow many bands does each raster dataset have?\nWhat are the pixel sizes (spatial resolution) of each raster dataset?\n\n\n\n\n\n\n\n\n\nClick for answer\n\n\n\n\n\n\nraster (vector for the boundaries)\nGeoTIFF for the rasters, geopackage for the vector\nThe data types can be found when looking at Properties &gt; Information for a raster layer. The SRTM and CORINE datasets are sixteen bit signed integer (INT16), the BIOCLIM dataset is a 32-but floating point raster. Raster data types are important as they determine the range and precision of the data that can be stored in the raster, and also impact the size of the raster file. For the same number of rows, columns and bandas, a 32-bit raster is twice as large as a 16-bit raster.\nGADM, SRTM, BIOCLIM: EPSG 4236 (WGS-84); CORINE: EPSG3035 (ETRS89 / Europe LAEA)\nThese are also found in Properties &gt; Information, as Width (columns) and Height(rows) or in Dimensions. SRTM: 16355 cols x 12036 rows; CORINE: 10473 cols x 12261 rows; BIOCLIM: 1471 cols x 1084 rows.\nThese are also found in Properties &gt; Information, as a list of bands, or in Dimensions. SRTM: 1 band, CORINE 1 band; BIOCLIM: 19 bands.\nThese are also found in Properties &gt; Information in Pixel Size. SRTM: 0.0008084837557075693617 degrees; CORINE: 100m; BIOCLIM: 0.008983152841195215371 degrees.",
    "crumbs": [
      "Week 3 - Raster data",
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>Lab 5: Working with raster data</span>"
    ]
  },
  {
    "objectID": "lab_rasters_1.html#guided-exercise-2---reprojecting-raster-data",
    "href": "lab_rasters_1.html#guided-exercise-2---reprojecting-raster-data",
    "title": "5  Lab 5: Working with raster data",
    "section": "5.3 Guided Exercise 2 - Reprojecting raster data",
    "text": "5.3 Guided Exercise 2 - Reprojecting raster data\nAs we learned in week 1, the UK looks “squished” because the data is projected using only the WGS-84 datum and geographic coordinates (EPSG:4236). Although data in geographic coordinates is often referred to as “unprojected,” this is not actually true (you are looking at it on a flat screen, right?). For these “unprojected” datasets, what most GIS software do is to simply use a linear function to convert latitudes and longitudes in degrees to x and y values on your screen. This projection can be referred to as Plate Carrée or Equirectangular projection, which has a heavy amount of distortion towards the poles:\n\n\nTo reproject raster data, go to Raster &gt; Projections &gt; Warp (Reproject...). Select your SRTM layer as the Input Layer, and the EPSG: 27700 - OSGB 1936 / British National Grid as the Target CRS. (If you don’t see it as an option, click on the small button to the right to bring up the CRS selection window). Set the Output file resolution... to 90 (this will be in meters, as meters are the units of the BNG projection). Leave everything else as default. Then click on the ... button to pick an appropriate folder location. Name uour file UK_SRTM_BG.tif. Run the algorithm and then Close when finished.\nRepeat the process for the Bioclim layer (use a cell size of 1000m) and the CORINE land cover map (cell size of 100m). These cell sizes are the meter equivalent of the degree pixel sizes the data currently has. Make sure you add the _BG suffix to the new file names to keep track of what has changed from one file to the other.\nIf it seems nothing has really changed, remember that QGIS does reprojections “on the fly” to make sure data on the screen are all aligned to the project CRS. So as you learned in Week 1, change the project CRS to EPSG:27700 as well. Now everything should look good.\nRemove the original layers from the project and keep only the reprojected ones, then save your project.",
    "crumbs": [
      "Week 3 - Raster data",
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>Lab 5: Working with raster data</span>"
    ]
  },
  {
    "objectID": "lab_rasters_1.html#guided-exercise-3---masking-rasters-using-vectors",
    "href": "lab_rasters_1.html#guided-exercise-3---masking-rasters-using-vectors",
    "title": "5  Lab 5: Working with raster data",
    "section": "5.4 Guided Exercise 3 - Masking rasters using vectors",
    "text": "5.4 Guided Exercise 3 - Masking rasters using vectors\nWe often want to remove portions (specific cells) of a raster, a process called masking. For example, some of our datasets include the Republic of Ireland and bits of mainland Europe, and some datasets include the Shetland Islands, while others don’t. Let use the UK boundaries from the GADM dataset to mask our data to the Island of Great Britain (Scotland, England and Wales) only.\n\nFirst add the GADM data (gadm36_GBR.gpkg) to your project. This geopackage holds multiple layers for the different levels of admin boundaries. You can just add the level 0 layer, which gets the UK as a whole.\n\n\n\n\n\n\n\nStop and Think\n\n\n\nWhy did you get a warning window when you added the layer to the project?\n\n\n\n\n\n\n\n\nClick for answer\n\n\n\n\n\nBecause this layer has a different CRS than the project, and QGIS it is asking you how to deal with it.\n\n\n\n\nAs we learned on Week 1, trying to do clipping (and masking) operations between layers with mismatched CRSs gives us wrong results. So before you do anything, reproject the UK boundaries layer to EPSG 27700. DO NOT go to Properties &gt; Layer CRS - that won’t reproject the data, just force a new CRS definition on it without changing the actual coordinates, and you will ruin your data. Go to Vector &gt; Data Management Tools &gt; Reproject Layer.\n\nYou also need to extract the mainland British Island from the rest of the dataset (just the one polygon that represents the bigger land mass). Turns out there is a quick way to do both at once, but first we need to deal with a little issue with the vector layer:\n\nOpen the Attribute Table of the UK boundaries layer. How many features does it have?\n\nThis is what is called a multipart polygon - a set of disjoint polygons all treated as a single feature. Before we can use the layer, we need to split the individual polygons apart to be able to select the main island only:\n\nGo to Vector &gt; Geometry Tools &gt; Multipart to Singleparts, and select the GADM layer. You can leave it as a temporary layer since we will only export one polygon for it in the next step. A new temp layer called Single parts will be created. Inspect its Attribute Table.\nNow use the feature selection tool () to select the one polygon for the mainland Great Britain only (no smaller islands!), and then right-click on the Single Part layer name and choose Export &gt; Save selected features as.... Pick a folder location and name the file GB_Island.shp. Before you click on OK, however, change the CRS drop-down menu to EPSG:27000. That is it, QGIS will now reproject the layer before saving it! Click OKto save, and then remove the original GADM and the temp layer from your project to keep things tidy. Save your project.\nDouble check what is the CRS of the new GB_island layer you have created.\nYou are now ready to mask the raster data. Go to Raster &gt; Extraction &gt; Clip Raster by Mask Layer.... As Input layer, select the SRTM layer, and as Mask layer, select the GB island layer. Then on the option Assign a specific nodata value to output bands, enter the number -32768. Make sure you include the minus sign! Leave the other options as default, but do check both the Match the extent of the clipped raster to the extent of the mask layer and Keep resolution of input raster options. Pick a folder and name your file UK_SRTM_BG_GBmask.tif. Now we can know at a glance that this is the SRTM data, reprojected to British Grid and masked to Great Britain.\n\n\n\n\n\n\n\nStop and Think\n\n\n\n\nWhy did we pick a value of -32768 for ‘nodata’?\nWhy should we check the Match the extent... and Keep Resolution.. boxes?\n\n\n\n\n\n\n\n\n\nClick for answer\n\n\n\n\n\n\nSince raster layers are grids (matrices) they must always be rectangular in shape. So when masking a raster using an irregular shape, the pixels outside the polygon will receive a value indicating nodata, but they will still exist. The default nodata value for QGIS is zero, but since we are dealing with elevations, zero is still a valid elevation value, and we could even have areas inland that are at sea level or lower, and thus have an elevation of zero or below. We also know our data is a signed 16 bit integer, that can take values from -32,768 to +32,767. So we pick the most negative elevation number within this range, which also would never occur on land (-32768 meters) to use as nodata.\nBy selecting the Match the extent of the clipped raster to the extent of the mask layer option when masking, the extent of the raster rectangle will be just enough to cover the GB polygon. If we left that unchecked, QGIS would set the non GB pixels to ‘nodata’, but leave the raster with the original dimensions. That would be a waste of disk space. We also check Keep resolution... to make sure QGIS doesn;t change the pixel sizes to better ‘fit’ the rectangle to the extent. The spatial resolution of a raster file often has a reason to be, and we don’t want to arbitrarily change that.\n\n\n\n\n\nUse the Identify Features tool () to click on blank area of the masked SRTM layer (near the shore). Make sure you have the SRTM layer selected on the Layers panel before you click the tool. What pixel values do you get? -32768 or ‘nodata’?\nNow go to the Properties &gt; Transparency tab of the SRTM raster layer, and uncheck the No data value: -32768 box. Look at your raster again, and probe the same areas with the Identify Features tool. Can you see now how the actual raster is still a rectangle, with the pixels outside the mask set to -32768? Before you proceed, go back and check the No data: -32768 box again.\nNow repeat the masking for the CORINE and BIOCLIM layers. You can use the same nodata number for the CORINE and BIOCLIM layers. the CORINE layer actually already has nodata defined as -32768 so we just keep it. And for Bioclim, it is an unlikely value for any of the climatic variables, and because the climate data is a floating point number (decimal), it is almost impossible that a perfect value of -32768.000000 would exist in the data naturally.\nRemove the non-masked raster datasets from your project and save it.\nNow zoom in into any place on the coastline, and answer:\n\n\n\n\n\n\n\nStop and Think\n\n\n\nWhy don’t the edges of each raster dataset line up perfectly?\n\n\n\n\n\n\n\n\nClick for answer\n\n\n\n\n\n\nAgain, this is a side effect from raster layers being grids. As each one has a different pixel size, the decision of which pixel is inside our outside the GB vector polygon will be different for each layer. Also, the coastline will always appear ‘ragged’ because we can’t represent any detail smaller than a single pixel on a raster file - and the pixel grids of the three layers do not align because of the pixel sizes.",
    "crumbs": [
      "Week 3 - Raster data",
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>Lab 5: Working with raster data</span>"
    ]
  },
  {
    "objectID": "lab_rasters_1.html#guided-exercise-4---styling-raster-data",
    "href": "lab_rasters_1.html#guided-exercise-4---styling-raster-data",
    "title": "5  Lab 5: Working with raster data",
    "section": "5.5 Guided Exercise 4 - Styling raster data",
    "text": "5.5 Guided Exercise 4 - Styling raster data\nJust as with vector data, QGIS offers many options for the symbology of raster data. You will see some similarities between the symbology options for vectors and rasters, but also some differences because of the nature of each data model.\n\nTurn off all layers except the CORINE land cover, and then go to its Properties &gt; Symbology. Note that the default Render Type for single-band rasters is Singleband gray. That means pixels are coloured by a shade of grey that is proportional to its numeric value, with higher values being closer to white. Change it to Paletted / Unique Values. Maintain the Band 1 selection (there is only one band anyway) and Random Colors options, and then click on Classify. Apply the result to your raster and visualise it.\n\n\n\n\n\n\n\nStop and Think\n\n\n\n\nHow many categories are there on this raster?\nWhat are the pixel values representing?\nWhat would be the vector symbology equivalent of Paletted / Unique Values?\n\n\n\n\n\n\n\n\n\nClick for answer\n\n\n\n\n\n\n36 categories (unique pixel values)\nEach pixel value is a numerical code that indicates a land cover type.\nthe Categorized option.\n\n\n\n\nWHoa, there are a lot of classes, and the random colours selection picked colours that are very similar to one another for some of the classes. Fortunately for us, the data producers of CORINE include a colour map file as part of the metadata. Let us use it!\n\nBack on the Properties &gt; Symbology window, click on the ... button to the right of Delete All and choose Load Color Map from File.... Within the CORINE files you unzipped, find and select the metadata file named CLC2018_CLC2018_V2018_20_QGIS.txt. Applyand then click OK. Not only we get the colours selected by the CORIEN mapping team, but also all the proper class names! That was nice!\nNow let us have a look at the BIOCLIM dataset. First, read the metadata included with the data files (Bioclim_metadata.txt) to understand what each band of this dataset represents. Then turn on the BIOLCIM layer and turn the remaining layers off.\n\n\n\n\n\n\n\nStop and Think\n\n\n\nWhy does the BIOCLIM layer appears to be coloured?\n\n\n\n\n\n\n\n\nClick for answer\n\n\n\n\n\nWhen QGIS opens a multiband, single file raster, it always thinks that the file is an image, and thus it automatically assigns the first three bands of the file to the Red, Green, and Blue colour channels. We will look at raster images in the next session, but this color composition clearly doesn’t make sense for our climate data, so let us change it.\n\n\n\n\nGo to the Properties &gt;  Symbology window for the BIOCLIM dataset. Notice the default symbology choice of Multiband color. Since each band of our data represents a different climatic variable, with continuous numeric values (not categories or classes), we need to pick the Single band - pseudocolor option. Choose the bio1 band, and for the colour ramp, click on the down-arrow button to the right of the colour palette button, and select the magma colour ramp. Classify the existing values and then Apply and click OK. How does the layer look like now?\n\n\n\n\n\n\n\nStop and Think\n\n\n\n\nWhat would be the vector symbology equivalent of Single band  - pseudocolor?\nWhat climatic variable is “bio01” representing?\nWhat units are the minimum and maximum values shown on the colour scale?\nWhy such a strange choice for the units?\n\n\n\n\n\n\n\n\n\nClick for answer\n\n\n\n\n\n\nThe Graduated option.\nThe metadata file tells us it is Annual Mean Temperature.\nThe metadata file also tells us it is °C * 10 (deegrees celsius times ten)\nThis is an old trick to reduce file sizes while keeping some precision. Let’s say the data creators wanted to record temperatures with one decimal place of precision. If they stored the data as a floating point, we would need 32-bit files. But if we consider that mean annual temperatures on Earth will easily be contained in the range of -100 to +100 degrees Celsius, we could instead multiply all numbers by ten, and store them as 16-bit integers instead, cutting file sizes in half. For example, a temperature of 32.7°C becomes a pixel value of 327.\n\n\n\n\n\nExplore some of the other climatic variables contained in the BIOCLIM dataset, using different colour ramps.\n\nFinally, let’s work on the symbology for the SRTM data. For that, we will take advantage of some nice scientific colour palettes that are built-in on QGIS. We will talk about what makes these palettes special on Week 4, but let us just use them now.\n\nOn the Properties &gt; Symbology window of the SRTM layer, choose the Singleband Pseudocolor option, and then on th down arrow button besides the Color Ramp option, select Create New Color Ramp. On the small options window that comes up, select Catalog:cpt-city.\nOnce the catalogue window opens, go to the Topography list and select the cd-a palette. Then manually enter Min and Max values, using 0 and 900 respectively. Apply and see how it changes. But before clicking on OK, go to the Transparency tab and drag the slider at the top to around 60%. That will let other layers under it to show through and blend with the colours.\nRight-click on the SRTM layer name and select Duplicate layer. This option creates a ‘virtual’ copy of the layer - it will still point to the same file on disk, but you are able to select a different symbology for it.\n\n(@)Now, on the Properties &gt; Symbology of the copied layer, change the render type to Hillshade. Leave everything as default, then Apply and close the window. Make sure both the coloured and the hillshade SRTM layers are turned on on the Layer Panel, and that the hillshade layer is immediately under the coloured SRTM layer. Zoom in and turn each layer on and off in turn to understand how this neat ‘3-D’ visual effect works.\n\n\n\n\n\n\nStop and Think\n\n\n\nWhat does the hillshade render style does?\n\n\n\n\n\n\n\n\nClick for answer\n\n\n\n\n\nIt uses the elevation information to simulate how different areas of the terrain would be illuminated or shaded by sunlight coming from a certain sun elevation and azimuth (direction).",
    "crumbs": [
      "Week 3 - Raster data",
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>Lab 5: Working with raster data</span>"
    ]
  },
  {
    "objectID": "lab_rasters_1.html#guided-exercise-5---terrain-calculations",
    "href": "lab_rasters_1.html#guided-exercise-5---terrain-calculations",
    "title": "5  Lab 5: Working with raster data",
    "section": "5.6 Guided Exercise 5 - Terrain Calculations",
    "text": "5.6 Guided Exercise 5 - Terrain Calculations\nOne of the most common raster datasets used in GIS are Digital Elevation Models or DEMS. The structure of raster data is particularly well suited to represent terrain, in its continuous and highly variable nature. Moreover, terrain and elevation data is often a key variable in GIS analysis, as it directly influences most biological, geological and anthropic processes.\nFor this reason, a few specific terrain analysis tools that are always included in GIS software, and used often. These are the methods to calculate slopes(a.k.a grades, gradients), aspects and viewsheds, using DEMs as the base data.\n\n5.6.1 Plugins\nIn this exercise, you will also learn about one of the most powerful aspects of QGIS: plugins. As you may know, QGIS is a free and open-source software, meaning anyone can contribute with the code. QGIS also makes it easy for it’s functionality to be extended via plugins, separate little ‘apps’ that add new tools and capabilities to the main QGIS app. For this exercise, we will install and use two official QGIS plugins, the QuickMapServices and Visibility Analysis.\n\nHead to the menu Plugins &gt; Manage and Install Plugins. You will se a window like the one below. Then select the Not Installed tab, and then on the search bar search for QuickMapServices. Select it on the left panel, and then click on Install Plugin. Then repeat this process to find and install the Visibility Analysis plugin.\n\n\n\nThe QuickMapServices plugin will add a new menu entry: Web &gt; QuickMapServices. Once yo8u click on it, you will see a list of web map services - but there is more. Go to Web &gt; QuickMapServices &gt; Settings, and then click on the More services tab. Then read the warning and click on Get contributed pack, and once you get a confirmation message, click on Save and exit the window.\n\n\n\nNow go back to Web &gt; QuickMapServices &gt; Settings, and you will see a list of providers. For example, go to the Web &gt; QuickMapServices &gt; Google option and add the Google Hybrid dataset directly as layer in your project! These layers will require you to be connected to Internet to work, and they won;t give you many symbology options, but they are very handy to help in navigation when working on a project.\nTake some time to explore the layers available in this plugin.\n\n\n\n5.6.2 Masking by area\nEarlier today you have learned how to use a vector polygon to mask a raster layer. But sometimes we just want to ‘freeform’ cut a piece of a raster, without the need to be too precise. In that case, we can use the Clip Raster by Extent function.\n\nMake sure you Google Hybrid web layer is visible, and navigate until you frame the ‘Stirling-Glasgow-Edinburgh triangle’ in your canvas, like the image below:\n\n (@) Then go to Raster &gt; Extract &gt; Clip Raster by Extent.... Pick the SRTM layer as Input layer, and then for Clipping Extent, click on the small button to the right with a small arrow figure. That will set the cut area to be exactly what you are viewing on the canvas. But there are other options. If you click on the small down-arrow button to the right, you can use the extent (bounding box) of another layer, as well some more advanced options. You can also click on Draw on map canvas to be allowed to drag a rectangle over your map canvas that sets the extent of the cut.\n\nMask the SRTM layer to the region including Stirling, Glasgow and Edinburgh, either by setting you map canvas zoom and using it as extent, or by clicking and dragging to set the extent. Then pick a proper folder and save it as UK_SRTM_BG_centralscotland.tif. You should end up with something like this (but your extent will likely vary):\n\n\n\n\n5.6.3 Calculating slope and aspect\nWe can now use our Central Scotland subset to demonstrate how to calculate slope and aspect.\n\nGo to Raster &gt; Analysis &gt; Slope..., and pick the Central Scotland DEM you created as Input Layer. Leave everything else as default and then pick a proper folder to save the new file as UK_SRTM_BG_centralscot_slope.tif. Then Run and Close. You will get a new raster layer, where the pixel values indicate the steepness of each pixel, in degrees. Steep slopes will appear as light grey/white, and flat areas will appear dark:\n\n\n\nNow go to Raster &gt; Analysis &gt; Aspect..., and again pick the Central Scotland DEM you created as Input Layer. Leave everything else as default and pick a folder to save the new file as UK_SRTM_BG_centralscot_aspect.tif. Run and Close. This layer will now tell you the cardinal direction, in degrees (North = 0/360),, that each slope is facing.\nUse the Indentify Features... tool to explore some of the aspect and slope values you have calculated.\n\n\n\n5.6.4 Viewshed analysis\nFinally, let us calculate a ‘viewshed’ - raster indicating which points in the Earth surface are visible from a given point, considering the topography. Viewshed analysis is often used for landscape planning - for example, determining from where a wind power turbine may be visible or not.\nThe Visibility Analysis plugin adds some option to the Processing panel of QGIS. To see it, click on the Processing Toolbox button on the main QGIS toolbar (), and the panel will open to the right. This panel houses many, many more GIS functions beyond those available on the Vector and Raster menus, and we will use it often during the last weeks of the module.\n\n\nDownload the observation_point,shp file from this link.\nOpen the Visibility Analysis heading on the Processing Toolbox, and then double click on Create Viewpoints. A new window will open. On this window, you need to pick the Observer Location, which will be the Observation point layer, and then the DEM, which will be the Central Scotland SRTM (make sure you don’t pick the slope or aspect layers by mistake!).\nThere are many options that you don’t need to worry about for now, but three warrant some explanation: Radius of Analysis specifies how far you want to calculate the viewshed - it is an expensive computation so it may make sense to limit it. Let’s use 20,000 meters for our analysis. Then pat attention to Observer Height and Target Height. They determine what is the height of the observation being made (above the elevation of the observation point), and also what would be the height of the target. So again, if you are wondering if a wind power turbine would be visible from that location, you should add the height of the turbine to the Target Height field. You can leave these options at 1.6m and zero, respectively. Then pick a folder and save the viewpoint as viewpoint.shp, and Run the tool.\nNow go back to the Processing Toolbox and double click on Viewshed. Pick the Viewpoint layer as Observer Location, and the Central Scotland DEM as Digital Elevation Model. Leave everything else as default, and pick a folder to save your viewshed analysis as viewshed.tif (it wil be a raster file).\n\nYou should get an output similar to the figure below, where white pixels (value 1) indicate ‘visible’ and black pixels (value 0) indicate “not visible’.\n ## Guided Exercise 6 - Cleaning up and saving your project for the next lab\nWe will use the data you produced on this lab to get started on the next, so let us ’package’it properly.\n\nRemove all layers from the project except for the SRTM, CORINE, BIOCLIM and GADM layers that you have reprojected and masked for the GB island. Save your project\nDelete from the folder all files except for the files for the four data layers above. If you saved the GB island vector as a shapefile, remember you need to keep all files with the same name but different extensions (.shp, .shx, .dbf, .prj)\nOn your systems file explorer, find the base folder for today’s lab according to your organization, and right click on it. On Windows, choose Compress to... to create a zipfile containing your entire project. Name it as lab_5_final_results.zip or something similar.\nNow store this zipfile on your university’s OneDrive or on some external drive, so that you can re-download it when you need it for the next session.\n\nCongratulations, you reached the end of Lab 5. You should now understand the raster data model and how to mask it and style it. You have also learned some common terrain analysis tools. In the next lab, we will learn about the Raster Calculator, which fulfils the role of both the Field Calculator and Select by Attribute for rasters.",
    "crumbs": [
      "Week 3 - Raster data",
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>Lab 5: Working with raster data</span>"
    ]
  },
  {
    "objectID": "lab_rasters_2.html",
    "href": "lab_rasters_2.html",
    "title": "6  Lab 6: The raster calculator and other rastery bits",
    "section": "",
    "text": "6.1 Before you start!",
    "crumbs": [
      "Week 3 - Raster data",
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>Lab 6: The raster calculator and other rastery bits</span>"
    ]
  },
  {
    "objectID": "lab_rasters_2.html#before-you-start",
    "href": "lab_rasters_2.html#before-you-start",
    "title": "6  Lab 6: The raster calculator and other rastery bits",
    "section": "",
    "text": "Go through the Week 3 preparatory session on Canvas, and watch the seminar recording if you have missed it. Also make sure you have completed all labs prior to this one.",
    "crumbs": [
      "Week 3 - Raster data",
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>Lab 6: The raster calculator and other rastery bits</span>"
    ]
  },
  {
    "objectID": "lab_rasters_2.html#guided-exercise-1---global-raster-statistics",
    "href": "lab_rasters_2.html#guided-exercise-1---global-raster-statistics",
    "title": "6  Lab 6: The raster calculator and other rastery bits",
    "section": "6.2 Guided Exercise 1 - Global raster statistics",
    "text": "6.2 Guided Exercise 1 - Global raster statistics\nIn this exercise, we will use the layers from the previous lab to learn about raster statistics and the raster calculator.\n\n6.2.1 Recovering your data\nAt the end of last week’s lab you saved the final results of your project as a zipfile. Retrieve this file, extract the contents, and re-open your project. It should have these four layers in it:\n\nPolygon vector layer of the Island of Great Britain\nRaster layer of the SRTM digital elevation model (reprojected to EPSG:27700 and masked to the GB island)\nRaster file of the CORINE land cover dataset (reprojected to EPSG:27700 and masked to the GB island)\nRaster file of the BIOCLIM climatic dataset (reprojected to EPSG:27700 and masked to the GB island)\n\n(if this doesn’t work, I have a copy of the files here. But you should really try to make it work with your own saved data - storing and retrieving prioject data is a key skill you need to develop!)\n\n\n6.2.2 Global raster statistics\nWinter is coming, and you want to escape the worst of the cold and rain. You therefore decide to use your GIS skills to find the ideal place to spend your winter in the UK - an urban area with lower precipitation and higher minimum temperatures. For convenience, we will restrict oour search to the Island of Great Britain, as we already have data for it ready to go.\nTo get started, you would like to know what is the overall range of precipitation and temperature values for the entire island, using the BIOCLIM data. If this was a vector dataset, you would use the Statistical Summary Tool - but it is a raster. What would be the equivalent operation?\n\nThe tool we need is called Raster Layer Statistics, but it is not located in the Raster menu. Instead, we need to launch the Processing panel ( . This panel contains a lot of additional GIS functions, and we will use it often now.\nOnce you have the Processing panel open, you can either search for Raster Layer Statistics or find it under the Raster analysis heading. Double click on it to launch the tool window. It should look like this:\n\n\nLooking at the BIOCLIM data description, the two useful pieces of climatic data you need to get statistics for are BIO6 - Minimum Temperature of the Coldest Month, and BIO12 - Annual Precipitation. The BIO variables are ordered in the file, so band 6 is BIO6, and Band 12 is BIO12.\n\nIn the Raster Layer Statistics window, select the BIOCLIM layer as Input Layer and band 06 as band number. You can keep the results as a temporaty file. Run it and Close the window. A new panel will have appeared under the Processing panel, called Results Viewer. It will have an entry called Statistics. Double click on it and take note of the minimum and maximum BIO6 values (-75 and 33).\n\n\n\n\n\n\n\nStop and Think\n\n\n\nDo these values seem too extreme for the UK? What is going on here?\n\n\n\n\n\n\n\n\nClick for answer\n\n\n\n\n\nThe metadata for the BIO layers states that temperature values are scaled by a factor of 10, so you need to divide these numbers by 10 to get proper Celsius units.\n\n\n\n\nNow repeat the process to get the Min and Max values for BIO12 (532 and 2311)\n\n\n\n\n\n\n\nStop and Think\n\n\n\nWhat are the units for precipitation?\n\n\n\n\n\n\n\n\nClick for answer\n\n\n\n\n\nThe metadata for the BIO layers states that annual precipitation is given in mm. One milimitre of rain is equal to one liter per squared metre.",
    "crumbs": [
      "Week 3 - Raster data",
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>Lab 6: The raster calculator and other rastery bits</span>"
    ]
  },
  {
    "objectID": "lab_rasters_2.html#guided-exercise-2---per-pixel-calculations-with-the-raster-calculator",
    "href": "lab_rasters_2.html#guided-exercise-2---per-pixel-calculations-with-the-raster-calculator",
    "title": "6  Lab 6: The raster calculator and other rastery bits",
    "section": "6.3 Guided Exercise 2 - Per-pixel calculations with the raster calculator",
    "text": "6.3 Guided Exercise 2 - Per-pixel calculations with the raster calculator\nAlthough it is easy enough to covert the temperature pixel values to Celsius in our heads, it would be useful to have the data in the proper units, especially if we want to map it later. Let us use the Raster Calculator to apply the conversion factor to all pixels.\n\nGo to the menu Raster &gt; Raster Calculator to launch the calculator. It will look like this:\n\n\nThe general idea is similar to the Field Calculator, with a slightly different layout. The top right panel lists all raster bands in the project (so UK_bioclim_BG_GBmasked@19 means band 19 of the BIOCLIM raster). The top right panel lets us pick some options for our raster creation, and the bottom panel lets us type expressions.\n\nWe need to divide all BIO6 temperature values by 10. Double click on the BIOCLIM band 6 in the bands list to add it to the expression panel, and then add the division by 10. On my project, the final expression panel reads as \"UK_bioclim_BG_GBmasked@6\" / 10, but your BIOCLIM layer may not be named the same as mine. Note that the bottom of the expression panel should say Expression Valid. If it says Expression Invalid, check your typing (did you use the double quotes?)\nFor Output Layer, click on the ... button and pick a folder to save the new file. Name it UK_bioclim_BG_GBmasked_BIO6_celsius.tif. Leave the rest as default and click in OK.\n\n\n\n\n\n\n\nStop and Think\n\n\n\nHow many bands has your newly created file?\n\n\n\n\n\n\n\n\nClick for answer\n\n\n\n\n\nOnly one band, holding the results of the calculation.\n\n\n\nEvery time you enter an expression involving a raster band and a single number in the Raster Calculator you are telling QGIS to apply the same expression to each pixel of that band. In our case, we divided all pixel values by 10.",
    "crumbs": [
      "Week 3 - Raster data",
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>Lab 6: The raster calculator and other rastery bits</span>"
    ]
  },
  {
    "objectID": "lab_rasters_2.html#guided-exercise-3---boolean-logical-operations-with-the-raster-calculator",
    "href": "lab_rasters_2.html#guided-exercise-3---boolean-logical-operations-with-the-raster-calculator",
    "title": "6  Lab 6: The raster calculator and other rastery bits",
    "section": "6.4 Guided Exercise 3 - Boolean (logical) operations with the raster calculator",
    "text": "6.4 Guided Exercise 3 - Boolean (logical) operations with the raster calculator\nThe Raster Calculator also fulfills the role of the vector Select by expression tool for rasters. The result of any raster logical operation is either 1 (True) or 0 (False), i.e. a binary raster, sometimes called a raster mask.\nLet us find the warmer places in Great Britain. Our highest minimum temperature of the coldest month (BIO6) value was 3.3 degrees, not too far from zero. So let us limit our search to any places that don’t go below 0 Celsius.\n\nOpen the Raster Calculator again, and this time use the expression \"UK_bioclim_BG_GBmask_BIO6_celsius@1\" &gt; 0. Notice we used here the layer that we just converted to degrees Celsius. Save the results in a proper folder with the name GB_mintemp_gt_0.tif (gt for ‘greater than’) and run the calculation. You should get something like this:\n\n By default, QGIS will paint pixels with a value of 1 white, and 2 black. So the white areas now show us all regions of Great Britain that on average don’t go below zero in the worst of winter (these are long term climatic averages). Use the Identify Features tool to check if the pixel values are really 0 and 1.\n\nNow repeat the process for the precipitation layer. Our minimum annual precipitation value was just above 500, so let us limit us to areas under 700mm of precipitation. Save the result as GB_anprec_lt_700.tif.",
    "crumbs": [
      "Week 3 - Raster data",
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>Lab 6: The raster calculator and other rastery bits</span>"
    ]
  },
  {
    "objectID": "lab_rasters_2.html#guided-exercise-4---raster-reclassification",
    "href": "lab_rasters_2.html#guided-exercise-4---raster-reclassification",
    "title": "6  Lab 6: The raster calculator and other rastery bits",
    "section": "6.5 Guided Exercise 4 - Raster reclassification",
    "text": "6.5 Guided Exercise 4 - Raster reclassification\nAn alternative to the Raster Calculator that can be handier when you have multiple ranges to recode is the Reclassify by table tool in the Processing panel, also under the Raster Analysis heading. Find the tool and open it, and you will see this:\n\nLet us use this tool to extract the urban areas from the CORINE dataset. looking at the metadata, the two classes od interest are Continuous Urban Fabric (pixel value 111) and Discontinuous Urban Fabric (112) classes, which are the classes were we would expect existing housing to be located.\n\nOn the Reclassify by table window, pick the CORINE layer as your Raster layer, and band 1 as your Band Number. Then click on the ... button besides the box to open the Reclassification  table, and fill the table like the figure below. Click to add rows as necessary.\n\n\n\nClick on te blue arrow to go back to main tool window, then set the nodata value back to -32768, the Range Boundaries to min &lt;= value &lt;= max and the Output Data Type to Byte. Save it as GB_urban_areas.tif.\n\n\n\n\n\n\n\nStop and Think\n\n\n\nHow could you have done the analysis above using the Raster Calculator instead?\n\n\n\n\n\n\n\n\nClick for answer\n\n\n\n\n\nYou could do \"CORINE_BG_GBmask@1\" = 111 OR \"CORINE_BG_GBmask@1\" = 112. Notice how you can use AND and OR to chain logical expressions as you can for vectors - but because computers are dumb, you need to repeat the name of the layer after the OR (and for each additional expression you add).\nYou could also do ranges, using an expression such as \"CORINE_BG_GBmask@1\" &gt; 110 AND \"CORINE_BG_GBmask@1\" &lt; 113 (notice the use of AND instead of OR for ranges) since they are consecutive values, or use \"CORINE_BG_GBmask@1\" &gt;=111 AND \"CORINE_BG_GBmask@1\" &lt;= 112). Using ranges is more quicker than using = and OR when you have many consecutive values to search for.",
    "crumbs": [
      "Week 3 - Raster data",
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>Lab 6: The raster calculator and other rastery bits</span>"
    ]
  },
  {
    "objectID": "lab_rasters_2.html#guided-exercise-5---raster-vs.-raster-calculations",
    "href": "lab_rasters_2.html#guided-exercise-5---raster-vs.-raster-calculations",
    "title": "6  Lab 6: The raster calculator and other rastery bits",
    "section": "6.6 Guided Exercise 5 - raster vs. raster calculations",
    "text": "6.6 Guided Exercise 5 - raster vs. raster calculations\nWe now have three raster masks showing us 1) all the GB areas that don’t go below zero Celsius, 2) the areas that have less than 700mm of rain, and 3) the areas that are urban. How can we combine them into a single layer?\nThe answer to the above question is still the Raster Calculator. We know the pixels we ‘want’ are numbered 1 on each layer, otherwise they are 0. So if we could multiply one layer by the other, i.e. multiply the value of each set of overlapping pixels, we would get a new raster whith values of \\(1 \\times 1 \\times 1 = 1\\) when both conditions are met, and a result of \\(0\\) if any of the the conditions is not met. This is why binary rasters are also called raster masks - when you multiply any other raster by it, it masks (i.e. zeroes out) anything that is not True in the mask.\nDoing it using the Raster Calculator is as simple as it sounds:\n\nOpen the Raster Calculator and enter the expression \"GB_anprec_lt_700@1\" * \"GB_mintemp_gt_0@1\" * GB_urban_areas@1. Then save you layer with name UKs_winter_havens.tif.",
    "crumbs": [
      "Week 3 - Raster data",
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>Lab 6: The raster calculator and other rastery bits</span>"
    ]
  },
  {
    "objectID": "lab_rasters_2.html#guided-exercise-6---vectorizing-rasters",
    "href": "lab_rasters_2.html#guided-exercise-6---vectorizing-rasters",
    "title": "6  Lab 6: The raster calculator and other rastery bits",
    "section": "6.7 Guided Exercise 6 - Vectorizing rasters",
    "text": "6.7 Guided Exercise 6 - Vectorizing rasters\nThe final result of your analysis should consist of only a handful of pixels - such is lifev in the UK. And since these are discrete locations, it may occur to you they would be better represented and visualised as vectors. Turns out we can convert raster to vectors and vice versa:\n\nGo to Raster &gt; Conversion &gt; Polygonize (Raster to Vector).... In the new window, pick your results layer as the Input Layer, Band 1 as the Band number, and leave the rest as default (DN here means digital number, another name for pixel values. Then pick a folder ans save the results as UK_winter_havens_poly.shp (or geopackage if you prefer).\nYou will notice that a very large polygon was also created for the 0 areas of the raster. You can then put the new vector layer in editing mode, use the Selection Tool to select this polygon, and then hit the Delete key on your keyboard to get rid of it. Then save the changes and exit edit mode.\n\n\n\n\n\n\n\nWarning\n\n\n\nPolygonising rasters can be a very computationally-heavy operation if you have large rasters and/or many scattered pixel values (for example, vectorising the original CORINE layer with all classes). And it is virtually useless for continuous rasters such as temperature or elevation (you would end up with one polygon per pixel as there would be no adjacent pixels with the same value).\nSo if you start an analysis with raster data, try to do as much as you can in the raster domain, before vectorising anything. But if your raster results represent isolated small regions within a large matrix of ‘no data’ or zero values, then vectorising is a good idea.\n\n\nYou now have polygons representing all adjacent areas that were values as ‘1’ in your raster. But many of them are still only one pixel. What if you wanted to have points instead of polygons?\n\nIn the Processing panel, you will find a tool called Raster Pixels to Points, which you can use to generate the points. I’ll leave the detauils to you, but here is a tip: before you use the tool, go the Properties &gt; Transparency of your raster results layer, and set 0 as an Additional Nodata Value. Otherwise Raster Pixels to Points will create one point for every pixel, including the pixels with a value of 0. That’s a lot of points.",
    "crumbs": [
      "Week 3 - Raster data",
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>Lab 6: The raster calculator and other rastery bits</span>"
    ]
  },
  {
    "objectID": "lab_rasters_2.html#guided-exercise-7---mosaicking-and-stacking-rasters",
    "href": "lab_rasters_2.html#guided-exercise-7---mosaicking-and-stacking-rasters",
    "title": "6  Lab 6: The raster calculator and other rastery bits",
    "section": "6.8 Guided Exercise 7 - Mosaicking and Stacking rasters",
    "text": "6.8 Guided Exercise 7 - Mosaicking and Stacking rasters\nRaster files are often very large and ‘heavy’, so it is common to distribute them as tiles or scenes, i.e. smaller adjacent pieces that can be merged back together to cover a certain area of interest. For satellite images, it is also common for each image band to be stored as a separate file (unlike regular photos that only have Blue, Red and Geeen bands, satellite images can have several more bands, covering areas of the spectrum we can’t normally see. The Sentinel-2 satellite, for example, has a total of 13 bands:\n\n\n\nBand\nWavelength\nDescription\n\n\n\n\nB1\n443 nm\nUltra Blue (Coastal and Aerosol)\n\n\nB2\n490 nm\nBlue\n\n\nB3\n560 nm\nGreen\n\n\nB4\n665 nm\nRed\n\n\nB5\n705 nm\nVisible and Near Infrared (VNIR)\n\n\nB6\n740 nm\nVisible and Near Infrared (VNIR)\n\n\nB7\n783 nm\nVisible and Near Infrared (VNIR)\n\n\nB8\n842 nm\nVisible and Near Infrared (VNIR)\n\n\nB8a\n865 nm\nVisible and Near Infrared (VNIR)\n\n\nB9\n940 nm\nShort Wave Infrared (SWIR)\n\n\nB10\n1375 nm\nShort Wave Infrared (SWIR)\n\n\nB11\n1610 nm\nShort Wave Infrared (SWIR)\n\n\nB12\n2190 nm\nShort Wave Infrared (SWIR)\n\n\n\nIn this exercise, we will learn how to a) mosaic rasters - ‘glue’ them together side by side to cover a larger area and b) stack rasters - merge the different band files into a single file.\n\nDownload the data for this specific exercise from this link. It contains four aerial photographs covering the University of Stirling campus and the Wallace Monument area. Extract the data and organise it as usual.\n\n\n\n\n\n\n\nTip\n\n\n\nThese images were originally downloaded from the ‘Aerial’ section of Digimap - if you ever need very detailed imagery of the UK land, check it out!\n\n\n\nEach image is stored within its own folder, named nsXXXX, where XXXX is a four digit number. Start a new project and load into QGIS all the .tif files in all four folders. There should be six files in total.\n\n\n\n\n\n\n\nStop and Think\n\n\n\nWhat do you think is the meaning of the nsXXXX folder names?\n\n\n\n\n\n\n\n\nClick for answer\n\n\n\n\n\nThey indicate tiles in the OS British Grid system.\n\n\n\nNotice that the airphoto for tile ns8196 has been provided with its three colour bands (RGB) as separate files - simulating what you would expect for satellite files. To be able to see this aerial photo in colour, we must first stack these bands into a single file. The operation is called stack because you could visualise it as physically stacking them one on top of the other.\n\nGo to Raster &gt; Miscellaneous &gt; Merge.... You will get a window like this:\n\n (@) For Input Layers, click on the ... button, and a list of all available raster layers in your project will appear. You can drag the layer names to reorder them, and your final selection should the ns8196_R, ns8196_G, and ns8196_B layers, in the order below from top to bottom. This sets the order of the bands inside the file.\n (@) Once you have selected the layers, click on the blue arrow to go back to the main window, then set the following parameters: check the box for Place each input file into a separate band (that tells QGIS you want a stack), and the Output Data Type to Byte. Then save the resulting file as ns8196_RGB.tif, in the same folder where you had the three separate band files.\n\n\n\n\n\n\nStop and Think\n\n\n\nWhy do we change Output Data Type to Byte?\n\n\n\n\n\n\n\n\nClick for answer\n\n\n\n\n\nThe RGB colour system uses one byte (8-bits, 0-255 integer numbers) per colour channel to designate any colour. For example, the University of Stirling official green colour () is R=0 G=105 B=56. The Byte option ensures we only use 8-bits per band, and keep the file size smaller. If we left it as Float32, the same 0-225 integer numbers would be stored as 32-bit decimal numbers, quadrupling the size of the file for no reason.\n\n\n\n\nYou should now have a properly colored image for tile ns8196. Remove the three original single band layers from the project and then save it.\n\nEverything looks good colour-wise now, bur our airphoto is still actually four separate adjacent photos. That means any processing we may want to do involving the entire area would have to be repeated four times. We can however merge these four tiles in a single airphoto mosaic.\n\nGo back to Raster &gt; Miscellaneous &gt; Merge.... Yes, it is a bit confusing, QGIS uses the same tool for both stacking and mosaicking.\nThis time, check the four tiled RGB images as your Input Layers - order doesn’t matter. Then make sure to not check the Place each input file into a separate band option. That will tell QGIS you want a mosaic and not a stack. Set the Output Data Type to Byte again, and save it as UoS_RGB_mosaic.tif. You should now have a single airphoto layer covering the entire area. Remove the previous individual layers from the project and save it again.",
    "crumbs": [
      "Week 3 - Raster data",
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>Lab 6: The raster calculator and other rastery bits</span>"
    ]
  },
  {
    "objectID": "lab_rasters_2.html#guided-exercise-8---raster-image-stretching",
    "href": "lab_rasters_2.html#guided-exercise-8---raster-image-stretching",
    "title": "6  Lab 6: The raster calculator and other rastery bits",
    "section": "6.9 Guided Exercise 8 - Raster image stretching",
    "text": "6.9 Guided Exercise 8 - Raster image stretching\nWhen working with multiband color images in a GIS environment, we can often manipulate the contrast of an image by applying different contrast stretches to each band. Especially when working with satellite images, which tend to look a bit ‘faded’ because of the atmospheric effect, stretching can make our images more vivid and easier to interpret.\n\nRight-click on the airphoto mosaic layer you created and go to Properties &gt; Symbology. You will se that the symbology type is Multiband color, which is the correct choice for representing images. Note that each band is associated to a colour channel (R, G, B), but this association can be changed at will. Change the Red band to band 2, and the Green band to band 1, then Apply. Now the vegetation appears red! Change it back to the proper colour order and Apply again.\n\n\n\n\n\n\n\nTip\n\n\n\nThis is a useful feature when working with satellite images, which often have bands representing spectral regions that we cannot see, such as Near Infrared or Microwave. We can then freely associate these bands to colour channels and create false colour compositions that highlight different surface features. The example below shows the UoS campus as seen from the Sentinel-2 satellite. Here we place Band 13 - Short Wave Infared (SWIR) in the blue channel, Band 8 - Near-Infrared band (NIR) in the green channel, and Band 11 - SWIR in the red channel. Since water does not reflect IR, the loch appears black. Plants reflect strongly in the NIR region so they appear bright green, and bare ground / concrete reflects mostly in the SWIR, thus appearing purplish (red+blue).\n\n\n\n\nNotice how the Min and Max values for each band are 0 and 255, meaning we are mapping our screen colours to the entire range of possible values (0-255). But quite often the colours in an image do not cover the entire 8-bit range, so we are ‘wasting’ colour discrimination.\nChange the No Enhancement option to Stretch to Min/Max, and then expand the Min/Max Value Settings heading. Pick the Min/Max option, and select Whole Raster for Statistics Extent and Actual(slower) for Accuracy, then click on Apply. You will see that while band 1 and band 3 do use the entire 0-255 range, band 2 uses the 2-255 range only.\n\nTo further enhance the contrast of images, we can tell QGIS to ‘cut off’ the extreme values of the range, using different methods.\n\nChange the Min/Max Value Settings option to Cumulative Count Cut, and thenApply. Now the Min and Max colour values for each band are (13-189, 29-187,and 31-164 respectively), and the image should look more vivid. What QGIS did was remove the values in the lowest 2% (0.2 percentile) and highest 2% (0.98 percentile) of the existing range before calculating Min/Max values, thus stretching this smaller number range to the full colour range of the screen.\nProgressively increase the lower percentile (i.e. from 2% to 3%) and decrease the upper percentile (i.e. from 98% to 97%) and notice how the contrast gets progressively stronger. If you go too far (i.e. too narrow a range) you will start to see pixel saturation - many of the pixels will be outside the range and thus mapped to fully black or fully white.\n\nA second way to calculate the stretch is to use standard deviations. You may remember from statistics that when you assume a Normal distribution, a distance of \\(\\pm 1 \\sigma\\) from the mean will capture about 68% of the data, \\(\\pm 2 \\sigma\\) will capture 98%, \\(\\pm 3 \\sigma\\) will capture X % and so on:\n\n\nChange the Min/Max Value Settings option to Mean +/- Standard Deviation x, and leave the multiplier at 2. Aplly and check the contrast. Then change the multiplier to 1 and Apply, and compare the contrast of using \\(\\pm 1 \\sigma\\) vs. \\(\\pm 2 \\sigma\\).\nSet the final image contrast to your linking, and exit the Properties window. Save your project.\n\n\n6.9.1 Independent Exercise - Raster resampling\nAs you have learned, raster data consists of a grid of pixel values (i.e. a matrix). So quite often, when working with rasters, you may need to shift the pixels from one grid to another. One main example is raster reprojection - if you reproject your raster to a different CRS, the new raster grid will be aligned with this new CRS, and won’t match the original perfectly, as in the figure below.\n\nThat is why the raster reprojection tool is called Warp(Reproject) - it is as if you are warping the image during the transformation. Other times you may need to make two different raster datasets match the same extent and pixel size, which would also require warping one of the rasters to match the other.\nA key step when doing these transformations is choosing a resampling method, i.e. in which way will the original pixel values be transferred to the new grid. The most common and fast method is called Nearest Neighbour (NN) - if you imagine the old and new grids partially overlapping, NN resampling just looks for the closest old pixel to the new pixel, and transfers the value:\n NN is fast because it requires no additional computations, and also has the benefit of not changing the original data values. But if your data has a lot of fine and/or linear elements, it may result in a ‘jagged’ appearance. For that reason, other methods exist that try to interpolate the new pixel values based on a combination of the original ones. Two common methods are the bilinear and bicubic interpolations, which will average the 4 and 16 closest pixels, respectively. That has the benefit of creating smoother resulting rasters:\n\n\n\nSource:10.13140/RG.2.2.16038.27207\n\n\nLet us now practice our raster skills in an independent exercise, while also demonstrating the effect of resampling:\n\nOn your UK SRTM layer, find the location of Stirling and the university campus, and then use the Raster &gt; Extraction &gt; Clip Raster by Extent function to clip it to an area similar to the image below. For reference, I am using a Singleband Pseudolcolor symbology with the inverted Spectral colour palette, stretched to the values between 0 and 200m. If you find it hard to find Stirling, use the OpenStreetMap online layer as a reference. Don’t worry about matching my area perfectly, the clip is just to speed up our computations.\n\n\n\nNow use Warp(Reproject) to reproject this dataset back to EPSG:4326, but twice. Do it the first time using Nearest Neighbour as the Resampling method to use, and then a seocnd time using the Cubic(4x4 kernel) resampling method. Remember to pick the correct layer to reproject (it should be your Stirling-clipped SRTM layer). Hint: If you save it as a temporaty file, it may not recognise the CRS after the warp - you will see a question mark to the right of the layer name. If that happens, just click on the question mark and pick ESPG:4326 as the CRS.\nApply a symbology to the original Stirling SRTM that makes it easier for you to see all terrain features. Then use Copy Style and Paste Style to make sure both of the new warped versions have the same symbology.\nFlick back and forth between the original, NN resampled and cubic resampled rasters - can you see how NN results in more ‘jagged’ edges where you have sharp terrain transitions?\nCalculate the global raster statistics for the three layers and assess how much impact NN vs. cubic resampling has had on the new layers, compared to the original.\n\nOne instance where we should always use NN resampling is when we have categorical rasters such as the CORINE dataset. In these cases, any sort of resampling that averages multiple pixel values will create ‘fake’ new numbers that don’t represent any class. Let us test it:\n\nUsing Raster &gt; Extract &gt; Clip Raster by Extent, clip a portion of the CORINE dataset that matches the extent of the clipped Stirling SRTM layer. Hint: ask QGIS to use the extents of the SRTM clip for the CORINE clip.\nAgain, reproject this clipped CORINE dataset using both Nearest Neighbor and Cubic(4x4 kernel), as you did for the terrain.\n\n8.Now use the Raster Layer Unique Values Report tool from the Processing panel to count the unique pixel values in the original CORINE clip and the two reprojections. What happened when you used the bicubic resampling?",
    "crumbs": [
      "Week 3 - Raster data",
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>Lab 6: The raster calculator and other rastery bits</span>"
    ]
  },
  {
    "objectID": "sec_w4_cartography.html",
    "href": "sec_w4_cartography.html",
    "title": "Week 4 - Making maps",
    "section": "",
    "text": "ILOs covered",
    "crumbs": [
      "Week 4 - Making maps"
    ]
  },
  {
    "objectID": "sec_w4_cartography.html#ilos-covered",
    "href": "sec_w4_cartography.html#ilos-covered",
    "title": "Week 4 - Making maps",
    "section": "",
    "text": "Obtain and assess the quality of spatial data from online and offline sources and produce new spatial data using computer and field methods;\nCreate map visualisations that adhere to cartographic principles and can be easily and unambiguously interpreted by the non-specialist public;",
    "crumbs": [
      "Week 4 - Making maps"
    ]
  },
  {
    "objectID": "sec_w4_cartography.html#what-will-you-learn",
    "href": "sec_w4_cartography.html#what-will-you-learn",
    "title": "Week 4 - Making maps",
    "section": "What will you learn",
    "text": "What will you learn\nFor every week, we will list the main theoretical and practical learning goals. Use these as a ‘checklist’ to gauge your learning for each week. If you don’t feel confident you have learned any specific topic, then revisit the week’s material!\n\nTheoretical knowledge for Week 4:\n\nWhat is a map?\n\nHow is a map different from a simple figure/image?\n\nWhat are main types of maps?\nWhat makes a good map?\nWhat are visual variables?\n\nWhat is the difference between differentiation, ordered and proportionality - variables?\nWhat is perceptual equivalence in colour scales?\nHow can colour choice aid semantic interpretation?\nHow to avoid issues with colour vision deficiencies?\n\nWhat are the main cartographic elements that make a map a map?\n\nWhat does a proper map legend consist of?\nWhat is map scale?\nWhat is a graticule?\n\nWhen and why to use labels on a map\n\n\n\nPractical knowledge:\n7  Lab 7: Making Maps - Part I\n\nStyling rasters\n\nUsing built in colour palettes\n\nCreating a hillshade effect\nStyling line and polygon vectors\n\nUsing symbology presets\nSetting custom categorized symbols\nCreating borderless polygons\nCopying colours between layers\n\nDeciding on framing, scaling and ordering of layers\n\n8  Lab 8: Making Maps - Part II\n\nAdding and labelling points of interest\n\nAutomatic labelling\nManual labelling\n\nAdding cartographic elements\n\nLegend\nGraticule\nScale Bar\nNorth Arrow\n\nAdding author and CRS information\nExporting your map",
    "crumbs": [
      "Week 4 - Making maps"
    ]
  },
  {
    "objectID": "lab_carto_1.html",
    "href": "lab_carto_1.html",
    "title": "7  Lab 7: Making Maps - Part I",
    "section": "",
    "text": "7.1 Context\nOne of my favourite TV shows of all time is the series ’The Last Kingdom. I was already a fan of the books, and I think they translated it to TV very well.\nOne of the key plots in the show is that the main character, Uthred, wants to reclaim his birthright - the castle of Bebbanburg. Turns out this is a real castle, and it still exists today as Bamburgh Castle, in Northumberland. It is a great place to visit, very scenic and right by the ocean!\nSo for this mapping exercise, we will create a map that could be used to guide someone wanting to visit the location, including road and train access, some context information, and a close-up aerial view of the castle. It will be fun!\nThis week’s exercises are essential for you to successfully complete your first summative assessment, so don’t skip it!",
    "crumbs": [
      "Week 4 - Making maps",
      "<span class='chapter-number'>7</span>  <span class='chapter-title'>Lab 7: Making Maps - Part I</span>"
    ]
  },
  {
    "objectID": "lab_carto_1.html#guided-exercise-1---getting-the-data",
    "href": "lab_carto_1.html#guided-exercise-1---getting-the-data",
    "title": "7  Lab 7: Making Maps - Part I",
    "section": "7.2 Guided Exercise 1 - Getting the data",
    "text": "7.2 Guided Exercise 1 - Getting the data\nWe will use several datasets from the Ordnance Survey for this exercise, most of it from Digimap. To standardise the focus area, we will be downloading data covering the NU OS tile:\n\n\nFirst, grab these datasets from the Ordnance Survey collection on Digimap, selecting the NU tile, and using SHP as the format if asked:\n\n\nOS Terrain 50 DTM\nVector Map District\n\nMake sure you submit the order before you continue. Digimap will not carry over your selection when you switch collections.\n\nNow go to the Aerial collection on Digimap, and grab a high-res aerial photo of the castle. To find Bamburgh, just type the name on the search box at the top of the Digimap window, and then pick Bamburgh (Northumberland). From there, zoom in and then draw a selection around the castle:\n\n\n\nWith your selection made, you should only get one tile for the Aerial Imagery (Latest) option. Order that tile.\n\nFinally, we will get a nice pre-made map of the UK to use as a base map for a broader location map inset. The map is also from Ordnance Survey, but is not on Digimap, so we will grab it from the OS Open Data Hub:\n\nGo to the OS Open Dat Hub and find the GB Overview Maps collection. Click on it and download the only available file.\n\nOkay, we should have enough data to make an informative map, so let us start laying it out.",
    "crumbs": [
      "Week 4 - Making maps",
      "<span class='chapter-number'>7</span>  <span class='chapter-title'>Lab 7: Making Maps - Part I</span>"
    ]
  },
  {
    "objectID": "lab_carto_1.html#guided-exercise-2---starting-the-project-and-organising-data",
    "href": "lab_carto_1.html#guided-exercise-2---starting-the-project-and-organising-data",
    "title": "7  Lab 7: Making Maps - Part I",
    "section": "7.3 Guided exercise 2 - Starting the project and organising data",
    "text": "7.3 Guided exercise 2 - Starting the project and organising data\nBefore we start mapping, we need to organise our downloads and set up a project to start bringing in the data. We will use the same data for this lab and the next.\n\nCreate a home folder for this project named labs_7_8), and then extract the zipped files and organise the data as you are used to.\n\n\n\n\n\n\n\nStop and Think\n\n\n\nWhat data models and file formats are your datasets on?\n\n\n\n\n\n\n\n\nClick for answer\n\n\n\n\n\nThe aerial photo, DTM and GB Overview are raster files. The DTM is in the ESRI ASCII raster file format, and the Aerial Image is in JPEG format. JPEGS don’t natively store coordinates, so a .jgw sidecar file is used to store the spatial information. The GB Overview files are GeoTIFF files.\nThe vector district files are all vector files, some being polygons, some being lines and some being points. They will be in Shapefile format.\n\n\n\n\nCreate a new empty project in QGIS, name it labs_7_8 and set its CRS to OSGB (EPSG:27700). Save it.\nAs starter, bring in the DTM tiles into the project. If you downloaded the NU region correctly, you should have 15 separate DTM tiles (files ending in .asc). They should look like this:\n\n\n\nWe will want to style this data, but copying and pasting the style 15 times is too cumbersome. So use your skills from last week and make a mosaic of all the DTM tiles. Save it as a new file on the proper location in your folder organization, and them remove all the individual tiles from the project to keep it ‘clean’.\nNow look at the data you downloaded from the OS Vector District dataset. It should contain several shapefiles named NU_xxxxxx.shp, where xxxxx will be a descriptive name for what the layer holds. You will want to bring in the layers below into your project. Don’t worry yet about how each layer looks or their ordering, just make sure you got it all.\n\n\nNU_Building\nNU_Foreshore\nNU_NamedPlace\nNU_RailwayStation\nNU_RailwayTrack\nNU_Road\nNU_SurfaceWater_Area\nNU_SurfaceWater_Line\nNU_Woodland\n\n\nSave your project, and then use the Zoom Full tool () to see the full extent of your data. You will notice that some of the datasets go beyond the limits of the actual NU tile:\n\n\n\n\n\n\n\n\nStop and Think\n\n\n\nThinking of the GIS tools you already learned, could you think of an explanation why some of the layers go beyond the NU limits despite your selection on Digimap?\n\n\n\n\n\n\n\n\nClick for answer\n\n\n\n\n\nOn week 2 you learned about Clip and Select by Location. It seems that internally, when you draw a selection, Digimap is making a Select by Location operation, selecting all polygons that overlap with the NU square. For large polygons that cross OS grid tiles, you end bringing the whole polygon. So now let us do a proper Clip.\n\n\n\n\nUsing your skills from previous labs, create a layer extent polygon (Vector &gt; Research Tools &gt; Extract Layer Extent) based on the DTM mosaic, and then use this polygon to Clip all layers. As you clip and save the clipped versions, remove the original ones to avoid confusion and keep the project tidy. Once they are all clipped and neat, save your project. From now on, when I refer to any of these layers in the instructions, I will be meaning the clipped versions. You may even want to delete the originals from your folder to prevent confusion.\n\n\n\n\n\n\n\nTip\n\n\n\nIf you are feeling adventurous, take a look at the QGIS documentation about Batch Processing in QGIS to clip all layers in a single sweep:\nhttps://docs.qgis.org/3.34/en/docs/user_manual/processing/batch.html\n\n\nWe now have all the data we need to start laying out our map. Save your project and continue.",
    "crumbs": [
      "Week 4 - Making maps",
      "<span class='chapter-number'>7</span>  <span class='chapter-title'>Lab 7: Making Maps - Part I</span>"
    ]
  },
  {
    "objectID": "lab_carto_1.html#guided-exercise-3---styling-the-dtm",
    "href": "lab_carto_1.html#guided-exercise-3---styling-the-dtm",
    "title": "7  Lab 7: Making Maps - Part I",
    "section": "7.4 Guided Exercise 3 - Styling the DTM",
    "text": "7.4 Guided Exercise 3 - Styling the DTM\n\nLet us start with the DTM, as it will be the background for our main map. Turn off all the layers except for the DTM, and open the DTM Properties &gt; Symbology, then select Singleband Pseudocolor for Render Type.\n\nWe could pick one of the colour ramps from the drop down menu, but we can do better. QGIS actually has several built-in colour palettes that are professionally designed to be perceptually equivalent, colour blind friendly, and so on. The two main collections of palettes are the ColorBrewer palettes and the cpt-city archive. We will use one of the topography optimised cpt-city palettes.\n\n\n\n\n\n\nTip\n\n\n\nCartography is an equal mix of art and technique, and always has a strong amount of subjectivity and self-expression. Throughout this exercise, feel free to explore different symbology options instead of picking the exact ones shown, to develop your own cartographic style.\n\n\n\nClick the small down-arrow to the right of the Color Ramp button, and select the option Create New Color Ramp. On the small window that will appear, select Catalog: cpt-city and click OK. A new window will appear with all the (many) cpt-city palettes.\nPick the Topography category on the left, and then click on the cd-a palette (or another of your choice), and then OK. You will then be back at the Symbology window.\nNow let us customise our colour palette. First, for Min and Max, pick 0 and 300 respectively. Continuous palettes are easier to interpret if they use nice, round values. Then change the Mode to Equal Interval with 7 classes. That will give us nice round steps of 50m. Then Apply and OK. Your DTM should now look like this:\n\n\n\nWe can add a bit more pop to the DTM by reproducing the 3D effect using transparency and hillshade symbology that we learned on Chapter 5. If you can’t quite remember how to do it, refer back to Guided Exercise 4 for that lab. For my map, I set the transparency of the coloured DTM layer to 60%, and then went back to the Symbology of the hillshade layer and tweaked a bit the brightness (20) and contrast (-10) options under the Layer Rendering section. We want the effect to be subtle, and the whole DTM to have a ‘light’ appearance since it will be a background:\n\n\n\nMake any additional adjustments to the DTM style to your taste, and then save your project.",
    "crumbs": [
      "Week 4 - Making maps",
      "<span class='chapter-number'>7</span>  <span class='chapter-title'>Lab 7: Making Maps - Part I</span>"
    ]
  },
  {
    "objectID": "lab_carto_1.html#guided-exercise-4-adding-and-styling-the-transportation-layers",
    "href": "lab_carto_1.html#guided-exercise-4-adding-and-styling-the-transportation-layers",
    "title": "7  Lab 7: Making Maps - Part I",
    "section": "7.5 Guided Exercise 4: Adding and styling the transportation layers",
    "text": "7.5 Guided Exercise 4: Adding and styling the transportation layers\nNow that we have a nice looking base layer, let us start adding our vector elements. At this time, it is a good idea to stop and think again about what is the main purpose of our map - what should the main subject be, what additional information is more important, and so on. In the end, we want to have a visual hierarchy that naturally guides the viewer attention to the most important aspects of the map.\n\nTurn on the ‘railway tracks’ and ‘roads’ layers. Since one of our main objectives is to get people to reach Bamburgh Castle, these should be very evident in our map.\nLet us start with the railway track, as it is simpler. Open its Properties &gt; Symbology and then change the symbol presets list from Favorites to All Symbols (see figure below). Then scroll through the presets list until you find Topo Railway. Click on it to select it, and then Apply.\n\n\n\n\n\n\n\n\nTip\n\n\n\nNote how QGIS allows you to create very complex symbols. If you look at the top of the Symbology window, you will notice this railway track symbol is actually composed of several ‘sub-symbols’:\n\nThe general symbol category is Line, and then the different elements of the symbology are added to it using the green + symbol at the left. The Maker Line sub-symbol defines the type of additional symbol to overlay on the line, and how (try to change the distance between rail crosslines!). Then the Simple Marker sub-symbol defines what the symbol for the actual Marker is, which will be repeated along the line (try to make it a bit thicker!). Finally, the Simple Line sub-symbol is the one we are used to, that sets the appearance of the main track line.\nYou can create very complex symbols using these advanced features - but don’t feel like you need to for the purposes of this module! You can go far by just picking one of the presets and then tweaking it to your taste.\n\n\n\nPlay with the width of the track line and the colour to make it well separated from the background terrain, but not too strong/dominating.\n\n\n\n\n\n\n\nStop and Think\n\n\n\nDid you notice the crosslines along the track seem to have inconsistent spacing? Can you think of a reason why? How could you fix it?\n\n\n\n\n\n\n\n\nClick for answer\n\n\n\n\n\nIn the railway layer the different railway line segments are separate features (try selecting them). So for each segment the symbology is ‘restarted’. To fix it, use the Dissolve tool to turn all line segments into a single multiline feature.\nIt will solve most problems but not all. If you zoom in very close to where the crosslines seem to be too close or too far, you will notice there are actually gaps in between the lines, and Dissolve will only dissolve connecting lines. The only way to fix that would be to manually edit and connect the lines - too much work for the purposes of our map.\n\n\n\n\nNow we can focus on the roads. Open the Attribute Table of the roads layer, and notice there is an attribute named CLASSIFICA indicating the type of road (local street, minor road, etc.). Use the Select by Expression tool to investigate what are the unique possible values of this attribute. It would be nice if we could style the roads based on their type!\nClose the attribute table and open the Properties &gt; Symbology for the roads layer. Change it from Single Symbol to Categorized, then pick CLASSIFICA as the Value, and Classify to assign random colours to each road type.\n\nWe want however, to have some consistency and visual hierarchy for the roads, instead of simply random colours. But you can edit the symbols for each road class by double clicking on each individual symbol in the list of classified values.\n\nTake a look at the UK roads classification and then style them with proper visual hierarchy. Colour A and B roads red, but use different widths for each, and then style the remaining roads dark grey, but again with hierarchy indicated by line width. Feel free to use the same symbol for classes you think are too similar (I used the same symbol for the two types of primary road, and I removed the symbols for pedestrianized and private roads). This is what my map looks like by now:\n\n\nNow that we have our main roads, let us add some more context to the map. But first save your project!",
    "crumbs": [
      "Week 4 - Making maps",
      "<span class='chapter-number'>7</span>  <span class='chapter-title'>Lab 7: Making Maps - Part I</span>"
    ]
  },
  {
    "objectID": "lab_carto_1.html#guided-exercise-5---adding-contextual-elements",
    "href": "lab_carto_1.html#guided-exercise-5---adding-contextual-elements",
    "title": "7  Lab 7: Making Maps - Part I",
    "section": "7.6 Guided Exercise 5 - Adding contextual elements",
    "text": "7.6 Guided Exercise 5 - Adding contextual elements\nEven with the roads and railways clearly visible in the map, it would still be difficult to navigate using this map, as there isn’t much context available. Let us add some contextual elements to support the main themes -meaning they should not stand out more than necessary.\n\nReactivate the woodland, surface water (area and line) and buildings layers. Notice how cluttered the map looks now. This is why good visual hierarchy is so important.\n\nWe can start by styling the water surfaces. We want colours that help interpretation, so we should make them a light coloured blue. And since many of these features are small and/or narrow features, we can make them look less evident and cluttered by setting the stroke symbol to be the same colour as the fill symbol (i.e. so that they look borderless).\n\nOpen the Properties &gt; Symbology of the surface water lines, and set the Simple Line Color to a light blue of your choosing. Leave it as a thin line. Before you leave the Symbology window for that layer, open the colour picking window again and copy the HTML notation for the colour you selected:\n\n\n\nNow close the window and open the Symbology for the surface water areas. Then within Simple Fill open the colour picking window for the Fill color option and paste the HTML notation you copied before. Then repeat it for the Stroke Color so they will all have the same colour.\nNow style the woodlands using a muted green colour, and the buildings using a brownish grey. Make them both borderless, as you did with the surface water areas. Save your project.",
    "crumbs": [
      "Week 4 - Making maps",
      "<span class='chapter-number'>7</span>  <span class='chapter-title'>Lab 7: Making Maps - Part I</span>"
    ]
  },
  {
    "objectID": "lab_carto_1.html#guided-exercise-6-deciding-on-the-framing-and-scale-and-adding-some-finishing-touches",
    "href": "lab_carto_1.html#guided-exercise-6-deciding-on-the-framing-and-scale-and-adding-some-finishing-touches",
    "title": "7  Lab 7: Making Maps - Part I",
    "section": "7.7 Guided Exercise 6: Deciding on the framing and scale, and adding some finishing touches",
    "text": "7.7 Guided Exercise 6: Deciding on the framing and scale, and adding some finishing touches\nWe are getting close to a complete map, and it seems now it is a good time to decide on our framing and scale. We want to find a good balance between showing enough of the surroundings without overwhelming the map user. We also need to take into consideration what will be the final format of our map. Let us assume we will deliver it in A4 size, landscape orientation.\n\nGo to Project &gt; New Print Layout, and create a new layout called bamburgh_map. Then in the new Layout Editor windiow use the Add Map () tool to add your map to the page. Leave some room at the right side for the legend and annotations:\n\n\n\nNow switch to the Move item content () tool, and zoom in and drag the map around, testing how to best use the space.\n\nOnce you find a framing and scale that you are happy with, it is a good idea to slightly change the scale so it is a nice, round number. In my case, I ended up with a map scale of 1:82011, and so I will round it to 80000. Once I have settled on this scale, I want to then fix it, to prevent accidental zooming later:\n\nClick on the menu-looking button to the right of the scale number box, and then on Edit (see figure below). The familiar expression window will appear. Then just type 80000 (or whatever scale you decided to use) and click OK. The menu-looking button now changed to a yellow \\(\\epsilon\\), to indicate the value is set by an expression.\n\n\nThis is my final framing and scale:\n\nBefore we finish for today, let us tweak the appearance of the shoreline a bit. As it is now, it looks very undefined and may be confusing to your map users.\n\nBack on the main QGIS window, activate the NU_TidalBoundary and NU_Foreshore layers. Copy and paste the style of the Surface Water Line layer to the Tidal Boundary, and then open its Properties &gt; Symbology, and make it a bit darker so it stands out from the background. Before you close the window, copy the HTML notation of the colour you picked.\nNow enable the Foreshore layer, and open its Properties &gt; Symbology. Within the Simpe Fill sub-symbol, change both the Fill color and Stroke color to the colour you copied from the step above, and change the Fill style from Solid to Dense 6. Click OK. You should obtain an effect similar to the image below.\n\n\n\n\n\n\n\n\nStop and Think\n\n\n\nCan you fix the ugly vertical and horizontal lines that are appearing on the foreshore area shown above?\n\n\n\n\n\n\n\n\nClick for answer\n\n\n\n\n\nThis is a similar problem to the railways before. Whomever digitised the foreshore areas appears to have done it in steps, following a reference grid, and thus you get adjacent but separate polygons with straight borders for larger foreshore areas. Dissolving the layer should fix it.\n\n\n\nBefore we finish our session for today, one last thing to consider is the ordering of the layers you have. To facilitate map reading, they should overlap in a logical order - for example, roads should cross over rivers, and railways should cross over both. Rearrange your layers so they are in the order below:\n\n\nWe will continue working on our map on the next lab, so make sure you 1) Save your project and 2) Copy the entire Lab 7 folder to your OneDrive or an external drive (if you are working locally). You may want to zip the entire folder to make it smaller and more portable/manageable.\n\nGood job so far! We will pick up exactly where we left in the next session. If you finished this lab early and you are having a good time, feel free to get started with Lab 8!",
    "crumbs": [
      "Week 4 - Making maps",
      "<span class='chapter-number'>7</span>  <span class='chapter-title'>Lab 7: Making Maps - Part I</span>"
    ]
  },
  {
    "objectID": "lab_carto_2.html",
    "href": "lab_carto_2.html",
    "title": "8  Lab 8: Making Maps - Part II",
    "section": "",
    "text": "8.1 Getting Ready\nMake sure you restore the project folder and files you created in the previous lab, and then open your project.",
    "crumbs": [
      "Week 4 - Making maps",
      "<span class='chapter-number'>8</span>  <span class='chapter-title'>Lab 8: Making Maps - Part II</span>"
    ]
  },
  {
    "objectID": "lab_carto_2.html#guided-exercise-1---digitizing-the-castle",
    "href": "lab_carto_2.html#guided-exercise-1---digitizing-the-castle",
    "title": "8  Lab 8: Making Maps - Part II",
    "section": "8.2 Guided Exercise 1 - Digitizing the castle",
    "text": "8.2 Guided Exercise 1 - Digitizing the castle\nOne thing that seems to be missing from our map is more emphasis on the castle’s location. Let us use the aerial photo we acquired to digitize the castle area.\n\nAdd to your project the aerial orthophoto you downloaded at the start of the previous lab. If you had a wide selection and downloaded multiple tiles, the correct file is nu1835_rgb_250_03.jpg. It may be that the photo comes without a CRS defined (a question mark icon will appear to the right of the layer name). If that happens, just right click on the layer name, and select Layer CRS &gt; Set Layer CRS to pick EPSG:27700.\n\n\n\n\n\n\n\nStop and Think\n\n\n\nWhy did we use Set Layer CRS and not Reproject?\n\n\n\n\n\n\n\n\nClick for answer\n\n\n\n\n\nIn this case, we know the aerial photo uses the EPSG:27700 CRS (by looking at the metadata, and also by knowing that any UK official cartographic product uses it). It is just a matter if informing QGIS what the CRS is, as it was not properly detected when the layer was added to the project. We use Reproject when the layer already has a defined CRS, and we want to change it to a different CRS (meaning likely a different datum, projection and maybe even a different coordinate type - such as from degrees to meters), and thus we need to transform (i.e. calculate) a new set of coordinates.\n\n\n\n\nNo we need a new empty layer to digitise on. Click on the New shapefile layer button ( ) on the main QGIS toolbar. You will get the New Shapefile Layer window:\n\n\n\nFirst pick a folder to save your file and name it bamburgh_castle, on the File Name box. Then for Geometry type, pick Polygon, and pick EPSG:27700 for the CRS. Notice how QGIS automatically creates an integer attribute named id. We want a text attribute to hold the castle name, though, so enter name as the name of the field on the New Field options, then pick the Text (string) data type and a length of 80 (the default) and click on Add to Fields List. You should see the new name field added to the fields list. Then click OK.\nFind your new layer on the Layer Panel. It doesn’t have any geometries yet, so you won’t see anything on your map. Highlight your new layer, and then put it into editing mode by clicking on the Toggle Editing button () on the main QGIS toolbar. Make sure you are editing the right layer (it should have a pencil symbol on top of the symbology colour on the layer list).\nNow right-click on the aerial photo layer and select Zoom to Layer(s) to centre the map canvas on it. Then manually set a scale of 1:1500 on the bottom QGIS bar. It is important to be aware of the scale you are digitizing at, and keep it constant so that the level of detail is also constant. Drag the castle to the middle of the canvas using the Pan Map tool (the hand).\nNow highlight the new shapefile layer (which is being edited) again. The Digitizing tools toolbar () should be available. Click on the Add Polygn Feature button () to enter a polygon drawing mode. Start clicking anywhere in the castle outer walls, and then keep clicking to trace the entire castle shape. Once you finish you polygon, right-click to end the drawing. A window will pop-up asking you to enter an id and name. Enter 1 and Bamburgh Castle respectively.\nIf you want to edit the polygon shape after the fact, use the Vertex Tool (). Then click once on a vertex to select it, and then cick again to reposition it, or the Delete key on your keyboard to delete it. You can also add a new vertex by hovering the mouse in between vertices until you see a red x. You should end up with something like this:\n\n\n\nOnce you’re happy with your polygon, remember to click the Save Layer Edits button (on the editing toolbar - not the Save project button) and then exit editing mode. Set you map back to the 1:80000 scale you decided on in the previous lab, and pick a strong and visible colour for the castle polygon. Turn off the aerial image again, and save your project.",
    "crumbs": [
      "Week 4 - Making maps",
      "<span class='chapter-number'>8</span>  <span class='chapter-title'>Lab 8: Making Maps - Part II</span>"
    ]
  },
  {
    "objectID": "lab_carto_2.html#guided-exercise-2---adding-places-and-labels",
    "href": "lab_carto_2.html#guided-exercise-2---adding-places-and-labels",
    "title": "8  Lab 8: Making Maps - Part II",
    "section": "8.3 Guided Exercise 2 - Adding places and labels",
    "text": "8.3 Guided Exercise 2 - Adding places and labels\nNo good map is complete without the addition of informative labels, which help add context and reference. QGIS has very powerful labelling features (which we will only lightly explore), but you should always spend some good effort on labelling - it often turns a good map into a great map.\n\n\n\n\n\n\nStop and Think\n\n\n\nWhen should I use labels and when should I use the map legend to name things?\n\n\n\n\n\n\n\n\nClick for answer\n\n\n\n\n\nAs a rule of thumb, legend names indicates categories or groups of things, as well as continuous variables. Labels identify unique things. For example, if there were multiple castles in the map, you could have a legend symbol indicating “castle” (a category of thing), and then labels showing the names of each castle. If you wanted to indicate a specific mountain peak in your elevation map, you would still have an “Elevation” item on the legend explaining the elevation symbology (a continuous variable), and then a point symbol and a label to identify the particular peak. If there were multiple peaks, then you would add a “Mountain Peak” item to the legend, associated with the point symbol you selected to indicate peaks. But this is not essential when there is only a single item in the category (like our single castle).\n\n\n\n\nRight click on the castle layer you created and go to Properties &gt; Labels. Change the No Labels box to Single Labels, to reveal several options. For Value, pick the name attribute, which contains our layer name. On the Text sub-tab, increase the font size to 14, and on the Buffer sub-tab, click on Draw Text Buffer. Click on Apply, and you should get a label like in the figure below:\n\n\n\nThe label is however hiding the actual castle polygon. So return to Properties &gt; Labels and go to the Placement sub-tab, change the Mode to Outside Polygons, and set Distance to 1 millimetre. The label should move to the right of the polygon now.\n\nNext, let us add some named places to the map, to help with navigation. For that we will use another layer from the Vector Map District OS database we downloaded, the NU_Named_Place layer.\n\nAdd the NU_NamedPlace.shp layer to your project. You will see a large number of points appear, probably too many to look good. But this dataset has information on the type of place (CLASSIFICA) and an indication of place importance (FONTHEIGHT), that we could use to reduce the number of points.\n\n\n\n\n\n\n\nStop and Think\n\n\n\n\nHow would you reduce the number of points show based on the above attributes?\nWhy do the attributes have truncated names such as CLASSIFICA?\n\n\n\n\n\n\n\n\n\nClick for answer\n\n\n\n\n\n\nYou could go to the attribute table and use Select by expression to select the specific combination of attributes you wanted. But we will learn a different way below.\nBecause shapefile is a very old format, back when memory and storage were very limited. So they have an imposed limitation of ten characters as the maximum length of a field name - if you create a new field on a .shp file and name it something longer than 10 characters, the name will be cut-off at the tenth character. Geopackages don’t have that restriction.\n\n\n\n\nIf we want to limit the number of features that are available to us in a layer, we can use the Filter method instead ofSelect by Expression. While selecting is useful to create a selection that you can then export or summarise, filtering will essentially hide the information from view and manipulation - as if it didn’t exist. Let us filter our named places to only medium and large populated places.\n\nRight click on the NU_namedPlace layer and select Filter.... You will see a new window similar to the Select by Expression window. On this window, you can pick attributes on the top left, and then list all unique values of each attribute in the top right (select the attribute then click onAll). You can then double click on attribute names, values and operators, or simply type your expression in the bottom window. For this dataset, we want to filter using the following expression: \"CLASSIFICA\" = 'Populated Place' AND (\"FONTHEIGHT\" = 'Medium' OR \"FONTHEIGHT\" = 'Large'). Notice the parentheses! Then click on OK.\n\n\n\n\n\n\n\n\nStop and Think\n\n\n\nWhy do we use a set of parentheses to encapsulate the OR statement in the expression above?\n\n\n\n\n\n\n\n\nClick for answer\n\n\n\n\n\nBoolean operators are processed as mathematical operations, from left to right. So if we typed \"CLASSIFICA\" = 'Populated Place' AND \"FONTHEIGHT\" = 'Medium' OR \"FONTHEIGHT\" = 'Large' without parentheses, QGIS would first look for the features that are a populated place and medium, and then try to find large places within this first selection. But we want for it to first find all medium or large places and then from these pick only the ones that are also (the AND) populated places. As with maths, the parentheses ensure we solve the OR first.\n\n\n\nYou should now have a lot less Named Places scattered through the map, and if you inspect the attribute table, you will see only the filtered results. It is as if the rest of the data doesn’t exist! You will always know if a layer is being filtered by the ‘funnel’ symbol to the right of the layer name (and you can click on the symbol to edit or clear the filter).\n\nNow follow the same procedure you used to label Bamburgh Castle to label the populated places, using the DISTNAME attribute - but use a font size of 10 to keep the visual hierarchy in relation to the castle, and keep the Placement option as the default Cartographic option.\nChange the Symbology of the NU_NamedPlaces layer to the preset symbol topo pop capital (a white circle with a black dot in the middle), with a Size of 2.4.\nAdd the NU_RailwayStation.shp file to your map, and label it using the DISTNAME attribute as well (you should see only one station, ‘Chathill’). Make the label size 10, colour it blue and make its style bold italic, and do not use a buffer this time.\nNow go to the Symbology tab for the railway station layer, and pick Single Symbol. Select the Simple Marker sub-item, and then change the Symbol layer type from Simple Marker to SVG Marker. SVG stands for ‘Scalable Vector Graphics’ and is a commonly used format to store figures in desktop publishing.\nOnce you change the Symbol layer type, a new SVG Browser section will appear below. In there, find the transport folder on the browser to the left, and pick the railway symbol (looks like a train). Then above it, change the Fill Color to the same blue you used for the label, and decrease the Stroke Width until it says No stroke. Increase the size of the symbol to 6 (width and height should be linked by default). Your options should look like this (stroke colour doesn’t matter):\n\n\nGood job with labelling! Your map should now be looking like this:\n\n\nSave your project.",
    "crumbs": [
      "Week 4 - Making maps",
      "<span class='chapter-number'>8</span>  <span class='chapter-title'>Lab 8: Making Maps - Part II</span>"
    ]
  },
  {
    "objectID": "lab_carto_2.html#guided-exercise-3---laying-out-the-final-map",
    "href": "lab_carto_2.html#guided-exercise-3---laying-out-the-final-map",
    "title": "8  Lab 8: Making Maps - Part II",
    "section": "8.4 Guided Exercise 3 - Laying out the final map",
    "text": "8.4 Guided Exercise 3 - Laying out the final map\nWe have now added everything we want to our map, and styled and labelled it properly. Now it is time to work on the final page layout for our map. This is where we add the critical cartographic elements that turn a figure into a map (legend, scale, graticule, north arrow), and include some map insets and annotations to facilitate map interpretation.\n\n8.4.1 The Legend\nThe map legend is the most important cartographic element, as it associates meaning to all the visual variables (colours, symbols, sizes, patterns) you have used on your map. QGIS has a handy tool to generate the legend automatically, but we should always tweak the end results to improve map readability.\n\nGo to the menu Project &gt; Layouts and pick the layout you created in the previous lab, when you were deciding on the scale and coverage of your map. The Layout editor window will launch separately from the main QGIS window.\nEither go to the menu Add Item &gt; Add Legend or click the Add Legend button () on the vertical toolbar to the right. The cursor will turn into a cross. Then click and drag to create a legend on the lower right corner of the page. It will look to big and go outside the page - don’t worry, we will fix it next.\n\n\n\nThe first thing we will do is clean up the legend. By default QGIS will add all active layers to the legend. Select the Legend item on the top left of the Layout window (under Items), and then select the Item Properties tab on the bottom right.\nFirst set the name of the legend as Legend (type it on the box). Then uncheck the Auto Update option, and start removing items by selecting them and clicking on the red ‘minus’ button at the bottom of the layer list. You want to end up with a legend like the one below (use the green ‘plus’ button to add a layer back if you remove it by mistake):\n\n\n\nIn my case, I also used the same symbology for Primary Road and Primary Road Collapsed Dual Carriageway, so no need to have both in the legend. Again, I can expand the NU_Road_clip layer on the legend layer list, select only the Primary Road Collapsed Dual Carriageway item and remove it with the red minus button.\nFor the OS_50_DEM_NU layer, we don’t need the Band 1(Grey) sub-name, so remove it as well. The legend should now be looking like this:\n\n\n\nThis legend is occupying a lot of space in our map. Scroll down past the layer list on the legend Item Properties, until you find the option Fonts and Text Formatting. Expand it by clicking on the arrow, and then reduce the font sizes of the several options by 4 points. To do that, click on the down-arrow to the right of each Font box, and change the font size at the top of the menu.\n\n\n\nThe spacing between items seems to be excessive now, so find the Spacing option for the Legend item and reduce all non-zero spacing by 1mm, except for the Column Space option - set that one to 3. It will have an effect later.\n\nOur legend is looking much better, but there is a big problem: the item names reflect the file names, and your map readers won’t know what NU_NamedPlace means. So we should rename our layers to have intelligible names. You can rename your layers in the Map Layout by going back to the legend Item Properties and double clicking each item. But I think it is a better idea to rename the actual layers in the QGIS project. This way, if you decide to add/remove other layers to the legend, you won’t need to rename then again.\n\nGo back to the main QGIS window, and rename all the layers in the legend to proper, readable names. For example, NU_RailwayStation to Railway Station, NU_NamedPlace to City/Town, etc. Try to use short names:\n\n\n\nNow that we have nice and short names, we can also save space by breaking the legend into columns. Go back to the Layout editor, and on the Legend Item Properties find the Columns option and increase Count to 2. Your legend should now have two columns, spaced 3mm (remember the Column Space option you set a few steps above?)\nThe extra space gives us the chance to expand our elevation bar a bit. Go back to the list of legend layers in the Legend Item Properties, and double click on the Elevation colour bar. Leave the Width as default, and set the height to 20. Also add m as the Suffix so we have clearly labelled units. Your final legend should now look like this:\n\n\n\nSave your layout.\n\n\n\n8.4.2 Adding a scale bar\nEvery proper map needs a scale bar. Luckily, since all data in QGIS is georeferenced, the Map Layout editor can automatically calculate the correct size for indicating scaled distances in our map.\n\nGo to the menu Add Item &gt; Add Scale Bar, or click the Add Scale Bar button (), and drag a box to add a scale to the top left of the map area, over the ‘ocean’.\n\n\n\n\n\n\n\nTip\n\n\n\nWe want to make sure the cartographic elements do not cover information on the map. Because we have a large plain ocean area in this map, which is not of much interest, it is OK to add the scale bar there. But if the map had relevant info throughout, it would be better to place the scale outside the map area.\n\n\n\nRepeat this process and add a second scale bar below the first. Then select one of the scale bars on the Items list, and then on its Item Properties change the units from Kilometers to Miles. We now made our map accessible to both civilized and barbarian people metric and imperial thinkers.\n\n\n\n\n\n\n\nTip\n\n\n\nFeel free to play with the Style, Segments and other Item Properties of your scale bars to tailor them to your taste.\n\n\n\nSave your layout.\n\n\n\n8.4.3 Adding a Graticule\nThe graticule (coordinate grid) is another essential cartographic element - without it our map is not showing proper spatial information. A good graticule facilitates navigation without obscuring the map elements. Let us add a graticule to our map:\n\nOn the Items list, select the Map 1 object. That is your main map frame. Go to its Item Properties and find the Grids option. Expand it and click on the green plus button to create a new graticule, which will show up below it as Grid 1.\nSelect Grid 1 and click on Modify Grid. A new set of options will appear:\n\n\n\nWe will set several options here to have a nice grid. First, we need to decide our Interval in the X and Y directions. This is the spacing between coordinate lines. We are using the OSGB CRS (EPSG:27700) with metric coordinates, so this interval will be in meters. Let us add coordinates every 5km by changing both X and Y spacing to 5000. You should now see a grid of lines in the map.\nThe squares formed by the lines seem a bit ‘offset’ in relation to the map area. We can shift them so they are nicely centred in the vertical and horizontal direction by adding X and Y offsets. On my map, an X offset of 500 and a Y offset of -1500 centres the grid nicely. You may need to use different values depending on your choice of framing.\nI now have coordinate lines, but they have no coordinate numbers, thus so far my grid is useless. Next set the Frame Style option to Exterior Ticks, then keep scrolling down until you reach the Draw Coordinates option. Check the box and coordinate numbers will appear at each line. But they do not align well with the frame, and also have useless decimal places.\nOur coordinates also have no axis indication, so change the Format option from Decimal to Decimal with Suffix. That will add the easting (E) and Northing(N) indicators.\nBelow Draw Coordinates, you see sets of options labelled Left, Right, Top and Bottom. Change the third option for Left from Horizontal to Vertical Ascending, and for Right to Vertical Descending. Then at the bottom of the Draw Coordinates section, set Coordinate Precision to 0 to remove the decimal places.\nIf we expected our map users to navigate using a compass, the actual grid lines would be useful. But since this is unlikely, the actual black grid lines are too obtrusive. Go back to the top of the Map Grid Properties, and change the Grid Type from Solid to Frame and Annotations Only.\nFinally, let us add a black border to our map for aesthetic purposes. Go back to the main Item Properties for Map 1, and find the Framè option. Enable the checkbox to add a frame. Save your layout.\n\nMy map layout is now looking like this:\n\n\n\n8.4.4 Adding a North Arrow\nA North Arrow is only strictly necessary if your longitude grid lines are not parallel, but we will add one so you know how (and make sure you show us you’ve learned how on the assessment!).\n\nGo to the menu Add Item &gt; Add North Arrow or click on the Add North Arrow button (can you spot it?), and drag the mouse where you want your North arrow to be. It is by convention usually placed on the top left corner, so I’ll move the scale bars a little to the left and then place my arrow there.\nIf you select the North Arrow item and go to its Item Properties you will see there are many SVG symbols for north arrows, in the arrows and wind roses folders. Pick any one you like. Save your layout.",
    "crumbs": [
      "Week 4 - Making maps",
      "<span class='chapter-number'>8</span>  <span class='chapter-title'>Lab 8: Making Maps - Part II</span>"
    ]
  },
  {
    "objectID": "lab_carto_2.html#guided-exercise-4---adding-map-annotations",
    "href": "lab_carto_2.html#guided-exercise-4---adding-map-annotations",
    "title": "8  Lab 8: Making Maps - Part II",
    "section": "8.5 Guided Exercise 4 - Adding map annotations",
    "text": "8.5 Guided Exercise 4 - Adding map annotations\nAnnotations help our readers understand the map. The main piece of annotation any standalone map should have is a title (you can omit the title if your map is a figure in a document, where there will be an explanatory caption under it). We also want to add some information such as data sources, map author, the CRS used and the map scale.\n\nAdd an annotation frame under the map legend using Add Item &gt; Add Label or the Add Label button (). On the Item Properties for your new label, you will see a text box saying Lorem Ipsum. These are two words in Latin from a text passage that has historically been used by designers to indicate placeholder text (see lorem ipsum). Replace the Lorem Ipsum by the following text, including the line breaks and line spaces:\n\nEPSG:27700\n1:80000\nAuthor: (your student number)\nData source: Digimap 2024\n\nUnder the text box, select Center for Horizontal Alignment, and set font size to 8. Then move your legend up until you can fit this annotation under it.\nNow add a Map title, using the same Text Label tool, such as Bamburgh Castle -  Northumberland, UK. You may want to resize your main map frame a bit to make room for the title above it. Set it to bold and font size 14.\n\nMy map now looks like this:\n\n\nSave your layout.",
    "crumbs": [
      "Week 4 - Making maps",
      "<span class='chapter-number'>8</span>  <span class='chapter-title'>Lab 8: Making Maps - Part II</span>"
    ]
  },
  {
    "objectID": "lab_carto_2.html#guided-exercise-5---adding-map-insets",
    "href": "lab_carto_2.html#guided-exercise-5---adding-map-insets",
    "title": "8  Lab 8: Making Maps - Part II",
    "section": "8.6 Guided Exercise 5 - Adding map insets",
    "text": "8.6 Guided Exercise 5 - Adding map insets\nA common element of maps that aids map use is the inclusion of map insets, ‘sub maps’ that show either a portion of the main map in higher detail or the location of the main map on a broader scale map. We will add both to our design\n\nInsert a new map area on the top left corner of your layout using the Add Map () button. It will by default be named as Map 2 on the Items list:\n\n\n\nBefore we move forward, let us rename our map items to make our work easier. Double-click on Map 1 in the Items list and rename it to Main Map, then double-click on Map 2 and rename it to Overview Map. Save your layout.\n\nFor now our overview map shows the exact same content as the main map - the maps are by default tied to the QGIS main window. To be able to show separate maps, we need to associate each map with a QGIS theme. We will do this now.\n\nFirst, go back to the main QGIS window, and add the GB_Overview_Plus.tif file to your layers. Turn its visibility off.\nNow make sure all (and only) the layers you want to be visible on the main map are on, and the others are off. Then click on the small ‘eye’ button on the top of the Layers panel, and click on Add Theme. Name your theme Main Map.\nNow turn off all layers except the GB Overview Layer, and repeat the steps above to create an Overview theme.\nClick again on the ‘eye’ button and select the Main Map theme. It will revert to the selection of layers you had turned on when you created the theme. Themes are a useful way to have shortcuts to different sets of visible layers.\n\n\n\n\n\n\n\nTip\n\n\n\nIf you need to change an existing theme, activate/deactivate the layers you want, and then click on the eye button and select Replace Theme.\n\n\n\nNow go back to the Layout Editor window, and select the Main Map item. On its Item Properties, find the Layers option and enable the Follow Map Theme option, picking the Main Maptheme. Then do the same with the Overview Map, and set it to the Overview theme.\nSet the scale of the overview map (on its Item Properties) to 5000000 (five million), and use the Move item content () tool so that Newcastle is about centred on the map. This map has ‘painted-on’ labels, so make sure you don’t cut off any labels when placing your map.\n\nNow we need to indicate ‘where’ in the overview map is the main map located. QGIS has a nice feature to do that for us automatically:\n\nGo to the Item Options of the Overview Map and find the Overviews option. Expand it and click on the green plus symbol to add an overview. Select the newly created Overview 1, and on the Map Frame option below it, select Main Map. You should now see a transparent pink box indicating the location and coverage of the Main Map on the Overview map inset.\n\nThe map should now look like this:",
    "crumbs": [
      "Week 4 - Making maps",
      "<span class='chapter-number'>8</span>  <span class='chapter-title'>Lab 8: Making Maps - Part II</span>"
    ]
  },
  {
    "objectID": "lab_carto_2.html#independent-exercise-1---adding-a-second-coordinate-grid-and-a-second-inset-map",
    "href": "lab_carto_2.html#independent-exercise-1---adding-a-second-coordinate-grid-and-a-second-inset-map",
    "title": "8  Lab 8: Making Maps - Part II",
    "section": "8.7 Independent Exercise 1 - Adding a second coordinate grid and a second inset map",
    "text": "8.7 Independent Exercise 1 - Adding a second coordinate grid and a second inset map\n\nNow add a coordinate grid to the Overview map. following the same steps as you did for the main map, but with the following changes:\n\n\nInstead of the OSGB CRS, use WGS84 as the CRS, so that the coordinates are in degrees (to determine ‘where in the world’ somewhere is, degrees make more sense than meters). To do that, manually pick EPSG:4326 as the CRS on the Map Grid Properties of the new grid.\nUse Frame and Annotations Only as for the Main Map, but this time we want coordinates and ticks just on the top and right of the map. So under the Frame options uncheck the Bottom side and Left side boxes, and on the Draw Coordinates section, change the first option of Bottom and Left from Show all to Disabled.\nMake the font size 8, make the coordinates on the right Vertical Descending, and get rid of the unnecessary decimal places (i.e. the zeroes).\nSet the Overview map Frame option to on.\n\nThe final Overview map should look like this:\n\n\nNow add a second inset map showing the aerial photo view of the castle. Follow the steps used for the Overview map, with the following changes:\n\n\nCreate a third theme on QGIS, where only the air photo is visible, and name it Close Up.\nAdd a new map frame in the space left between the Overview map and the Legend, rename it from Map 3 to Close Up, and set it to follow the Close Up theme.\nAdjust this inset map scale to show all of the castle as close up as possible. Aroubnd 15000 should work well.\nDo not add a coordinate grid to this map inset, but do add a Scale Bar. To make the scale relative to the Close Up map, create the scale bar then go to its Item Properties, and on the first option called Map, make sure it is set to Close Up Map. Make the scale only one segment long, and place it within the close up image.\nAdd a small text below the Close Up Map, saying Aerial View of Bamburgh Castle.\n\nYour final map should look like this:",
    "crumbs": [
      "Week 4 - Making maps",
      "<span class='chapter-number'>8</span>  <span class='chapter-title'>Lab 8: Making Maps - Part II</span>"
    ]
  },
  {
    "objectID": "lab_carto_2.html#independent-exercise-2---exporting-your-map",
    "href": "lab_carto_2.html#independent-exercise-2---exporting-your-map",
    "title": "8  Lab 8: Making Maps - Part II",
    "section": "8.8 Independent Exercise 2 - Exporting your map",
    "text": "8.8 Independent Exercise 2 - Exporting your map\nYour map is done! Now all is left is to export it. Your main choices are to export it as an image (to add it in a report or similar), or as a PDF if you want the map to be a standalone file.\n\nTo export as an image, on the Layout Editor window go to Layout &gt; Export as Image.... Pick a folder and file name to save it, and then it will show you some options. You can normally use the default options, or check the Crop to Content box if you want your image edges to cover only the content of the map (i.e. no white margins).\nTo export as a PDF, go to Layout &gt; Export as PDF.... Pick a folder and file name to save it, and then it will show you some options as well. The defaults are fine for most cases.\n\nWell done! You havemade a very complex and (arguably) nice looking map! You are now ready to take on the first module Assessment, and make a beautiful map showing the not-so-beautiful issue of deforestation in the Amazon.",
    "crumbs": [
      "Week 4 - Making maps",
      "<span class='chapter-number'>8</span>  <span class='chapter-title'>Lab 8: Making Maps - Part II</span>"
    ]
  },
  {
    "objectID": "sec_w5_spatial_analysis_I.html",
    "href": "sec_w5_spatial_analysis_I.html",
    "title": "Week 5 - Spatial analysis I",
    "section": "",
    "text": "ILOs covered",
    "crumbs": [
      "Week 5 - Spatial analysis I"
    ]
  },
  {
    "objectID": "sec_w5_spatial_analysis_I.html#ilos-covered",
    "href": "sec_w5_spatial_analysis_I.html#ilos-covered",
    "title": "Week 5 - Spatial analysis I",
    "section": "",
    "text": "Obtain and assess the quality of spatial data from online and offline sources and produce new spatial data using computer and field methods;\nPlan and execute GIS analytical steps to solve spatial problems successfully;",
    "crumbs": [
      "Week 5 - Spatial analysis I"
    ]
  },
  {
    "objectID": "sec_w5_spatial_analysis_I.html#what-will-you-learn",
    "href": "sec_w5_spatial_analysis_I.html#what-will-you-learn",
    "title": "Week 5 - Spatial analysis I",
    "section": "What will you learn",
    "text": "What will you learn\nFor every week, we will list the main theoretical and practical learning goals. Use these as a ‘checklist’ to gauge your learning for each week. If you don’t feel confident you have learned any specific topic, then revisit the week’s material!\n\nPractical knowledge:\n9  Lab 9 - Catch Up / Assignment Work session\nNo new knowledge for this section - it is reserved for you to catch up with previoous content\n10  Lab 10: Geoprocessing tools\n\nGeoprocessing tools\n\nClip vs Intersection\nUnion\nDifference and Symmetrical Difference\nDissolve\nBuffers",
    "crumbs": [
      "Week 5 - Spatial analysis I"
    ]
  },
  {
    "objectID": "lab_catchup1.html",
    "href": "lab_catchup1.html",
    "title": "9  Lab 9 - Catch Up / Assignment Work session",
    "section": "",
    "text": "This lab session is reserved for you to catch up with previous content and/or work on your Map assignment. We will still be present to answer any questions you may have.",
    "crumbs": [
      "Week 5 - Spatial analysis I",
      "<span class='chapter-number'>9</span>  <span class='chapter-title'>Lab 9 - Catch Up / Assignment Work session</span>"
    ]
  },
  {
    "objectID": "lab_geoprocessing.html",
    "href": "lab_geoprocessing.html",
    "title": "10  Lab 10: Geoprocessing tools",
    "section": "",
    "text": "10.1 Guided Exercise: assessing children access to schools\nYou are a GIS analyst at the Stirling council, and you have been asked to perform an analysis regarding children access to schools. Your manager has indicated which data sources you should use, and they want you to answer how many children within the relevant age range live within less than 1km, between 1km and 2km, and further than 2km of any primary (4 to 10 years old) and secondary (11 to 17 years old) school. You have been instructed to use the census data at the most detailed level (Output Area, OA), and to limit your analysis to the OAs and schools that are within Stirling Council Area limits. You should report the results as a table.",
    "crumbs": [
      "Week 5 - Spatial analysis I",
      "<span class='chapter-number'>10</span>  <span class='chapter-title'>Lab 10: Geoprocessing tools</span>"
    ]
  },
  {
    "objectID": "lab_geoprocessing.html#guided-exercise-assessing-children-access-to-schools",
    "href": "lab_geoprocessing.html#guided-exercise-assessing-children-access-to-schools",
    "title": "10  Lab 10: Geoprocessing tools",
    "section": "",
    "text": "10.1.1 Obtaining the data\n\nThe first piece of data needed for this exercise is of course the limits of the Stirling Council Area. The official administrative boundary data for the UK is contained within the Ordnance Survey Boundary Line dataset. It can be downloaded from the Ordnance Survey Open Data Hub or from Digimap, but the files cover all of the UK, and thus are a very large download. To save precious lab time, we have already isolated the Stirling Council boundary as a separate file that you can download here. You are welcome!\n\nYou can then download the two other datasets needed:\n\nScottish School Roll and Locations: this dataset is provided by the Scottish Government, and contains information on all Scottish schools. Download the ‘Scottish School Roll and Locations ZIP’ (NOT the one with ‘Table’ on the name) from here.\nCensus data on population age: the Digimap platform offers access to the 2011 Census variables in spatial format. To obtain it, go to the Society tab, and then select the ‘Download’ option on the leftmost toolbar (a down arrow going into a ‘box’). That will bring up the familiar Digimap download interface. This time we will use our Stirling Council shapefile to set the search area. For that, click on the Import Polygons button, and then on Choose File. Then choose the zipped Stirling dataset you have downloaded and click on import. Finally, under the 2011 Census data layers tab, select the Age dataset. Your window should look like this:\n\n\n\n\n\n\n\n\nWarning\n\n\n\nThe data for the 2022 census have been officially published by National Records of Scotland, but are not available on Digimap yet. Since we are only practising our GIS knowledge, it is OK to use mismatched data (schools from 2024 vs. age data from 2011). In a real application scenario, it would be very important to make sure the temporal coverage of the datasets matches as well as possible.\n\n\n\nAdd your data to the basket and finish the order, then download the data as you have done in previous labs.\nNow create a folder structure for your project and extract and organise the contents of the three datasets. Then create a new QGIS project and import the three datasets. The census geopackage will contain layers for different levels of aggregation, remember you want the Output Area polygons. If everything worked correctly, you should have something like this:\n\n\n\n\n\n\n\n\nStop and Think\n\n\n\n\nWhat are the data models and file formats of each dataset?\nWhat are the attributes contained in each dataset?\nWhat is the CRS of each dataset? Are they all the same?\n\n\n\n\n\n\n\n\n\nClick for answer\n\n\n\n\n\n\nThey all use the vector data model. The schools are vector points, the other are vector polygons.\nThe attributes of each dataset can be seen by either inspecting the attribute table of each dataset or by looking at the layer Properties &gt; Fields tab.\nAll three datasets are in OS British Standard Grid (EPSG 27700). You can find this out by either going to the Properties &gt; Information tab or by right-clicking on the layer name then on Layer CRS.\n\n\n\n\n\n\n\n10.1.2 Preparing the data\nYou may have noticed that your Digimap census data download includes many OA polygons that are outside of Stirling Council. This is because of a (sadly) very common problem with spatial data from different sources - the census output areas (OAs) do not perfectly line up with the administrative boundaries of the council. So when the Digimap interface tries to determine which OAs overlap with Stirling, we get more data than we need.\n\nSet the symbology of the Stirling boundaries to a red outline without fill. Then make sure this layer is on top of the census layer. Then zoom in very close to the Stirling boundary. You will see they are offset by about 1.5m:\n\n\nWe thus need to further subset our data to match the actual extent of the Stirling coucil.\n\n\n\n\n\n\nStop and Think\n\n\n\nWhat are the options of GIS operations that you have to subset the datasets?\n\n\n\n\n\n\n\n\nClick for answer\n\n\n\n\n\nYou could use Clip or Intersection if you wanted to change (‘cut’) the geometries of the target layer, or use Select by Location if you wanted to fidn the overlapping polygins without changing geometries.\n\n\n\nAfter consulting with your manager, you both decide that clipping or intersecting the data would not be a good option as it would change the geometry of the OAs, and there are official limits. So you decide to use Select by Location:\n\nGo to Vector &gt; Research Tools &gt; Select by Location... or click on the  button.\nSelect all polygons from the census layer that are within the Stirling bounds layer. Check the selection results.\nChange your criteria to include both intersect and are within the Stirling bounds layer. Check the selection results.\n\n\n\n\n\n\n\nStop and Think\n\n\n\nWhy both selection attempts give you wrong results? How would you fix it?\n\n\n\n\n\n\n\n\nClick for answer\n\n\n\n\n\nBecause of the mismatch between the boundaries of the OAs and the Stirlingshire boundaries. So inner OAs that are the edges of the council area are not considered fully within (they extend a sliver outwards from the actual bounds), and outer OAs also at the edges will be considered to intersect Stirling since they extend a sliver within the bounds.\nThink a bit on how to fix it, then continue below for a solution.\n\n\n\nYou could manually deselect the polygons that are not part of Stirling council, but then you have an idea: what if you buffer the Stirlingshire boundaries to expand them a tiny bit, and then try selecting the polygons within the buffer. That way OAs inside the council area that slightly extend outwards will fall within the buffer, while OAs outside the council area that slightly extend inward will still not be fully within it.\n\nGo to Vector &gt; Geoprocessing &gt; Buffer and create a 20m buffer around the Stirling layer. You can just leave it as a temporary layer, as we will only use it for our spatial selection.\nNow repeat the Select by location operation for OA polygons within the buffered area. Bingo!\nSave the selection as a new layer by right clicking on the census layer name and selecting Export &gt; Save Selected Features As... Once this new census layer is added to your project, remove the original one to avoid confusion.\n\n\n\n10.1.3 Answering the question\nNow we can answer the actual study question. As a reminder, it is how many children in the relevant age range live within less than 1km, between 1km and 2km, and further than 2km of any primary (4 to 10 years old) and secondary (11 to 17 years old) school?. You will need to use some of the Geoprocessing tools you just learned to answer that, as well as tools from previous weeks.\n\n\n\n\n\n\nStop and Think\n\n\n\nBefore you continue, try to think about the solution yourself. Look at the attributes of each layer, and then try to sketch a step by step plan to achieve the results you need. Then continue.\n\n\n\nYou will first need to add up the number of children at each 1yr age bracket to compute the totals for the primary and secondary school age ranges (4-10 yo and 11-17 yo). For that, you can use the Field Calculator, as in previous labs. Just add up the numbers for columns age_4 to age_10 into a new age_4-10 column, and then add columns age_11 to age_17 into a new age_11-17 column.\nThen you will need to select only the schools within the Stirling council area. You can use Select by location as above, using the Stirling bounds, or by using the LAname field in the attribute table of the School Roll layer. Both methods should give you a selection of 48 schools. Create a new layer containing just these schools, then remove the original school layer from the project.\nThe next step is to calculate the area covered by each distance bracket (1km, 2km) from the schools. For that, you should create a Buffer for the 1km distance, then a second Buffer for the 2km distance. Make sure you select the Dissolve result option when creating the buffers, since many locations will be within less than the specified distance from multiple schools, and we don’t want to repeat them.\nThen compute the Difference between the 2km and 1km buffers to create “rings” covering the range of 1km to 2km. This is important so we don’t “double count” the 1km bracket - see below.\n\nNow you have to deal with the biggest limitation of your analysis - the OAs are still very big, and many will span areas both within and outside the 1k and 2km distances. You discuss the problem with your manager again, and you decide that the best approach is to weight the children count of each OA by the respective area of the OA that is within each distance bracket. So if an OA has 15 children aged 11-17, and 40% of the OA area is within 1km of a school, then you should multiply 15 by 0.4 to obtain the estimated number of children within 1km.\n\nThe first step is to calculate the total area of each OA. You can do that by using the Field Calculator tool and creating a new field called oa_area that takes the $area parameter under the Geometry calculator operations. Remember to make this new field a Decimal number with two decimal places.\n\n\n\n\n\n\n\nStop and Think\n\n\n\nWhat units were used for the area calculation? Does it matter?\n\n\n\n\n\n\n\n\nClick for answer\n\n\n\n\n\nUnless you have set it differently in your Project properties, areas are calculated in squared metres by default. This is not an ideal unit for such large areas (km\\(^2\\) would have been better), but since we will only need to calculate the percentage of this total area within each distance bracket, it shouldn’t matter much.\n\n\n\nNow that you have the total areas for each OA, it is time to find out the portions within each distance bracket. For that, we can either Clip or get the Intersection of the buffer layers with the census layer.\n\n\n\n\n\n\nStop and Think\n\n\n\nWhat will change in your results if you use Intersection instead of Clip?\n\n\n\n\n\n\n\n\nClick for answer\n\n\n\n\n\nIntersection will combine the attributes of both layers, while CLip will only preserve the attributes of the target layer.\n\n\n\n\nSince the buffers have been dissolved, they can’t be linked to individual schools anymore - whenever the buffers of two schools overlap their attribute tables will just keep the name of one of the schools when they are dissolved. So no need to preserve the buffer attributes, and we can use Clip. Create two new layers, the first being the clipping of the census layer by the 1km buffer layer, and the second being the clipping of the census layer by the 1km-2km ‘donuts’ layer. We use it instead of the 2km buffer otherwise when we calculate the percentage of area within 2km we will be double counting the area within 1km - which is already covered by the 1km buffer.\n\nYou should end up with something like the figure below. To make sure the layers don’t overlap, style them using hatching in different directions. If you see a cross-hatch, then they are overlapping, and it means you used the full 2km buffer instead of the 1km-2km ‘donut’:\n\n\nNow we can calculate the area percentages. First, re-calculate the polygon areas for the clipped layers, using the Field Calculator. Create a new attribute called clip_area, and assign the $area operator to it again. Remember to set it as a decimal number.\nStill using the Field Calculator, you can now calculate the percent area by creating a new attribute called perc_area, which will be clip_area / oa_area. It should also be a decimal number.\nFinally, calculate the weighted number of children by creating new fields. First calculate perc_4-10 as age_4-10 * perc_area, and then perc_11-17 as age_11-17 * perc_area. These fields should be integers, unless you are sending partial children to school.\n\nGreat, you are almost there! The last step is to aggregate all the data at the council level, and then also determine the number of children beyond 2km:\n\nUse the Statistical Summary tool to calculate the respective sums of perc_4-10 and perc_11-17. These are the final answers for how many children in the relevant age range live within less than 1km, between 1km and 2km?.\nTo get the number of children beyond 2km, use the Statistical Summary tool to calculate the total number of children within each age bracket (age_4-10 and age_11-17) in the council, and then subtract the number of children within 1km and between 1km and 2km from this total.\n\nYour final results should be:\n\n\n\n\n1km\n2km\n&gt;2km\n\n\n\n\nPrimary\n6451\n6656\n89\n\n\nSecondary\n7572\n7880\n91\n\n\n\nThat is the end of this lab. From now on the exercises will be a bit more involved, like the one above - but at the same you will notice that much of it is still the same - loading data, organising it, doing queries - we will just be adding new tools that open up new (but quite specific) analysis possibilities and/or make some of the things you did before faster/simpler. But the general workflow of GIS is always the same.",
    "crumbs": [
      "Week 5 - Spatial analysis I",
      "<span class='chapter-number'>10</span>  <span class='chapter-title'>Lab 10: Geoprocessing tools</span>"
    ]
  },
  {
    "objectID": "sec_w6_spatial_analysis_II.html",
    "href": "sec_w6_spatial_analysis_II.html",
    "title": "Week 6 - Spatial analysis II",
    "section": "",
    "text": "ILOs covered",
    "crumbs": [
      "Week 6 - Spatial analysis II"
    ]
  },
  {
    "objectID": "sec_w6_spatial_analysis_II.html#ilos-covered",
    "href": "sec_w6_spatial_analysis_II.html#ilos-covered",
    "title": "Week 6 - Spatial analysis II",
    "section": "",
    "text": "Obtain and assess the quality of spatial data from online and offline sources and produce new spatial data using computer and field methods;\nPlan and execute GIS analytical steps to solve spatial problems successfully;",
    "crumbs": [
      "Week 6 - Spatial analysis II"
    ]
  },
  {
    "objectID": "sec_w6_spatial_analysis_II.html#what-will-you-learn",
    "href": "sec_w6_spatial_analysis_II.html#what-will-you-learn",
    "title": "Week 6 - Spatial analysis II",
    "section": "What will you learn",
    "text": "What will you learn\nFor every week, we will list the main theoretical and practical learning goals. Use these as a ‘checklist’ to gauge your learning for each week. If you don’t feel confident you have learned any specific topic, then revisit the week’s material!\n\nPractical knowledge:\n11  Lab 11 - Data Joins\n\nWFS layers\nImporting non-spatial tables\nTable Joins\n\nAttribute Joins\nSpatial Joins\n\nCounting Points in Polygons\n\n12  Lab 12 - Zonal Statistics and Overlap Analysis\n\nZonal Statistics\nOverlap Analysis\nSample Raster Values",
    "crumbs": [
      "Week 6 - Spatial analysis II"
    ]
  },
  {
    "objectID": "lab_joins.html",
    "href": "lab_joins.html",
    "title": "11  Lab 11 - Data Joins",
    "section": "",
    "text": "11.1 Guided Exercise 1 - Working with WFS layers.\nBoth WFS (Web Feature Services), WMS (Web Map Services), and WCS (Web Coverage Services) are standardised web sharing formats defined by the Open Geospatial Consortium (OGC). WMS and WCS are designed to serve images (i.e. rasters), while WFS is designed to serve features (i.e. vectors). This is similar to the streaming of Google Maps or Open Street Maps you have used with QGIS already, with the difference that layers streamed via WFS function just like layers you download to your computer.\nThe advantage of these formats is that you can connect direct with the data provider without having to download the data to disk first - but that is also the disadvantage, since if you lose internet connection you then have no data. More and more data providers are offering these options, so we will explore one example of a WFS layer here, and use it for the rest of the exercises.\nhttps://geo.spatialhub.scot/geoserver/sh_las/wfs?authkey=b85aa063-d598-4582-8e45-e7e6048718fc",
    "crumbs": [
      "Week 6 - Spatial analysis II",
      "<span class='chapter-number'>11</span>  <span class='chapter-title'>Lab 11 - Data Joins</span>"
    ]
  },
  {
    "objectID": "lab_joins.html#guided-exercise-1---working-with-wfs-layers.",
    "href": "lab_joins.html#guided-exercise-1---working-with-wfs-layers.",
    "title": "11  Lab 11 - Data Joins",
    "section": "",
    "text": "Create a lab_11 folder to organise your data and then start a new QGIS project and save it as lab_11. Set the project CRS to EPSG:27700.\nThe Scotland Spatial Hub https://data.spatialhub.scot/ hosts official datasets from the Scotland Government. One of the layers is a vector file with the administrative boundaries for Scotland, the Scotland Council Areas. We can access this dataset via WFS. First, copy the link below:\n\n\n\nNow on the Browser panel of QGIS, find the WFS / OGC API Features option, then right-click on it and select New Connection:\n\n\n\nYou will get a new window. On this new window, paste the link above on the URL box, and then type Scotland Spatial Hub on the Name box. Then click OK.\n\n\n\nYou should now have a new Scotland Spatial Hub entry under WFS / OGC API Features on the Browser panel. Expand it and double-click on Local Authority Boundaries - Scotland. It will add this layer to your Layers panel.\nInspect the attribute table of this layer, and play with its Symbology. You will see it behaves exactly like a downloaded shapefile or geopackage. Just remember you must have an internet connection for it to be available - and some operations will feel slower, since it has to communicate back and forth with the data server.\n\n\n\n\n\n\n\nTip\n\n\n\nYou can always make the WFS layer ‘local’ by right-clicking on it and selecting Export &gt; Save Feature As..., and then saving a copy of it as a shapefile or geopackage.",
    "crumbs": [
      "Week 6 - Spatial analysis II",
      "<span class='chapter-number'>11</span>  <span class='chapter-title'>Lab 11 - Data Joins</span>"
    ]
  },
  {
    "objectID": "lab_joins.html#guided-exercise-2---importing-tabular-data",
    "href": "lab_joins.html#guided-exercise-2---importing-tabular-data",
    "title": "11  Lab 11 - Data Joins",
    "section": "11.2 Guided Exercise 2 - Importing tabular data",
    "text": "11.2 Guided Exercise 2 - Importing tabular data\nSometimes you may have data that has coordinate information, but it is not in a spatial file format. For example, perhaps someone took soil samples along a beach and manually recorded the sampling locations by writing down the coordinates from a GPS receiver. We can still transform this data into spatial data - as long as we know which was the CRS used to record the coordinates. This is often a big problem, as people that are not GIS savvy (like yourself) do not understand CRSs and just write down the coordinates.\nAnother common issue is that people will see coordinates like -5.67543 degrees on the GPS device, and then round it down when writing. But (at the equator) one degree of latitude/longitude is about 111km, so if you round down the above coordinate to -5.67, you are rounding it up to the nearest 1km, and introducing a huge error.\nIn this exercise, we will import some data from Police Scotland about traffic incidents, which is provided in tabular format.\n\nTo obtain the data, follow this link to the Police Scotland website. Then download the Road Traffic Collisions - Circumstances Raw Data dataset, which should be an Excel file (.xsls).\n\nQGIS is not able to understand Excel files, so we need to convert it to a Comma Separated Value (CSV) file. A CSV is just a plain text file where each line is a row on the table, and the data for each column is separated by…you guess it…a comma (actually sometimes it is a semicolon - especially in countries that use the comma instead of the period as a decimal separator).\n\nOpen the file you downloaded in Excel. The first thing you’ll notice is that they have a VERY professional way of marking the data as official - a floating red text box saying ‘official’. Delete this box, then go to File &gt; Save As and then change the save format from Excel workbook (.xlsx) to CSV UTF-8 (Comma Separated Value) (.csv). You can save it with the same name on the same folder you downloaded it.\nOpen the Notepad application (on Windows, on Mac use TextEdit) and then open the csv file you created, just to see how a CSV file is organized. Then close it.\nBack on QGIS (in your lab_11 project), open the Data Source Manager by clicking on the  button on the main QGIS toolbar. Then pick the option Delimited Text. On the top box, find the .csv file you have created. Then make sure your options look the same as the figure below, including picking the correct data type for date_of_collision (date) and time_of_collision (time). Once you have everything set, click on Add, then Close.\n\n\n\nYou should now see a new layer in your project, with the same name as the CSV file, and a number of different data points that roughly form the shape of Scotland. Inspect the attribute table of this new layer, and pay attention to the name of the last attribute column in the dataset.\nAt this point QGIS is still reading the data straight from the CSV, which is not very efficient. Let us save the data by right-clicking on the layer name and going to Export &gt; Save Features As... and saving it as a geopackage. You can then remove the imported csv layer from the project.",
    "crumbs": [
      "Week 6 - Spatial analysis II",
      "<span class='chapter-number'>11</span>  <span class='chapter-title'>Lab 11 - Data Joins</span>"
    ]
  },
  {
    "objectID": "lab_joins.html#guided-exercise-3---table-joins",
    "href": "lab_joins.html#guided-exercise-3---table-joins",
    "title": "11  Lab 11 - Data Joins",
    "section": "11.3 Guided Exercise 3 - Table Joins",
    "text": "11.3 Guided Exercise 3 - Table Joins\nWe now have two separate layers with separate data tables - the Local Authority boundaries and the Traffic Accidents. But they share an attribute in common: local_authority in the former and GIS_Local_Authority in the latter. We can use these attributes to join the two tables.\n\nRight-Click on the Traffic Accidents layer and go to Properties &gt; Joins. Then click on the green plus button at the bottom to create a new join. A new window will appear - pick the Local Authority layer as Join Layer, and local_authority as the Join field (notice these are the attributes of the Local Authority layer). Then pick GIS_Local_Authority as the Target field (notice these are the attributes of the traffic layer). It should look like the figure below. Click OK on this window and notice a new join has been added. Click OK again.\n\n\n\nOpen the attribute table of the traffic collision layer again. Look at the last attribute columns of the table - there should now be two additional columns, showing the code and hectares fields of the Local Authority layer! Notice that while the Local Authority Layer only has one row per Authority area, the respective values of code and hectare are repeated for all traffic incidents occurring in the same Authority area.\n\n\n\n\n\n\n\nStop and Think\n\n\n\nOn the joined attribute table of the Traffic Collisions layer, the local authorities of Dumfries & Galloway, Argyll & Bute, Perth & Kinross and Eilean Siar have all code and hectare fields as NULL, while they seem fine on the Local Authority attribute table. Can you identify what the problem is?\n\n\n\n\n\n\n\n\nClick for answer\n\n\n\n\n\nThe main issue is that computers are dumb :-). Dumfries & Galloway, Argyll & Bute, and Perth & Kinross are spelled with an & on the Traffic Collision layer but with an and on the Local Authority layer, and Eilean Siar (the Outer Hebrides) is spelled as Na h-Eileanan an Ia. As far as the computer is concerned, these things are not the same, and so it does not make the join for these data rows. This is a classic example of the many small data inconsistencies that need to be fixed when working with real-world data.",
    "crumbs": [
      "Week 6 - Spatial analysis II",
      "<span class='chapter-number'>11</span>  <span class='chapter-title'>Lab 11 - Data Joins</span>"
    ]
  },
  {
    "objectID": "lab_joins.html#guided-exercise-4---spatial-joins",
    "href": "lab_joins.html#guided-exercise-4---spatial-joins",
    "title": "11  Lab 11 - Data Joins",
    "section": "11.4 Guided Exercise 4 - Spatial Joins",
    "text": "11.4 Guided Exercise 4 - Spatial Joins\nYou may be tempted to fix the problem above by using the Field Calculator to replace the spelling on one table by the spelling on the other. But there is another way - using a spatial join instead of an attribute join. Just like you can select data rows by attribute or by location, you can also join data tables by either attributes or location. Let’s do it.\n\nFirst, remove the attribute join your created before. Go to the Properties &gt; Joins of the Traffic Collision layer, select the existing join and remove it using the red minus symbol. Then click OK.\nNo go to the menu Vector &gt; Data Management Tools &gt; Join Attributes by Location.... You will see a new window similar to the Select by Location window. Then specify you want to Join features in the Traffic Collision layer that Are Within the Local Authority layer. Because there are many traffic incidents for each Authority area, you want to keep the Join type as one-to-many. For reference, check the figure below. This operation creates a new layer containing the joined table, so pick a folder and save your result as a vector file named traffic_collisions_authority_joined, then click Run then Close.\n\n\n\nCheck the attribute table of the new joined layer you created. There should now be three new columns at the end - the three columns from the Local Area layer: local_authority, code and hectares (when we join by attribute QGIS knows not to repeat the matching field, so it only brings in code and hectare - but when we join by location then it brings all attributes).\n\n\n\n\n\n\n\nStop and Think\n\n\n\nWe can see that for most cases our Spatial Join fixed the name mismatch issues, and we see values of GIS_Local_Authorities like Dumfries & Galloway matched to local_authority values like Dumfries and Galloway. But if you sort your joined attributed table by local_authority, you will see there are now 11 rows with NULL values. Can you identify the problem this time?\n\n\n\n\n\n\n\n\nClick for answer\n\n\n\n\n\nThese 11 traffic incidents may have been recorded with wrong or uncertain coordinates, and they fall ‘outside’ of the Local Authority polygons. For example, manually select the row for Dundee City (click on the row number) and then click on the Zoom Map to Select Rows button (at the top of the attribute table, looks like a magnifying glass). The check the QGIS map canvas, and you will see this data point is located over water, so it is not joined to any Authority polygon - maybe a boat traffic incident?",
    "crumbs": [
      "Week 6 - Spatial analysis II",
      "<span class='chapter-number'>11</span>  <span class='chapter-title'>Lab 11 - Data Joins</span>"
    ]
  },
  {
    "objectID": "lab_joins.html#independent-exercise-1---counting-points-in-polygons",
    "href": "lab_joins.html#independent-exercise-1---counting-points-in-polygons",
    "title": "11  Lab 11 - Data Joins",
    "section": "11.5 Independent Exercise 1 - Counting points in polygons",
    "text": "11.5 Independent Exercise 1 - Counting points in polygons\nIn this exercise, you will practice using joins and spatial joins, and will also independently learn another two GIS tools: Count Points in Polygons (QGIS Documentation) and Statistics by Categories (QGIS Documentation).\nYou have been tasked with calculating a) the total amount of traffic incidents and b) the rate of incidents per capita, for all census Output Areas. To achieve that, together with the Traffic Collision layer you already have, you have been given a shapefile with the boundaries of the census Output Areas, and a csv file with the population information for each Output Area (download them here)\n\nDownload, extract and organise your files, and start a new project.\nLoad the data into QGIS. The CSV file doesn’t have any coordinates, so you can just drag it and drop it in the Layers panel. It will show up as a non-spatial table (no geometries to show, but still has an attribute table).\nGuess what? The Output Area shapefile has topology errors. Use the Fix Geometries tool (Procesing panel, under the Vector Geometry category) to create a new shapefile with fixed geometries. Once you create it, rebuild the spatial index of this new fixed layer by going to Vector &gt; Data Management Tools &gt; Create Spatial Index. Otherwise your next step will be very slow.\nNow do a spatial join between the fixed OA layer and the Traffic Collision layer. You want to join features from the traffic collision that are within the OAs. Save this new result as a new layer.\nYour resulting layer should now have all the traffic collisions joined to their respective OA codes. Now use the Statistics by Categories tool to count how many traffic collisions per Output Area code. The tool is in the Processing panel, under the Vector Analysis category. You want to calculate the counts, using the code attribute as the category for calculation. The window should look like this:\n\n\n\nThe output of the above step will be another non-spatial table. Join this table to the OA polygons using code as the common attribute - the OA layer should be one receiving the join. Then do a second join to bring in the age data from the CSV file as well. For this join, bring only the ALl_people field from the csv file - enable the Joined fields box on the new join window, and then check only the box for ALl_people. Your attribute table now should look like this:\n\n\n\nThe Statistics_by_category_count attribute answers question a) above - total number of traffic collisions per OA. To answer question b), use the Field calculator to divide this number by All_people, to get the total collisions per capita.\nBecause you only wanted counts of points to answer a), there is a simpler alternative to joining then summarising. Go to Vector &gt; Analysis Tools &gt; Count Points in Polygons. The pick the (fixed) Output Area polygons as your Polygons and the Traffic Collisions layer as your Points, then save and run the results. You will see it calculates a new column named NUMPOINTS. You could then do a table join of this layer to the CSV table to get the All_people column, and answer question b). There are often multiple ways to achieve the same result in GIS!\nMake two visualisations of the results: one colouring the OA polygons by the number of total collisions, and another by the total collisions per capita.",
    "crumbs": [
      "Week 6 - Spatial analysis II",
      "<span class='chapter-number'>11</span>  <span class='chapter-title'>Lab 11 - Data Joins</span>"
    ]
  },
  {
    "objectID": "lab_joins.html#independent-exercise-2---practicing-joins",
    "href": "lab_joins.html#independent-exercise-2---practicing-joins",
    "title": "11  Lab 11 - Data Joins",
    "section": "11.6 Independent Exercise 2 - Practicing Joins",
    "text": "11.6 Independent Exercise 2 - Practicing Joins\nFirst, download the data files from here. They contain population information per Council Area for Scotland from the 2011 and 2022 census, respectively.\n\nAdd the CSV data to QGIS as non-spatial layers (tables).\nAdd the “Local Authority Boundaries” WFS layer from Guided Exercise 1\nJoin the Census 2011 layer to the Local Authority layer using the fields ‘Scottish Council Area’ and ‘local_authority’. Select only the columns ‘All people’, ‘Males’ and ‘Females’. Also toggle the Custom field name prefix option and type ‘2011_’.\nNow repeat the process to join the same three columns from the 2022 data. Don’t forget to use the ‘2022_’ prefix to distinguish them from the 2011 data.\nExport the joined data as a new Geopackage or Shapefile file.\nMake three thematic visualisations of the following information:\n\nThe total change in population per Council Area between 2011 and 2022.\nThe total change in population density (people/km2) per Council Area between 2011 and 2022.\nThe change in sex ratios (male/female) per Council Area between 2011 and 2022.\n\nOne of the measures for quality of life and healthy living is access to green spaces. Using the population census layer you created, and the OS Open Greenspaces dataset, calculate how many m\\(^2\\) of green space are available per capita for each Council Area in Scotland, and make a map showing this result.\n\n\n\n\n\n\n\nHint\n\n\n\n\n\nHint: You will need to do two separate joins: one to add the corresponding Council Area Name to each green space entry. Then you will need to calculate the total green space area per CA using the Statistics by Category tool. You can then join the Area attribute of this new layer to the original Local Authority attribute table containing the joined census data, and then calculate the proportions as a new field.",
    "crumbs": [
      "Week 6 - Spatial analysis II",
      "<span class='chapter-number'>11</span>  <span class='chapter-title'>Lab 11 - Data Joins</span>"
    ]
  },
  {
    "objectID": "lab_zonal.html",
    "href": "lab_zonal.html",
    "title": "12  Lab 12 - Zonal Statistics and Overlap Analysis",
    "section": "",
    "text": "12.1 Guided Exercise 1 - Data preparation\nIn this exercise, we will look at air pollution data from the city of Amsterdam, in the Netherlands. Importantly for this exercise, Amsterdam is broken up into 8 districts or boroughs (stadsdelen), which are further divided into neighbourhoods (buurten).\nMore specifically, we will be looking at NO\\(_2\\) (Nitrogen Dioxide) pollution. NO\\(_2\\) is mainly produced by combustion engines, and impacts respiratory health.\nThe data for this exercise has been pre-packaged and can be downloaded here, and it consists of the following datasets:\nIf you are curious, these files were obtained from the City of Amsterdam geodata portal.",
    "crumbs": [
      "Week 6 - Spatial analysis II",
      "<span class='chapter-number'>12</span>  <span class='chapter-title'>Lab 12 - Zonal Statistics and Overlap Analysis</span>"
    ]
  },
  {
    "objectID": "lab_zonal.html#guided-exercise-1---data-preparation",
    "href": "lab_zonal.html#guided-exercise-1---data-preparation",
    "title": "12  Lab 12 - Zonal Statistics and Overlap Analysis",
    "section": "",
    "text": "A geopackage file containing four layers:\n\nThe location of several NO2 measurement sites, as point vectors.\nThe extent and location of parks and green spaces in Amsterdam, as a polygon vector layer.\nThe official boundaries of Amsterdam’s neighbourhoods, as polygon vectors.\nA rectangular polygon defining the extent of the study.\n\nA CSV file containing annual NO\\(_2\\) measurements for several sites, including the sites identified in the geopackage above.\n\n\n\nA raster file showing modelled annual NO2 concentrations for the year 2008, produced as an output from this research article. The original files cover all of the Netherlands, but have been cropped to make the file size more manageable for this exercise.\n\n\nDownload the data and create a project folder and a QGIS project for this exercise. The project should be set to EPSG:28992 - Amersfoort / RD New, the standard CRS for the Netherlands.\n\n\n\n\n\n\n\nTip\n\n\n\nTwo useful websites to find information about coordinate reference systems are https://epsg.io/ and https://spatialreference.org/. Search for EPSG:28899 in thee websites and see what information they provide.\n\n\n\nNow load all five layers and the CSV file into your project. This CSV file has no coordinates, so you can just drag it to your Layers panel without needing to use the Import Delimited Text tool.",
    "crumbs": [
      "Week 6 - Spatial analysis II",
      "<span class='chapter-number'>12</span>  <span class='chapter-title'>Lab 12 - Zonal Statistics and Overlap Analysis</span>"
    ]
  },
  {
    "objectID": "lab_zonal.html#guided-exercise-2---zonal-statistics",
    "href": "lab_zonal.html#guided-exercise-2---zonal-statistics",
    "title": "12  Lab 12 - Zonal Statistics and Overlap Analysis",
    "section": "12.2 Guided Exercise 2 - Zonal Statistics",
    "text": "12.2 Guided Exercise 2 - Zonal Statistics\nYou are now a GIS analyst at the Amsterdam city administration, and have been asked to analyse the pollution levels per city neighbourhood, using the data for 2008 published by the scientific study above. Specifically, you have been asked to calculate the average NO\\(_2\\) concentrations for each neighbourhood.\nYou have access to the neighbourhood boundaries in vector format, but the study data is given as a raster data.\n\n\n\n\n\n\nStop and Think\n\n\n\nUsing the GIS tools you have learned so far, how would you accomplish this?\n\n\n\n\n\n\n\n\nClick for answer\n\n\n\n\n\nSince at this point we don’t know many tools that interface rasters and vectors, we would have to do it in a rather convoluted way. First, we would need to separate each neighbourhood into a separate vector file, and then mask the NO\\(_2\\) raster multiple times to generate one pollution raster for each neighbourhood. We could then calculate the Raster Layer Statistics for each one of the masked neighbourhoods, and manually copy each average to a table. No big deal, there are only 518 neighbourhoods after all. There must be a better way - keep reading!\nStill, this is a good example of how you can get by in GIS even with just basic knowledge and some creative thinking. There are always multiple ways to achieve the same result in GIS, even if some of these ways are not fast or optimal.\n\n\n\nThe right way to accomplish this task is to use the Zonal Statistics tool. It will calculate descriptive statistics (min, max, average, range, etc.) for raster values (pixels) contained within each polygon of a vector layer, and output it as a new vector layer with the same polygons and attributes of the original vector layer, with added attribute columns for the statistics.\n\nGo to the Processing panel and find the Zonal statistics tool (NOT Raster layer zonal statistics), under the Raster analysis category. It will launch a new window.\nOn the Zonal Statistics window, select the neighbourhoods layer as the Input Layer, and the NO\\(_2\\) concentration map as the Raster Layer. Notice how you could select a specific band if your raster contained multiple bands. For Output column prefix write NO2_ - this prefix will be added to the name of each calculated statistic to generate the new attributes. Right click on the ... button to the right of the Statistics to calculate box to see which statistics are available for calculation. In this case we only want the means, so you can uncheck all other boxes. Then save your layer appropriately and Run then Close.\n\n\n\nNow style the new layer you obtained using a continuous colour scale to show NO\\(_2\\) concentrations for each neighbourhood.\nLoad the OpenStreetMap layer (on the Browser Panel, under the XYZ Tiles category). Does it look like NO\\(_2\\) pollution is worse on densely urbanised areas?",
    "crumbs": [
      "Week 6 - Spatial analysis II",
      "<span class='chapter-number'>12</span>  <span class='chapter-title'>Lab 12 - Zonal Statistics and Overlap Analysis</span>"
    ]
  },
  {
    "objectID": "lab_zonal.html#guided-exercise-3---overlap-analysis",
    "href": "lab_zonal.html#guided-exercise-3---overlap-analysis",
    "title": "12  Lab 12 - Zonal Statistics and Overlap Analysis",
    "section": "12.3 Guided Exercise 3 - Overlap Analysis",
    "text": "12.3 Guided Exercise 3 - Overlap Analysis\nAs you continue with your GIS analysis, you notice you have also been given a map with all the parks and green spaces in Amsterdam, and you wonder if they could be related to improved air quality. Maybe you could create an attribute that computed the amount of green spaces within each neighbourhood, and then use that information. You have two polygon vector layers now - one of the neighbourhoods and another of the green spaces.\n\n\n\n\n\n\nStop and Think\n\n\n\nAgain, using the GIS tools you have learned so far, how would you accomplish this?\n\n\n\n\n\n\n\n\nClick for answer\n\n\n\n\n\nSo far the tools we have learned for overlaying separate vector layers are the set of geoprocessing tools. You could calculate the Intersection of the green spaces and neighbourhoods layer - that would create a new layer showing only the extent of green spaces inside each neighbourhood. And because it is an intersection, you will carry all the attributes from both layers, including the neighbourhood names.\nYou could then use the Field calculator to calculate the area of green space for each neighbourhood from the intersection layer, and then use a Join to join these areas to the original neighbourhood layer, bringing in the green space area attribute. If you wanted a percentage instead of an area, you could then use the Field calculator again to divide the green space area by total neighbourhood area to get a percentage cover.\nBut again, there is a faster way. This will be a common theme for many of the tools you will learn from this week on - they don’t necessarily offer new possibilities of analysis, but they will optimise/facilitate the same analysis with less steps. What separates a GIS user from a good GIS user is knowing which approach is optimal for each situation.\n\n\n\n\nGo back to the Processing panel and find the Overlap Analysis tool, under the Vector Analysis category, and launch it. This tool only takes two parameters: Input layer is the main layer you want as output (the neighbourhood layer in this case), and the Overlay layers are the layers you want to calculate the overlap with (in our case, only one, the green spaces layer). Set these two parameters and then save your result to a proper location. A new layer will be produced.\n\n\nThis new layer has all the same attributes and polygons as the original neighbourhoods layer, but two additional fields, named with the name of the overlap layer followed by a _area or _pc suffix: the first gives you the overlap area (in the same units as the CRS you are using, so m\\(^2\\)), and the second gives you the percentage of area overlap. It should look somewhat like this:\n\n\nStyle this new overlap layer to show the percentage of green spaces as a continuous colour. Does it seem to be inversely correlated to NO\\(_2\\) pollution?",
    "crumbs": [
      "Week 6 - Spatial analysis II",
      "<span class='chapter-number'>12</span>  <span class='chapter-title'>Lab 12 - Zonal Statistics and Overlap Analysis</span>"
    ]
  },
  {
    "objectID": "lab_zonal.html#guided-exercise---sample-raster-values",
    "href": "lab_zonal.html#guided-exercise---sample-raster-values",
    "title": "12  Lab 12 - Zonal Statistics and Overlap Analysis",
    "section": "12.4 Guided Exercise - Sample Raster Values",
    "text": "12.4 Guided Exercise - Sample Raster Values\nZonal Statistics lets us sample and summarise raster values based on areas (i.e. polygons). But sometimes, we may be interested in knowing what are the specific raster values under a point coordinate. Again, as a GIS analyst, you have been now asked to determine if NO\\(_2\\) levels have declined between 2008 and 2023. But the point location measurements only go as far back as 2010, so you need to compare the 2023 field measurements to the 2008 modelled values.\n\nBefore we proceed with the analysis, we need to link the NO\\(_2\\) measured values (in the CSV file) with the measurement locations (one of the geopackage layers). You can do that using a Join, and the CodeJ field of the CSV table and the Code field of the locations layer.\nNow we can extract the concentration values from the 2008 raster using the Sample Raster Values tool. You will find it in the Processing panel, under the Raster Analysis section. Similarly to the Zonal Statistics tool, you will be asked to select an Input Layer (the vector points) and a Raster Layer (the pollution raster), and to pick a prefix for the field name (we can use NO2_ again). Save your result in the appropriate location and click on Run then Close.\n\n\n\nThe new layer created by the Sample raster values tool will be a copy of the input point layer, but will have one additional attribute at the end, named NO2_1. The *_1* refers to the band number. If the raster file had multiple bands, it would generate one column for each band. You can now use the Field calculator to calculate the difference between 2023 and 2008 concentrations as a new decimal number field.\nStyle the layer to show the direction and amount of changes in emissions for each neighbourhood, using a divergent continuous colour scale (so that positive changes are shaded in one colour and negative changes as another - you can use the ColorBrewer palettes for that).",
    "crumbs": [
      "Week 6 - Spatial analysis II",
      "<span class='chapter-number'>12</span>  <span class='chapter-title'>Lab 12 - Zonal Statistics and Overlap Analysis</span>"
    ]
  },
  {
    "objectID": "lab_zonal.html#independent-exercise---taiwanese-hemlock-and-climate-change",
    "href": "lab_zonal.html#independent-exercise---taiwanese-hemlock-and-climate-change",
    "title": "12  Lab 12 - Zonal Statistics and Overlap Analysis",
    "section": "12.5 Independent Exercise - Taiwanese hemlock and climate change",
    "text": "12.5 Independent Exercise - Taiwanese hemlock and climate change\n\n12.5.1 Background\nAs the GIS specialist for an International NGO (Non-governmental organization), you have been tasked with generating a report on the possible susceptibility of the tree species Tsuga chinensis (Chinese Hemlock or Taiwanese Hemlock) to climate change in Taiwan.\n\n\n\n12.5.2 Data Acquisition\nFor this exercise, I am giving you a pre-downloaded dataset, because there are large data files that also require a registration to download. But I am also describing below how to download the original data - you will need it for the Final Project, and also if working with species distribution data is of interest to you in the feature.\nDownload the data package from here.\nThe first step in your analysis is to obtain data on the distribution of T. chinensis. You go to the main source of species occurrence data worldwide, the Global Biodiversity Species Facility (GBIF). GBIF requires creating an account to download.\nOnce you have an account, go to the top left of the webpage and click on Get data &gt; Ocurrences“. You can search for data using the different parameters on the left column. Expand the Scientific name field and search for Tsuga chinensis. Then click on Download (above the table). The data will come as a tab-separated text file.\nThen you would need climate data. There are many climatic datasets out there, but after doing some research you decide to use the Climatologies at High resolution for the Earth’s Land Surface Areas (CHELSA) database, which provides global maps of past, present and future climate data: https://chelsa-climate.org/.\nTo use this dataset, you need to understand the definition of the standard BIOCLIM variables. These are derived from a different climate fataset called WorldClim, and are a set of climatic descriptors devised to capture climatic conditions that are related to species survival. They are explained here:https://www.worldclim.org/data/bioclim.html. The CHELSA database also provides extended BIOCLIM variables (BIOCLIM+, https://chelsa-climate.org/exchelsa-extended-bioclim/)for additional important variables.\nSince you are working with a plant species, you decide to use the following variables:\n\nBio5 = Max Temperature of Warmest Month (upper thermal tolerance)\nBio6 = Min Temperature of Coldest Month (lower thermal tolerance)\nBIOCLIM+ gsp* = Growing Season Precipitation Sum, represents water availability during the growing season.\nBIOCLIM+ gdd5 = Growing Degree Days above 5 Degrees Celsius. A ‘growing degree day’ is a day that has temperatures in the needed range for plant growth, and the variable is calculated by summing the temperature of all GDDs.\n\nYou note on the documentation that Bio 5 and Bio 6 are given in degrees Celsius, growing degree days are given as the total heat summed over all growing days, also in Celsius, and growing season precipitation has values in mm of rain.\nCHELSA also provides data for future climate analysis, including multiple future date prediction targets, various Shared Socioeconomic Pathways (SSPs, aka climate scenarios), and predictions from different climate models in the CMPI6 group.\nYou settle on using projections for the SSP 370 (middle-of-the-road scenario) for the years 2081-2100 prediction, and to restrict your analysis to the average prediction of three climate model outputs:\nIPSL-CM6A-LR (https://cmc.ipsl.fr/ipsl-climate-models/ipsl-cm6/)\nMIROC-ES2L (https://catalogue.ceda.ac.uk/uuid/a31ca90e3d524c99aef5d8223135f397)\nGFDL-ESM4 (https://www.gfdl.noaa.gov/earth-system-esm4/)\nNote: The CHELSA datasets come as global layers, but to reduce download sizes, I have already cropped them to cover Taiwan only. Don’t say I never did anything for you :-).\nFinally, you decide to grab the Taiwan country borders from the GADM website.\n\n\n12.5.3 Data Analysis\nWith that data in hand, you are ready to start your project. You prepare an initial list of the tasks you need to accomplish to achieve your goal:\n\nOrganise the data into a folder and then import the data into a QGIS project. You may add OpenStreetMap (from the XYZ Tiles) to help you to recognise where these data are located in the world. Also, open the attribute tables and raster info to understand the structure of each data file, unit, etc.\nImport the T. chinensis species ocurrence file. Although it is named CSV, you notice it uses tab as a custom column delimiter. The spatial information is on fields decimalLatitude and decimalLongitude.\nMake sure the project CRS is adequate and that all data uses the same CRS, or reproject if not.\nThis exercise focuses on species observation in Taiwan, so clean up all the data to include only records from Taiwan, and only actual observations (e.g. not a specimen in a museum) - i.e. records having the word “observation” on the basisofRec attribute field.\nUse the species occurrence points to extract the minimum and maximum values for each present climate layer, therefore determining the climate envelope of the species. You can then assume that any location where one or more of the climatic variables are outside this range is not suitable for the species’ survival.\nAverage the outputs of the three climatic models for each of your future climatic layers.\nFind out which locations in the future will be within the climate envelope you calculated previously. (Hint: an area has to be within the envelope of all four variables to be considered suitable).\nCalculate the total area of suitable habitat expected for T. chinensis in the years 2071-2100, according to the SSP370 scenario, and determine how much smaller/larger it is than the current suitable area.\nMake a nice map showing your results.\n\nNow that you have a plan in mind, execute it!\nGIS operations to consider: Import Delimited Text File, Select by Location, Select by Expression, Sample Raster Values, Raster Calculator, Raster to Vector conversion, Field Calculator.\nObs: this is a very crude method to determine species distribution and niche, but this is a GIS module, not a Biogeography one. If you find this interesting, search for Species Distribution Modelling (SDM) or Environmental Niche Modelling (ENM). It is a well-developed field with specialised tools and methods, which nonetheless are still GIS operations at heart.",
    "crumbs": [
      "Week 6 - Spatial analysis II",
      "<span class='chapter-number'>12</span>  <span class='chapter-title'>Lab 12 - Zonal Statistics and Overlap Analysis</span>"
    ]
  },
  {
    "objectID": "sec_w8_spatial_analysis_III.html",
    "href": "sec_w8_spatial_analysis_III.html",
    "title": "Week 8 - Spatial analysis III",
    "section": "",
    "text": "ILOs covered",
    "crumbs": [
      "Week 8 - Spatial analysis III"
    ]
  },
  {
    "objectID": "sec_w8_spatial_analysis_III.html#ilos-covered",
    "href": "sec_w8_spatial_analysis_III.html#ilos-covered",
    "title": "Week 8 - Spatial analysis III",
    "section": "",
    "text": "Obtain and assess the quality of spatial data from online and offline sources and produce new spatial data using computer and field methods;\nPlan and execute GIS analytical steps to solve spatial problems successfully;",
    "crumbs": [
      "Week 8 - Spatial analysis III"
    ]
  },
  {
    "objectID": "sec_w8_spatial_analysis_III.html#what-will-you-learn",
    "href": "sec_w8_spatial_analysis_III.html#what-will-you-learn",
    "title": "Week 8 - Spatial analysis III",
    "section": "What will you learn",
    "text": "What will you learn\nFor every week, we will list the main theoretical and practical learning goals. Use these as a ‘checklist’ to gauge your learning for each week. If you don’t feel confident you have learned any specific topic, then revisit the week’s material!\n\nPractical knowledge:\n?sec-spatan4\n\nDensity Tools\n\nKernel Density Estimation\nCount Points in Polygons\n\nDistance tools\n\nDistance to Nearest Hub\nDistance Maps\n\n\n14  Lab 14 - Convex Hulls and Interpolation\n\nConvex Hulls\nInterpolation Tools\n\nInverse Distance Weighting",
    "crumbs": [
      "Week 8 - Spatial analysis III"
    ]
  },
  {
    "objectID": "lab_dist_dens.html",
    "href": "lab_dist_dens.html",
    "title": "13  Lab 13 - Densities and distances",
    "section": "",
    "text": "13.1 Guided Exercise 1 - Obtaining and organising the data\nFor this set of exercises, we will be working with crime occurrence data (arrest incidents) for the city of New York (USA), for the year 2023. Imagine you have been hired to support an analysis of NYC criminality to help better manage police resources and reduce crime.\nThe data package for this exercise can be downloaded here, and has been obtained from the City of New York Police Department website and the NYC Open Data hub, and contains the following:",
    "crumbs": [
      "Week 8 - Spatial analysis III",
      "<span class='chapter-number'>13</span>  <span class='chapter-title'>Lab 13 - Densities and distances</span>"
    ]
  },
  {
    "objectID": "lab_dist_dens.html#guided-exercise-1---obtaining-and-organising-the-data",
    "href": "lab_dist_dens.html#guided-exercise-1---obtaining-and-organising-the-data",
    "title": "13  Lab 13 - Densities and distances",
    "section": "",
    "text": "Arrest incidents for the year 2023, as a point vector shapefile - derived from a shapefile containing all arrest incidents from 2013 to present.\nA polygon vector shapefile with the boundaries for the NYC neighbourhoods.\nA polygon vector shapefile with the boundaries of each Police Precinct in NYC. Each police precinct is the responsibility of a different police chief and team.\nA point vector shapefile with the locations of all police stations in NYC. Most precincts have one station, with a few exceptions in the case of additional speciality police stations such as mounted police.\n\n\nFirst, download and extract the data package, and create a new folder and QGIS project for this lab. Import all four layers to your project. If you wish, add the OpenStreetMap or some other web layer from the QuickMapServices plugin to help with context and navigation.\n\n\n\n\n\n\n\nStop and Think\n\n\n\nZoom to the full extent of the arrests layer - can you spot a problem with it? How can you fix it?\n\n\n\n\n\n\n\n\nClick for answer\n\n\n\n\n\nYou can right click on the layer name and then on Zoom to Layer(s). Apparently, an arrest has been made near ther coast of Africa…This is a common error when people enter missing coordinates as zero instead of a blank value - and then the point will be located at 0 degrees lat / 0 degrees long. To fix it, select the problematic point using the Select Features tool in the toolbar, then put the arrests layer into editing mode, delete the point, save the edits as arrest_incidents_fixed.shp and exit edit mode. Remove the original from the project to avoid confusion.\nDon’t skip this step or your density rasters will get quite large…",
    "crumbs": [
      "Week 8 - Spatial analysis III",
      "<span class='chapter-number'>13</span>  <span class='chapter-title'>Lab 13 - Densities and distances</span>"
    ]
  },
  {
    "objectID": "lab_dist_dens.html#guided-exercise-2---looking-for-crime-hotspots",
    "href": "lab_dist_dens.html#guided-exercise-2---looking-for-crime-hotspots",
    "title": "13  Lab 13 - Densities and distances",
    "section": "13.2 Guided Exercise 2 - Looking for crime hotspots",
    "text": "13.2 Guided Exercise 2 - Looking for crime hotspots\nThe first question you have been asked is where are the crime hotspots in the city, meaning the areas with the largest density of occurrences. The word density usually refers to a count of things divided by some area or volume measurement. For example, population density is number of people per area; oxygen density in normal atmospheric conditions is 1.43 grams / litre.\nIn GIS, density will be usually related to counts of ‘things’ over areas - the more things happening per unit area, the higher the density. This is often called hotspot analysis in GIS, where the hotspots are areas of remarkably high density. And the main tool used for that is known as Kernel Density Estimation (KDE). I have made a video explanation on KDE that you can watch on Canvas. We will now learn about two ways of generating density maps.\n\nThe first way to generate a density map is to change the layer Symbology (see image below). Select the crime layer and go to Properties &gt; Syymbology, then change the symbology type from Single Symbol to Heatmap. Pick Reds as the Color ramp, and a Radius of 1000, changing the radius unit from Millimiters to meters at scale . Then Apply and Close. It will take a bit of time to change the appearance.\n\n\n\nTo add some context, place the neighbourhoods layer on top of it, with no fill and a dark outline. It should look somewhat like this:\n\n\n\n\n\n\n\n\nStop and Think\n\n\n\n\nBased on the hotspot map, which police precincts seems to have their hands full with crime occurrences? And what neighbourhood is it?\nWhat is the CRS of the datasets (which should be also set as the CRS for the project)? What datum, projection and coordinate system does it use?\n\n\n\n\n\n\n\n\n\nClick for answer\n\n\n\n\n\n\nWe can use the Identify Features tool to query the precinct and neighbourhood layers. The 14th precinct seems to deal with the highest crime hotspot, which is mainly located in Midtown South Manhattan.\nWe can find that by looking at the Properties &gt; Information for any of the layers. The CRS is EPSG:2831 - NAD83(HARN) / New York Long Island. It uses the NAD83 datum, the Lambert Conformal Conic Projection and metric coordinates.\n\n\n\n\nThe heatmap symbology is useful for a quick inspection, but it is also restrictive - and it needs to redraw every time you zoom or pan the map, so it can be annoying. It would be more useful if the heatmap was an actual layer. We can create such permanent heatmap using the Heatmap (Kernel Density Estimation) tool.\n\nLaunch the Heatmap (Kernel Density Estimation) tool in the Processing panel, under the Interpolation category. It will show a new window like this:\n\n\n\nPick the crime layer as your Point Layer, then set a radius of 1000 meters (or 1 kilometers). One important additional option here is that we get to set the resolution (pixel size) of our output raster density map. Smaller pixels will look smoother, but will result in larger files and longer processing times. The units here are the same as the layer CRS, so let us use 50 meters for both Pixel X and Y. Leave the Kernel Shape as quartic and the other options as default. Save your result in an appropriate location with the name crime_density_1km_quartic_50m.tif.\nNotice how the output of Heatmap (Kernel Density Estimation) is a raster, and that nodata values are used for regions that are not within 1km of any point (unlike the Heatmap symbology, which paints everything including the zero). Since it is a raster, we can style it with symbology options just the same as any raster. Pick a Singleband pseudocolor colour ramp for your hotspots, and use the same Reds colour ramp you used for the Heatmap symbology in the previous steps.\n\n\n\n\n\n\n\nStop and Think\n\n\n\nDoes the heatmap produced as a layer look the same as the heatmap produced by the symbology?\n\n\n\n\n\n\n\n\nClick for answer\n\n\n\n\n\nThey look close, but not identical. Kernel density estimations are very sensitive to the kernel radius, the shape of the kernel function, the scaling, and the resolution of the output raster, and you can get wildly different results by manipulating these parameters. We can’t set as many parameters when using the Symbology option, so we can’t get the exact same result.\nTherefore KDE is considered a semi-quantitative tool - there is never as correct or best set of parameters to use for generating the maps.\n\n\n\n\nTo demonstrate the issue above, generate a second heatmap layer, this time using 5km as Radius, a Pixel size of 100 metres, the Uniform kernel shape, and Scaled output values. Save it as crime_density_5km_uni_100m_scaled.tif. The style it with the Reds colour ramp as well.\n\nNot only the layer looks very different, but the actual location of the hotspots seem to have changed, and the density values are also very different. It always takes a lot of trial and error to converge on a KDE estimation that is sensible for the problem at hand.\n\nIf you’d like, try different combinations of radii, kernel shapes and pixel sizes. Once you are done, remove them all from your project, leaving only the first density map we created (radius 1000, quartic kernel, pixel size 50m). Also, change the symbology of the crime points layer back to Single Symbol.\nWe can now use tools we already know to associate the crime density information to the precincts and neighbourhoods. Using Zonal Statistics, extract the mean and maximum density values for each precinct. Then make two map visualizations, one colouring the polygons by average crime density, and the other by maximum crime density. Do the same for the neighbourhoods layer. This is what they should look like:\n\n\n\n\nNeighbourhoods Mean Density\n\n\n\n\n\nNeighbourhoods Max Density\n\n\n\n\n\nPrecincts Mean Density\n\n\n\n\n\nPrecincts Max Density\n\n\n\n\n\n\n\n\nStop and Think\n\n\n\nWhich precinct and neighbourhood seem to be the most problematic in terms of crime, i.e. have the highest average and/or maximum crime density?\n\n\n\n\n\n\n\n\nClick for answer\n\n\n\n\n\nWe can look at the attribute table of the zonal statistics results to answer that. This confirms our visual analysis that Midtown / Midtown South Manhattan has the highest maximum and average densities of arrest incidents. Not surprisingly, the 14th Precinct, also known Midtown South Precinct, also has the highest average and maximum densities.",
    "crumbs": [
      "Week 8 - Spatial analysis III",
      "<span class='chapter-number'>13</span>  <span class='chapter-title'>Lab 13 - Densities and distances</span>"
    ]
  },
  {
    "objectID": "lab_dist_dens.html#guided-exercise-3---weighted-kernel-desnities",
    "href": "lab_dist_dens.html#guided-exercise-3---weighted-kernel-desnities",
    "title": "13  Lab 13 - Densities and distances",
    "section": "13.3 Guided Exercise 3 - Weighted Kernel Desnities",
    "text": "13.3 Guided Exercise 3 - Weighted Kernel Desnities\nThe analysis above seems good, but one thing we are not considering is the type of crime. Our incident dataset includes several types, from traffic violations to serious crimes. The law_cat_cd field contains codes identifying the type of incident.\n\n\n\n\n\n\nStop and Think\n\n\n\nWhat are the unique existing values for the law_cat_cd field?\n\n\n\n\n\n\n\n\nClick for answer\n\n\n\n\n\nWe can use the Select by Expression tool from the Attribute Table, then select the law_cat_cd field and ask for a list of its unique values. From less serious to more serious, the values are: I = Infraction, V = Violation, M = Misdemeanor, F = Felony. We also have what appear to be some missing values (NULLs) and some wrong entries (9).\n\n\n\nPerhaps if we give different weights to crime according to their seriousness, our results may change. But for that, we need a numeric attribute that indicates the weight to be given to each type of crime. We could use the Field calculator multiple times by selecting each type of crime and filling a new attribute with the respective number, but there is a quicker way: the CASE WHEN conditional operator.\n\nOpen the attribute table for the arrest incidents layer, and then open the Field Calculator.\nThen enter the CASE expression like it is shown on the figure below. The syntax is quite self explanatory: once you type CASE, you open what we call a block. Inside the block, you then list a series of conditions (i.e. cases) for what numeric value the new attribute should have for different string values of law_cat_cd. At the last line in the block you add the ELSE operator, meaning that if none of the cases are matched, then the new attribute should have a value of 0. That would include the NULLs and the 9 values that are not informative to us. You then close the block with END. We have more than 600k entries, so it will take a while to run!\n\n\n\nNow repeat the Heatmap (Kernel Density) calculation you did before, using a radius of 1000 meters, 50m X and Y pixel sizes, the Quartic Kernel Shape with Raw values, but this time pick the new crim_weigh field for Weight from Field. Save your results with an informative name such as crime_density_1km_quartic_50m_weighted.tif and check the results.\nTo facilitate comparison between the original and the new density layer, change the Singleband Pseudocolor symbology Mode from Continuous to Quantile, with 10 Classes, for both layers.\n\n\n\n\n\n\n\nStop and Think\n\n\n\nHow much did the results change?\n\n\n\n\n\n\n\n\nClick for answer\n\n\n\n\n\nNot much, but we can see incident densities being slightly reduced or increased in some areas after the weighting. The most noticeable is a reduction in density in the northern part of precinct 11th, in the Bronx neighbourhood.",
    "crumbs": [
      "Week 8 - Spatial analysis III",
      "<span class='chapter-number'>13</span>  <span class='chapter-title'>Lab 13 - Densities and distances</span>"
    ]
  },
  {
    "objectID": "lab_dist_dens.html#guided-exercise-4---visualizing-densities-as-isolines",
    "href": "lab_dist_dens.html#guided-exercise-4---visualizing-densities-as-isolines",
    "title": "13  Lab 13 - Densities and distances",
    "section": "13.4 Guided Exercise 4 - Visualizing densities as isolines",
    "text": "13.4 Guided Exercise 4 - Visualizing densities as isolines\nOur density maps are good and informative, but they will hide any layers below them. Isolines or ‘contour lines’ are lines that delineate areas within the same ranges of values, and make for good data overlays. The most common use for them is to indicate topography (see below). Each brown line is associated with an elevation, and some thicker lines are used as reference isolines to facilitate navigation.\n\n\n\nhttps://en.wikipedia.org/wiki/Topographic_map\n\n\nHowever, we can use isolines to show any type of continuous value surface. For weather prediction, for example, contour lines indicating zones of equal pressure are called isobars :\n\n\n\nhttps://www.bbc.co.uk/bitesize/guides/zqwpm39/revision/2\n\n\nWe can therefore also visualise density maps as contour lines. This has the advantage of making it easier to overlay the hotspots on top of other information. To create an isoline map from our crime hotspots, we have two options, similarly to the heatmaps themselves. The first is to use a Symbology, the second is to create a new layer.\n\nSo we don’t lose the original heatmap symbology, right click on the crime density layer and select Duplicate Layer to make a copy of it. Make sure the layer copy is on top of the original layer.\nNow select the layer copy you created and go to Properties &gt; Symbology. Switch the symbology type to Contours. The default values for the contours and the index contours are too low (they are set for elevation), so let us use 1000 as the contour interval, and 2000 as the index contour. Notice how the contour lines align with the hotspots of the original layer.\nNow turn off the hotpots and make a map that uses only the contours to show the crime hotspots over the OpenStreetMap layer, together with the Neighbourhood layer. Something like this:\n\n\n\nNow turn off this contour-styled layer, and instead go to Raster &gt; Extraction &gt; Contour.... Pick your crime density layer as Input Layer, and 1000 as the Interval between contour lines. For attribute name, enter DENS, leave the rest as default and save the result as isolines_density.shp. The output should be identical to the symbology option, but it will be a new line vector layer that can be treated as any other layer, and it will have an attribute that can be used to label the lines.\n\n\n\n\n\n\n\nStop and Think\n\n\n\nChallenge: can you add labels to the contour lines using the label options in QGIS?\n\n\n\n\n\n\n\n\nClick for answer\n\n\n\n\n\nIf you need some help, take a look a t this step by step: https://mapscaping.com/mastering-contour-lines-and-labels-in-qgis/",
    "crumbs": [
      "Week 8 - Spatial analysis III",
      "<span class='chapter-number'>13</span>  <span class='chapter-title'>Lab 13 - Densities and distances</span>"
    ]
  },
  {
    "objectID": "lab_dist_dens.html#guided-exercise-5---distance-to-hubs",
    "href": "lab_dist_dens.html#guided-exercise-5---distance-to-hubs",
    "title": "13  Lab 13 - Densities and distances",
    "section": "13.5 Guided Exercise 5 - Distance to Hubs",
    "text": "13.5 Guided Exercise 5 - Distance to Hubs\nContinuing with our crime analysis, we now want to get insights on possible response times to incidents, based on the distance from police stations. There are different ways to represent and explore distances in GIS, and we already explored one of them: buffers. You can create buffers that represent specific distances, and then use these buffers to count occurrences within the range.\n\n\n\n\n\n\nStop and Think\n\n\n\nCan you calculate the percentage of crime incidents in the dataset that happened within 1 km of a police station? Hint: Buffer and Count Points in Polygons should do the trick.\n\n\n\n\n\n\n\n\nClick for answer\n\n\n\n\n\nFirst select the police station point layer and go to Vector &gt; Geoprocessign &gt; Buffer to create the 1km buffers. Make sure you dissolve them, since your question is “within 1km of any station”, and there may be places where the buffers of nearby police stations overlap. Then use Count Points in Polygons to count how many crime incidents occurred within the buffer polygon. Check the count on the attribute table of the new layer, then divide this number by the total number of records in the crime incidence dataset. I got 423223 points in the buffer, which divided by 616835 crime incident records gives me 68.6%.\n\n\n\nBut now let’s say we want to know the average distance of a crime incident to the nearest police station. For this, we would need to know the exact distances for each point, and buffers won’t give us that. The tool we want in that case is Distance to the Nearest Hub (Points) tool, in the Processing panel.\n\nOpen the Distance to the Nearest Hub (Points) tool in the Processing panel. Then pick the crime incident layer as the Source Points Layer, and the police station layer as the Destination hubs layer. Pick FACNAME as the hub layer name attribute (the name of each police station), and Meters as the Distance unit, save it as crime_incidents_from_hubs.shp, then Run. It will take a while (after all, QGIS needs to look into each of the 616835 crimes one by one and determine which police station is nearest).\n\n\n\nNow open the attribute table of the new layer your created. It should have all the original attributes of the crime incident layer, plus two new attributes at the end: HubName and HubDist. You can then use the Summary Tool to find out the average for the HubDist attribute, and answer the question above (I got 749 meters).\n\n\n\n\n\n\n\nTip\n\n\n\nSince the name of the police station is also brought to the table, you could use Statistics by Category (Processing panel) to calculate the total or average number of nearest crime incidents per police station - that could give you insight in how overwhelmed some stations could be in relation to others. Or you could calculate the average distances to each hub, and have an idea of which police stations are being responsible for covering the largest distances.",
    "crumbs": [
      "Week 8 - Spatial analysis III",
      "<span class='chapter-number'>13</span>  <span class='chapter-title'>Lab 13 - Densities and distances</span>"
    ]
  },
  {
    "objectID": "lab_dist_dens.html#guided-exercise-6---distance-maps",
    "href": "lab_dist_dens.html#guided-exercise-6---distance-maps",
    "title": "13  Lab 13 - Densities and distances",
    "section": "13.6 Guided Exercise 6 - Distance Maps",
    "text": "13.6 Guided Exercise 6 - Distance Maps\nThere are times, however, when you want to create a distance map - a layer that shows how far every location is from some reference point(s). For example, if you were planning the location to install a new wind turbine, you may want to prioritise areas that are closer to a power line. In our crime example, maybe we want to identify regions in the city that are too far away from any police station - and therefore good candidates for creating a new one. The tool for that is called Proximity (raster distance) in QGIS. This tool however only works with rasters, so we need to convert our police stations into a raster first:\n\nGo to Raster &gt; Conversion &gt; Rasterize. Then pick the police stations as Input Layer, and 1 as a Fixed value to burn. Then pick Georeferenced Units for Output raster size units, pick 50 for both horizontal and vertical resolution (those would be meters), and set the Output Extent to match the neighbourhoods layer extent - click on the small down arrow, then pick Calculate from layer and select the neighbourhoods layer. This option determines how large your raster will be. Set the Output data type to Byte, and then save the result as raster_police_stations.tif. You will get a raster with a pixel value of 1 ‘burned in’ wherever a police station exists, and 0 (which is the default nodata option, so it will show as such) otherwise. You may need to zoom in to see the dots, but they are there.\n\n\n\nNow open the Proximity (raster distance) tool in the Processing panel, under Raster Analysis. Pick the rasterised police stations as the Input Layer, and add the number 1 as the List of pixel values.... option. Change the distance units to Georeferenced coordinates, leave the rest as default, and save the output as dist_from_police_Stations.tif and Run it.\n\n\n\nThe resulting layer is a raster map where the pixel values represent actual distances from a police station. Apply the Singleband Pseudocolor symbology with the Reds colour palette to it, and then overlay the neighbourhoods vector on it for reference.\n\n\n\nLet us assume that any area beyond 4km of a police station would be a good candidate for a new station. Use the Raster calculator to create a new layer showing only these areas, from the distance map you just created. Then polygonise the results and clip them by the neighbourhoods layer to create vector polygons of ‘Potential New Station Locations’. It should look like this:\n\n\nDone! This is the end of Lab 13. You now know how to create heatmaps and contour lines, and different tools to work with distances in GIS. In the next lab we will learn some additional distance-based tools, and then practice with an Independent Exercise.",
    "crumbs": [
      "Week 8 - Spatial analysis III",
      "<span class='chapter-number'>13</span>  <span class='chapter-title'>Lab 13 - Densities and distances</span>"
    ]
  },
  {
    "objectID": "lab_convex_interp.html",
    "href": "lab_convex_interp.html",
    "title": "14  Lab 14 - Convex Hulls and Interpolation",
    "section": "",
    "text": "14.1 Guided Exercise 1 - Preparing the data\nThis exercise will be based on actual research data collected by Dr. Adam Fell as part of their PhD research developed at University of Stirling.\nAdam has monitored the movement of bird species in Panama, to understand how land cover affects their movement and behaviour. He used GPS tracking tags attached via Teflon strings, like a backpack, to the back of the bird. The tags were programmed to measure locations from every 30 mins to every two hours during daytime (05:00 – 19:00), with bursts of every 30 mins if the batteries were fully charged. At night, the tags were scheduled to turn off to save battery energy, knowing that after dark, these species would not be active. Along with the GPS module, each tag also measured three-dimensional acceleration (ACC). Since ACC measurements consumed very little energy, the tags were programmed to take ACC measurements every 10 mins during a 24-hour period. These measurements confirmed little activity during night-time hours. Data was first stored on the device, then remotely downloaded through a radio link once a week to ensure that the device had not fallen off the individual.\nThe data consists of a Comma Separated Values (CSV) file containing the location, timestamp, and other information for each tracking tag, and can be downloaded here. The original data is hosted by the Movebank database, a global database of animal movement data.\nIn total, there are four bird species monitored:\nOrtalis cinereiceps (grey-headed Chachalaca): three individuals, identified in the individual_local_identifier field as Chachalaca_1 to _4.\nRamphastos swainsonii (Chestnut-mandibled Toucan): two individuals identified in the individual_local_identifier field as Chesnut_1 and _2.\nRamphastos sulfuratus (Keel-billed Toucan): two individuals identified in the individual_local_identifier field as Keel-billed_1 and _2.\nAmazona autumnalis (Red-lored parrot): one individual identified in the individual_local_identifier field as Parrot_1.\nThere is also a GeoTIFF raster with land cover data for the same region, obtained from the ESRI Living Atlas Sentinel-2 10m Global Land Cover dataset.",
    "crumbs": [
      "Week 8 - Spatial analysis III",
      "<span class='chapter-number'>14</span>  <span class='chapter-title'>Lab 14 - Convex Hulls and Interpolation</span>"
    ]
  },
  {
    "objectID": "lab_convex_interp.html#guided-exercise-1---preparing-the-data",
    "href": "lab_convex_interp.html#guided-exercise-1---preparing-the-data",
    "title": "14  Lab 14 - Convex Hulls and Interpolation",
    "section": "",
    "text": "By Kathy & Sam from Beaverton OR, USA CC BY 2.0\n\n\n\n\n\n\nchuck624 from Upstate NY, USA, CC BY 2.0\n\n\n\n\n\n\nChris Down, CC BY 2.0\n\n\n\n\n\n\nTomasz Wagner from Burnaby, BC, Canada, CC BY 2.0\n\n\n\n\n14.1.1 Preparing the data\n\nDownload the data and create a project folder and a new QGIS project.\nThen import the bird movement data using the Source Data Manager &gt; Delimited Text, like in the figure below. Make sure you pick the CRS indicated (EPSG:32617 WGS84 - UTM zone 17N), and that the timestamp field is of type Date & Time.\n\n\nThe file has both Latitude Longitude and Universal Transverse Mercator (UTM) coordinates, which are similar to British Grid coordinates, but for the entire world. UTM coordinates are ideal for field data that does not span large areas (you can read more about it here). We will use UTM coordinates since they are metric, and thus some automatic area calculations that will happen later on will have the right units.\n\nNow split the file into separate layers for each individual bird, saving each file as a separate geopackage (to preserve long field names) named as the individual_local_identifier tag (ex: Chachalaca_1.gpkg). Use Select by expression on the individual_local_identifierfield and then Export &gt; Save selected features as... to create each subset.\n\n\n\n\n\n\n\nStop and Think\n\n\n\nHow many records, covering what timespan, are available for each individual bird?\n\n\n\n\n\n\n\n\nClick for answer\n\n\n\n\n\nTo check it, you can use the Statistical Summary tool and the timestamp field you have created. Here are my calculations:\n\nChachalaca_1: 9731, 2022-01-14 to 2023-02-17\nChachalaca_2: 660, 2022-01-14 to 2022-03-19\nChachalaca_3: 2841, 2022-01-14 to 2023-02-17\nChachalaca_4: 3641, 2022-01-14 to 2023-02-18\nChesnut_1: 385, 2022-03-05 to 2023-02-17\nChensut_2: 296, 2022-03-18 to 2022-03-19\nKeel-billed_1: 311, 2022-01-15 to 2022-02-09\nKeel-billed_2: 1568, 2022-02-22 to 2023-02-18\nParrot_1: 41933, 2020-03-17 to 2022-04-18",
    "crumbs": [
      "Week 8 - Spatial analysis III",
      "<span class='chapter-number'>14</span>  <span class='chapter-title'>Lab 14 - Convex Hulls and Interpolation</span>"
    ]
  },
  {
    "objectID": "lab_convex_interp.html#guided-exercise-2---convex-hulls",
    "href": "lab_convex_interp.html#guided-exercise-2---convex-hulls",
    "title": "14  Lab 14 - Convex Hulls and Interpolation",
    "section": "14.2 Guided Exercise 2 - Convex Hulls",
    "text": "14.2 Guided Exercise 2 - Convex Hulls\nConvex hulls are a type of Minimum Enclosing Polygon. The best way to think of it is as if the points were pegs on a board, and you wrapped a stretch band around them. The convex hull is the shape with the smallest perimeter enclosing all points.\n\n\n\nhttps://en.wikipedia.org/wiki/Convex_hull\n\n\nIn animal and movement research, convex hulls are commonly to used to define species ranges or, for individuals, home ranges.\n\n\n\n\n\n\nImportant\n\n\n\nThere are two separate tools to calculate convex hulls in QGIS. The first is called Convex Hulls in Vector &gt; Geoprocessing, but is usually NOT what you want. This tools calculates convex hulls for irregular polygons. To calculate convex hulls for points, you instead want to go to the Processing tab and then choose the Minimum Bounding Geometry tool under the Vector Geometry category.\n\n\nFor this exercise, we will first focus on the Chachalaca birds. We will also not consider Chachalaca_2 since it was only monitored for two months.\nThe first question we may want to ask as animal movement researchers is if there are well-defined territories for the birds, and if these territories overlap (i.e. do the birds interact?).\n\n14.2.1 Calculating Convex Hulls\n\nGo to the Processing tab and then launch the Minimum Bounding Geometry tool under the Vector Geometry category.\n\n\n\nSelect the Chachalaca_1 layer as Input Layer, and then Convex Hull for the Geometry Type (click on the Help button to see what each type of geometry represents). Save the file as Chachalaca_1_home_range.shp.\nRepeat for Chachalaca_3 and Chachalaca_4.\nNow set the home range polygon symbologies to an outline that is the same colour as the original points with no fill (or a transparent fill), to evaluate the overlap in home ranges. Also add the ESRI Satellite Layer from the QuickMap Plugin for reference. Mine looks like this:\n\n\n\n\n\n\n\n\nStop and Think\n\n\n\nNow using the Geoprocessing tools you have learned, calculate the amount of percent overlap between each home range. Based on this, which individuals may be interacting with each other?\n\n\n\n\n\n\n\n\nClick for answer\n\n\n\n\n\nFirst you need to recalculate the areas in proper units. The Convex Hull tool calculates the area using the layer units, which for this dataset are degrees.\nYou can use the Intersection tool to find the overlap between home ranges. You need to calculate it two times for Chachalaca_1 x Chachalaca_3 and Chachalaca_1 x Chachalaca_4. You can see from the previous step that Chachalaca_3 and Chachalaca_4 do not overlap, so no need to calculate it.\nThe intersection polygons will have the area fields from both original layers (one of them renamed as area_2), and you can use the Field Calculator to calculate the area of the intersection.\n\nC1: 121393 m\\(^2\\)\nC3: 91856 m\\(^2\\)\nC4: 230018 m\\(^2\\)\nC1 x C3: 59654 m\\(^2\\) (49% of C1 and 65% of C3)\nC1 x C4: 2867 m\\(^2\\) (2.3% of C1 and 1.2% of C4)\n\nSo we can conclude that Chachalaca 1 and 3 interacted very often, Chachalaca 1 and 4 interacted more rarely, and Chachalaca 3 and 4 did not interact at all during the study.",
    "crumbs": [
      "Week 8 - Spatial analysis III",
      "<span class='chapter-number'>14</span>  <span class='chapter-title'>Lab 14 - Convex Hulls and Interpolation</span>"
    ]
  },
  {
    "objectID": "lab_convex_interp.html#guided-exercise-3---habitat-use",
    "href": "lab_convex_interp.html#guided-exercise-3---habitat-use",
    "title": "14  Lab 14 - Convex Hulls and Interpolation",
    "section": "14.3 Guided Exercise 3 - Habitat Use",
    "text": "14.3 Guided Exercise 3 - Habitat Use\nThe second question we may want to explore is what is the main types of habitats each bird is using. For that, we can use the convex hulls that determine our home rages, and the land cover layer included in the dataset. The data documentation includes a table with a key for each land cover type.\n\n\n\n\n\n\nStop and Think\n\n\n\nUsing the tools you already know, determine which habitats comprise each Chachalaca home range, and their respective area.\n\n\n\n\n\n\n\n\nClick for answer\n\n\n\n\n\nWe have the home ranges as polygons, and the land cover dataset as a raster. There are thus two ways of achieving this. One is to Polygonize the raster, and then use Clip to cut the resulting vector land cover map by each of the home ranges, and then recalculate the areas of each habitat using the Field Calculator. The second is to cut the raster by each of the home ranges using Extract by Mask Layer, and then use Raster Layer Unique Values Report in the Processing panel. These are the values I got using the second option (less steps):\nChachalaca 1: Class 7 (Built Area) = 106800m\\(^2\\); Class 2 (Trees) = 14400m\\(^2\\)\nChachalaca 3: Class 7 (Built Area) = 85900m\\(^2\\); Class 11 (Rangeland) = 6200m\\(^2\\)\nChachalaca 4: Class 2 (Trees) = 151600m\\(^2\\); Class 7 (Built Area) = 79900m\\(^2\\)\nSo we can see that while Chachalaca 1 and 3 have decided to explore mainly urban habitats, Chachalaca 4 is mainly exploring the forest habitat, indicating possible behavioural adaptations and/or territoriality.\n\n\n\n\n14.3.1 Guided Exercise 4 - Creating temporal animations with QGIS\nQGIS includes a feature called Temporal Layers, which allow us to animate the layers follwing time stamp information, to see how patterns change over time. We will use it now to look at the Chachalaca movement in time.\n\nFirst, select the Chachalaca_1 point layer and go to Properties &gt; Temporal. Then check the Dynamic Temporal Control box, and select Single Field with Date/Time as the Configurations, and Include Start, Include End as Limit. Then pick the timestamp field for Field, and set the event duration to 30 minutes (the minimum duration as per our metada). Click in Apply, then OK. A clock symbol will appear to the right of the layer name to indicate it is time-enabled.\n\n\n\nNow repeat the process for Chachalaca_3 and Chachalaca_4.\nNow launch the Temporal Controller Panel () from the main QGIS toolbar. It will look like the panel below. If it looks different, make sure you click on the Animated Temporal Navigation button (small green play button within a circle).\n\n\n\nThen calculate the time range for all time-enabled layers by clicking on the button with two blue arrows. Set the Step to 1 hour, and then press the back play button. You will see Chachalaca_1 and Chachalaca_3 at first (remember there is no recording during the night, so there will be some periods with no points).\nNow pause the animation, click on the double back-arrow to return to the start, and then change the Step to 1 day. Notice how even though Chachalaca 1 and 3 have a lot of overlap in their home ranges, on a daily basis they tend to mostly stay away from each other, seldom crossing paths. Also notice how Chachalaca 4 really tends to keep within the trees, rarely venturing into open areas.\nNow pause and reset again, and then set the Step to One week. Notice how Chachalaca 4 tends to avoid crossing the big open patch that divides its home range, and only some times ventures into the northern area.\nPause and reset the animation again. Then launch the Windows Snipping Tool by going to the Start Menu and then typing its name (see here for Mac).\n\nIt will look lime this:\n\n\nRead this entire section before doing it. Change the snip type from image (photo camera) to video (video camera), Then click on New. Drag the mouse to capture the mao area of QGIS, and then click on Start Recording. There will be a countdown from 3, and then the recording will start. Once it starts, press the play button in QGIS to start the animation, and let it run through. Then stop the recording.\n\nYou should now have a video recording that could be used on a presentation! Here is mine (press the play button!)\n\nYou could also use the Export Animation function of QGIS by clicking on the Disk icon of the Temporal Controller. What it does however is it saves each animation frame as one separate image, which you need to combine into a video later using video creation software, or as an animated GIF using an online tool such as EZGIF:",
    "crumbs": [
      "Week 8 - Spatial analysis III",
      "<span class='chapter-number'>14</span>  <span class='chapter-title'>Lab 14 - Convex Hulls and Interpolation</span>"
    ]
  },
  {
    "objectID": "sec_w10_gnss.html",
    "href": "sec_w10_gnss.html",
    "title": "Week 10 - Obtaining spatial data in the field",
    "section": "",
    "text": "ILOs covered",
    "crumbs": [
      "Week 10 - Obtaining spatial data in the field"
    ]
  },
  {
    "objectID": "sec_w10_gnss.html#ilos-covered",
    "href": "sec_w10_gnss.html#ilos-covered",
    "title": "Week 10 - Obtaining spatial data in the field",
    "section": "",
    "text": "Obtain and assess the quality of spatial data from online and offline sources and produce new spatial data using computer and field methods;\nPlan and execute GIS analytical steps to solve spatial problems successfully;",
    "crumbs": [
      "Week 10 - Obtaining spatial data in the field"
    ]
  },
  {
    "objectID": "sec_w10_gnss.html#what-will-you-learn",
    "href": "sec_w10_gnss.html#what-will-you-learn",
    "title": "Week 10 - Obtaining spatial data in the field",
    "section": "What will you learn",
    "text": "What will you learn\nFor every week, we will list the main theoretical and practical learning goals. Use these as a ‘checklist’ to gauge your learning for each week. If you don’t feel confident you have learned any specific topic, then revisit the week’s material!\n\nTheoretical knowledge for Week 1:\n\n\nPractical knowledge:\n10  Lab 10: Geoprocessing tools\n11  Lab 11 - Data Joins",
    "crumbs": [
      "Week 10 - Obtaining spatial data in the field"
    ]
  }
]