<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.554">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>GEOU9SP GIS Workbook - 3&nbsp; Lab 3: Working with vector attributes</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./lab_vectors_2.html" rel="next">
<link href="./sec_w2_vectors.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./sec_w2_vectors.html">Week 2 - Vector data</a></li><li class="breadcrumb-item"><a href="./lab_vectors_1.html"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Lab 3: Working with vector attributes</span></a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">GEOU9SP GIS Workbook</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Welcome!</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./sec_w1_intro_toGIS.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Week 1 - Introduction</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lab_intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Lab 1: QGIS overview and file management</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lab_crs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Lab 2: Coordinate Reference Systems</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./sec_w2_vectors.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Week 2 - Vector data</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lab_vectors_1.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Lab 3: Working with vector attributes</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lab_vectors_2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Lab 4: Working with vector geometries</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./sec_w3_rasters.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Week 3 - Raster data</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lab_rasters_1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Lab 5: Working with raster data</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lab_rasters_2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Lab 6: The raster calculator and other rastery bits</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <span class="sidebar-item-text sidebar-link text-start">
 <span class="menu-text">Week 4 - Making maps</span></span>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./sec_w5_spatial_analysis_I.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Week 5 - Spatial analysis I</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lab_geoprocessing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Lab 9: Geoprocessing tools</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <span class="sidebar-item-text sidebar-link text-start">
 <span class="menu-text">Week 6 - Spatial analysis II</span></span>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <span class="sidebar-item-text sidebar-link text-start">
 <span class="menu-text">Week 8 - Spatial analysis III</span></span>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <span class="sidebar-item-text sidebar-link text-start">
 <span class="menu-text">Week 10 - Obtaining spatial data in the field</span></span>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#before-you-start" id="toc-before-you-start" class="nav-link active" data-scroll-target="#before-you-start"><span class="header-section-number">3.1</span> Before you start!</a></li>
  <li><a href="#guided-exercise-1---basic-work-with-vector-data" id="toc-guided-exercise-1---basic-work-with-vector-data" class="nav-link" data-scroll-target="#guided-exercise-1---basic-work-with-vector-data"><span class="header-section-number">3.2</span> Guided Exercise 1 - Basic work with Vector Data</a></li>
  <li><a href="#guided-exercise-2-visualising-layer-attributes" id="toc-guided-exercise-2-visualising-layer-attributes" class="nav-link" data-scroll-target="#guided-exercise-2-visualising-layer-attributes"><span class="header-section-number">3.3</span> Guided Exercise 2: Visualising layer attributes</a></li>
  <li><a href="#guided-exercise-3-selections-based-on-layer-attributes" id="toc-guided-exercise-3-selections-based-on-layer-attributes" class="nav-link" data-scroll-target="#guided-exercise-3-selections-based-on-layer-attributes"><span class="header-section-number">3.4</span> Guided Exercise 3: Selections based on layer attributes</a></li>
  <li><a href="#guided-exercise-3-summarising-layer-attributes" id="toc-guided-exercise-3-summarising-layer-attributes" class="nav-link" data-scroll-target="#guided-exercise-3-summarising-layer-attributes"><span class="header-section-number">3.5</span> Guided Exercise 3: Summarising layer attributes</a></li>
  <li><a href="#guided-exercise-4-calculating-new-attributes" id="toc-guided-exercise-4-calculating-new-attributes" class="nav-link" data-scroll-target="#guided-exercise-4-calculating-new-attributes"><span class="header-section-number">3.6</span> Guided Exercise 4: Calculating new attributes</a></li>
  <li><a href="#independent-exercise" id="toc-independent-exercise" class="nav-link" data-scroll-target="#independent-exercise"><span class="header-section-number">3.7</span> Independent Exercise</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./sec_w2_vectors.html">Week 2 - Vector data</a></li><li class="breadcrumb-item"><a href="./lab_vectors_1.html"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Lab 3: Working with vector attributes</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span id="sec-labvec1" class="quarto-section-identifier"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Lab 3: Working with vector attributes</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>Vector data consists of discrete observations called features. For example, on a vector layer representing all protected areas in Scotland, each individual protected area would comprise a feature. With regular data, observations are just rows on a table, but with vector spatial data, features are composed of two elements: the geometry (the visual component + coordinates) and attributes (columns on a table holding data about each feature, also known as <em>fields</em>).</p>
<p>On the figure below, each country is a feature - the shape of the country is represented by the geometry (left) and the corresponding <em>attributes</em> are shown in the right. Notice that both the geometry and the corresponding attributes of one specific feature (Brazil) are <em>selected</em>. Selections are a very important component of GIS analysis, as they can narrow down the targets for your calculations.</p>
<p><img src="images/lab_3/lab3_fig1_geometries+attributes.jpg" class="img-fluid"></p>
<p>For this lab, we will focus mainly on the following GIS operations: filtering attributes, summarising attributes, and creating and modifying attribute data. Remember to apply, from here on, all the steps you have already learned in previous labs: create a project folder, organize your data, save a named project with proper CRS info, etc. Each week’s labs will build upon the previous activities, so I will not be repeating instructions for things covered in previous sessions.</p>
<section id="before-you-start" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="before-you-start"><span class="header-section-number">3.1</span> Before you start!</h2>
<ol type="1">
<li>Go through the Week 2 preparatory session on Canvas, and watch the seminar recording if you have missed it.</li>
</ol>
</section>
<section id="guided-exercise-1---basic-work-with-vector-data" class="level2" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="guided-exercise-1---basic-work-with-vector-data"><span class="header-section-number">3.2</span> Guided Exercise 1 - Basic work with Vector Data</h2>
<p>In this exercise, you will learn how to open and read vector data.</p>
<ol class="example" type="1">
<li><p><a href="https://stir-my.sharepoint.com/:f:/g/personal/ala2_stir_ac_uk/EkD-gndA8ihElmcQFirYbPEBN6qvH2tzyLgJ8UujpCXi2Q?e=tsvmoG">Download the data for this exercise from here</a>, then extract the zip files (make sure all the data are unzipped! Sometimes you have zipfiles inside zipfiles…) and organise them to your preference (use a similar folder structure as from week 1).</p></li>
<li><p>Load all three datasets in QGIS and inspect them. The file names are: <code>global_earthquakes_2011.gpkg</code>, <code>MajorRivers.shp</code>, and <code>ne_50m_admin_0_countries.shp</code>.</p></li>
</ol>
<div class="callout callout-style-default callout-important callout-titled" title="Stop and Think">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Stop and Think
</div>
</div>
<div class="callout-body-container callout-body">
<ol type="a">
<li><p>What are the datasets you have?</p></li>
<li><p>What are the <em>data models</em> used by these datasets?</p></li>
<li><p>What are the <em>file formats</em> you have to work with?</p></li>
<li><p>Which of these files contain <em>metadata</em> about your datasets?</p></li>
<li><p>What is the <em>CRS</em> of each data layer you have?</p></li>
</ol>
</div>
</div>
<div class="callout callout-style-simple callout-important no-icon callout-titled" title="Click for answer">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click for answer
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ol type="a">
<li><p>You can use the file names, the metadata, and the visual appearance of the layers to answer data. The <code>global_earthquakes_2011.gpkg</code> file seems to hold point data on recorded Earthquake locations in the year 2011. The <code>MajorRivers.shp</code> layer seems to hold line data on the world’s largest rivers. The <code>ne_50m_admin_0_countries.shp</code> seems to have boundaries for the world countries.</p></li>
<li><p>All three files use the <em>vector</em> data model, being a point vector, line vector and polygon vector respectively.</p></li>
<li><p>The earthquakes layer is given in the <a href="https://www.geopackage.org/">geopackage</a> file format, while the other two layers are given in the <a href="https://doc.arcgis.com/en/arcgis-online/reference/shapefiles.htm">shapefile</a> file format. Notice that data model and file format are two different things, and they don’t necessarily imply each other. Geopackages, for example, can hold both <em>vector</em> and <em>raster</em> data.</p></li>
<li><p>The rivers layer has a plain text metadata file with a link that points to the source of the data, where more information can be found. The countries layer has an HTML file that holds metadata about the file. The earthquakes data has no metadata.</p></li>
<li><p>All three layers are using EPSG 4236 (WGS84 ‘unprojected’) as CRS. You check it by right clicking on the layer name and selecting <code>Layer CRS</code>, or by selecting <code>Properties &gt; Information</code>.</p></li>
</ol>
</div>
</div>
</div>
<ol start="3" class="example" type="1">
<li><p>Check your Project properties to make sure they are correct (does the project CRS match the layers? What are the measurement units set for this project? Have you set the base folder?). Then save your project file within your folder structure as in previous labs.</p></li>
<li><p>Now inspect the <em>attribute table</em> for each layer, by right-clicking on each layer name and then on <code>Open Attribute Table</code>. Then answer the following questions:</p></li>
</ol>
<div class="callout callout-style-default callout-important callout-titled" title="Stop and Think">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Stop and Think
</div>
</div>
<div class="callout-body-container callout-body">
<ol type="a">
<li><p>How many <em>features</em> does each layer have?</p></li>
<li><p>How many <em>attributes</em> does each feature have?</p></li>
</ol>
<p>Tip: if you go to <code>Properties &gt; Fields</code>, you get a list of all attributes ordered by ID, which is a sequential number. That makes it easier to count attributes when there are many.</p>
</div>
</div>
<div class="callout callout-style-simple callout-important no-icon callout-titled" title="Click for answer">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-4-contents" aria-controls="callout-4" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click for answer
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-4" class="callout-4-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ol type="a">
<li><p>Earthquakes: 15272; Rivers: 98; Countries: 241.</p></li>
<li><p>Earthquakes: 5 (fid, Event, latitude, longitude, Magnitude, Date); Rivers: 4 (NAME, SYSTEM, MILES, KILOMETERS); Countries: 94 (featurecla, scalerank, etc…).</p></li>
</ol>
<p>If you looked at <code>Properties &gt; Fields</code>, the last ID is 93, but the first one is 0, so 94 in total.</p>
</div>
</div>
</div>
<ol start="5" class="example" type="1">
<li><p>Rename your layers on the layer list to human-readable, informative names, then save your project. Remember, these new names will appear within this project only, the name of the source files in your folders will not change.</p></li>
<li><p>Organize the layer order and play with different layer superpositions to make the most readable visualisation for all datasets involved. Then experiment with the symbology of each layer to improve your visualization.</p></li>
</ol>
</section>
<section id="guided-exercise-2-visualising-layer-attributes" class="level2" data-number="3.3">
<h2 data-number="3.3" class="anchored" data-anchor-id="guided-exercise-2-visualising-layer-attributes"><span class="header-section-number">3.3</span> Guided Exercise 2: Visualising layer attributes</h2>
<p>One of the main applications of vector data is the ability to <em>select</em> and then <em>summarise</em> the different attributes of each layer to extract relevant information.</p>
<ol start="7" class="example" type="1">
<li><p>Turn off the “Rivers” and “Earthquakes” layers. (Tip: to turn multiple layers off or on at once, highlight all the layers you need to make hidden (or visible) by holding down the <code>Control</code> key of your keyboard while you click, then hit the spacebar on your keyboard).</p></li>
<li><p>Go to <code>Layer Properties &gt; Symbology</code> for the World Countries layer, and change the top option from <code>Single Symbol</code> to <code>Categorized</code>. This lets you assign different colours based on attribute values. We will colour the countries based on the main region where they are. So for <code>Value</code>, choose the <code>REGION_UN</code> attribute. Leave the <code>Symbol</code> option as is, and for <code>Color Ramp</code>, select <code>Random Colors</code> if not already. Then click on the <code>Classify</code> button on the bottom left of the large white space in the middle of the window. Then click on <code>OK</code>.</p></li>
<li><p>Look at your layer and notice how it has been styled. Try to manually change the colours of each region to your liking.</p></li>
</ol>
<p>Now lets use visualisation to understand the distribution of world population.</p>
<ol start="10" class="example" type="1">
<li><p>Return to the <code>Symbology</code> window and select <code>Graduated</code> instead of <code>Categorized</code>. Change your <code>Value</code> to the <code>POP_EST</code> attribute. Choose <code>Magma</code> as your colour ramp (click on the little arrow to the right), and select the <code>Invert Color Ramp</code> option.</p></li>
<li><p>Change the classification <code>Mode</code> (above the classify button) to <code>Equal interval</code>, leave the number of <code>Classes</code> as 5 (to the left of <code>Mode</code>), and then click on <code>Classify</code>, then <code>OK</code>.</p></li>
</ol>
<div class="callout callout-style-default callout-important callout-titled" title="Stop and Think">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Stop and Think
</div>
</div>
<div class="callout-body-container callout-body">
<ol type="a">
<li><p>What is the difference between the <code>Categorized</code> and <code>Graduated</code> options?</p></li>
<li><p>Does the <code>Equal Interval</code> classification give a good visualization of the distribution of world population?</p></li>
</ol>
</div>
</div>
<div class="callout callout-style-simple callout-important no-icon callout-titled" title="Click for answer">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-6-contents" aria-controls="callout-6" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click for answer
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-6" class="callout-6-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ol type="a">
<li><p><code>Categorized</code> is for <em>categorical</em>, non-numeric variables (i.e.&nbsp;names, classes, etc.). <code>Graduated</code> is for <em>continuous</em> variables (i.e.&nbsp;quantities, measurements).</p></li>
<li><p>No, because China, India and to a lesser extent the US have much numbers than the rest, which biases the breakpoints. We will fix it in the next step.</p></li>
</ol>
</div>
</div>
</div>
<ol start="12" class="example" type="1">
<li>Return to the <code>Symbology</code> window, and change the <code>Mode</code> from <code>Equal Interval</code> to <code>Natural Breaks (Jenks)</code>, and increase the number of <code>Classes</code> to 10. Click on <code>OK</code>.</li>
</ol>
<p>When you are mapping your own data, make sure you explore the different methods for calculating breakpoints, and also play with the number of classes. You can see the ful explanation of each <code>Mode</code> on the <a href="https://docs.qgis.org/3.34/en/docs/user_manual/working_with_vector/vector_properties.html#graduated-renderer">QGIS Documentation</a>.</p>
</section>
<section id="guided-exercise-3-selections-based-on-layer-attributes" class="level2" data-number="3.4">
<h2 data-number="3.4" class="anchored" data-anchor-id="guided-exercise-3-selections-based-on-layer-attributes"><span class="header-section-number">3.4</span> Guided Exercise 3: Selections based on layer attributes</h2>
<p>Now we will look into using <em>expressions</em> to search and select specific features according to their attributes. As GIS vector data emerged from the database world, these searches as sometimes refered to as <em>queries</em>.</p>
<ol start="13" class="example" type="1">
<li><p>Change the symbology of the Countries layer to <code>Single Symbol</code>, and pick a dark gray. Then turn on the Rivers layer, change its symbology to a light blue, and make sure it is on top of the Countries layer.</p></li>
<li><p>Open the Rivers layer attribute table (right click on its name then on <code>Open attribute table</code>). Then click on the <code>Select features using expression</code> button (<img src="https://docs.qgis.org/3.34/en/_images/mIconExpressionSelect.png" class="img-fluid">). You will see a new window with three panels, like the one below. If you only see two panels, then click on <code>Show help</code>:</p></li>
</ol>
<p><img src="images/lab_3/lab3_fig2_select_feat_exp.jpg" class="img-fluid"></p>
<p>You will encounter this expression window in other parts of QGIS as well. The way it works is that you type your expression on the left window, using the middle and right panels to browse and select operators to add to your expression. It will make more sense with an example:</p>
<ol start="15" class="example" type="1">
<li><p>In the middle panel, expand the <code>Fields and Values</code> item and then double click on <code>KILOMETERS</code>. It will add this attribute name to the left panel. Notice that it is enclosed by double quotes. In the expression window, <strong>any word between double quotes means it is an attribute’s name</strong>. You can also type names directly in the window if you prefer, and QGIS will offer autocomplete suggestions based on the existing attributes.</p></li>
<li><p>Now complete the expression by typing the remainder, so that the final expression is <code>"KILOMETERS" &gt; 5000</code>. This expression means “Select all River features that have a length - represented by the KILOMETERS attribute - larger than 5000”. Then click on the <code>Select features</code> button.</p></li>
<li><p>Check the results of your selection on the Attribute Table. The number of selected features should be shown on the top of the window (11), and selected features will be highlighted in blue. On the bottom left of the window, you can change from <code>Show all features</code> to <code>Show selected features</code> if you only want to see the selected features.</p></li>
<li><p>Also check the results of your selection on the Map canvas. All selected features will be highlighted in yellow. Tip: if you ever set the symbology of a feature yellow, remember to not confuse it with selected objects. When in doubt, check the attribute table.</p></li>
</ol>
<div class="callout callout-style-default callout-important callout-titled" title="Stop and Think">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Stop and Think
</div>
</div>
<div class="callout-body-container callout-body">
<p>It seems the selection is missing a few of the longest rivers in the world, such as the Amazon River. Why would that be?</p>
<p>Hint: try to use the manual selection tool (<img src="https://docs.qgis.org/3.34/en/_images/mActionSelectRectangle.png" class="img-fluid">) to click on the Amazon River and investigate.</p>
</div>
</div>
<div class="callout callout-style-simple callout-important no-icon callout-titled" title="Click for answer">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-8-contents" aria-controls="callout-8" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click for answer
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-8" class="callout-8-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>The different segments of the Amazon River officially receive different names: Amazonas (lower Amazon), Solimões (central Amazon) and Ucayali (upper Amazon). In this dataset, it is broken down into two features: Amazon (with 3042 km) and Ucayali (with 2088 km). Since these are two separate features, neither is selected by our expression.</p>
</div>
</div>
</div>
<ol start="19" class="example" type="1">
<li>Return to the attribute table and make sure that the rivers larger than 5000km are still selected. Then create a new expression: <code>SYSTEM" = 'Amazon'</code>. Notice that we enclose the word Amazon with single quotes. This identifies this as a <em>string</em>, i.e.&nbsp;a character value, and differentiates it from an attribute name. Then instead of clicking on <code>Select Features</code>, click on the small arrow to the right and click in <code>Add to Current Selection</code>. Now your selection should include all river features that are longer than 5000 km <em>or</em> belong to the Amazon system (26 features in total).</li>
</ol>
<p>Tip: If you can’t remember all the possible values of an attribute, select the attribute under <code>Fields and Values</code> and then on the right panel, double click on <code>All Unique</code>. QGIS will list all possible value options for that particular attribute.</p>
<ol start="20" class="example" type="1">
<li>Now deselect all features by clicking on the <code>Deselect</code> button in the Attribute Table (<img src="https://docs.qgis.org/3.34/en/_images/mActionDeselectActiveLayer.png" class="img-fluid">) or the <code>Deselect from all layers</code> button in the main QGIS toolbar (<img src="https://docs.qgis.org/3.34/en/_images/mActionDeselectAll.png" class="img-fluid">). It is always good to clear selections when you are done with a certain analysis, to avoid unexpected consequences.</li>
</ol>
<p>We can use several operators to create expressions. For numeric values, we can use all logical operators: ‘greater than’ (<code>&gt;</code>), ‘lesser than’ (<code>&lt;</code>), their ‘or equal’ variants (<code>&lt;=</code>, <code>&gt;=</code>) as well as ‘equal’ (<code>=</code>) or ‘not equal’ (<code>&lt;&gt;</code>). For strings (text), <code>=</code> and <code>&lt;&gt;</code> also work, but you can use the operators <code>IS</code> and <code>IS NOT</code> (all upper case) instead. In the example above, we could have used <code>"SYSTEM" IS 'Amazon'</code> to get the same result.</p>
<p>Another class of useful operators are called <em>Boolean</em> operators: <code>AND</code>, <code>OR</code> and <code>NOT</code>. They allow us to create compound expressions with multiple criteria:</p>
<ol start="21" class="example" type="1">
<li><p>Return to the attribute table and this time use the following expression: <code>"KILOMETERS" &gt; 5000 OR "SYSTEM" = 'Amazon'</code>. You should get the same results as when you used two separate selections with <code>Add to Current Selection</code>. But boolean operators can be more powerful.</p></li>
<li><p>Clear your selection and create a new one with the expression <code>"KILOMETERS" &gt; 1000 AND "SYSTEM" = 'Amazon'</code>. When you use the <code>AND</code> operator, each feature must fulfil <em>both</em> criteria (like an intersection in set theory, if you remember your maths). When you use the <code>OR</code> keyword, then each feature can fulfil <em>either</em> criteria (a mathematical <em>union</em>).</p></li>
<li><p>Now change the expression to <code>"KILOMETERS" &gt; 1000 AND "SYSTEM" IS NOT 'Amazon'</code> and see what you get. Do you understand the effect of using the <code>NOT</code>operator?</p></li>
</ol>
<p>Finally, we have two useful operators for <em>partial matching</em> on strings. They are useful when you need to select based on a subset of string (word) values of an attribute:</p>
<ol start="24" class="example" type="1">
<li><p>Clear your selection and create a new one with the expression <code>"NAME" LIKE 'Am%'</code>. This should select all three rivers whose name starts with ‘Am’ (Amazon, Amu Darya and Amur). The ‘%’ symbol in this case is what we call a ‘wildcard’, and it means ‘anything else’.</p></li>
<li><p>Now use the expression <code>"NAME" LIKE 'C____'</code> (four underscores, ’_‘). This should select all rivers whose name starts with ’C’ followed by any four characters (So it picks Congo and Chire).</p></li>
</ol>
<div class="callout callout-style-default callout-important callout-titled" title="Stop and Think">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Stop and Think
</div>
</div>
<div class="callout-body-container callout-body">
<p>How many rivers would you get if you changed the above expression to <code>"NAME" LIKE 'C%'</code>?</p>
</div>
</div>
<div class="callout callout-style-simple callout-important no-icon callout-titled" title="Click for answer">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-10-contents" aria-controls="callout-10" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click for answer
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-10" class="callout-10-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Four (Columbia, Colorado, Congo, Chire). When you use the ‘%’ wildcard it means ‘any amount of any character’.</p>
</div>
</div>
</div>
<ol start="26" class="example" type="1">
<li>Finally, create a selection with the expression <code>"NAME" LIKE 'AM%'</code> (notice the uppercase). You won’t get any results. Then change the expression to <code>"NAME" ILIKE 'AM%'</code>. You should get the same three rivers starting with ‘Am’ again.</li>
</ol>
<div class="callout callout-style-default callout-important callout-titled" title="Stop and Think">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Stop and Think
</div>
</div>
<div class="callout-body-container callout-body">
<p>What is the difference between <code>LIKE</code> and <code>ILIKE</code>?</p>
</div>
</div>
<div class="callout callout-style-simple callout-important no-icon callout-titled" title="Click for answer">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-12-contents" aria-controls="callout-12" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click for answer
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-12" class="callout-12-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>The <code>LIKE</code> operator is case sensitive, while <code>ILIKE</code> is case insensitive.</p>
</div>
</div>
</div>
<ol start="27" class="example" type="1">
<li>Before you move on to the next exercise, make sure you clear your selection.</li>
</ol>
</section>
<section id="guided-exercise-3-summarising-layer-attributes" class="level2" data-number="3.5">
<h2 data-number="3.5" class="anchored" data-anchor-id="guided-exercise-3-summarising-layer-attributes"><span class="header-section-number">3.5</span> Guided Exercise 3: Summarising layer attributes</h2>
<p>The <code>Statisitcal Summary Tool</code> (<img src="https://docs.qgis.org/3.34/en/_images/mActionSum.png" class="img-fluid">) is a quick way to summarise attribute values, and can be quite powerful when combined with attribute selections.</p>
<ol start="28" class="example" type="1">
<li>On the main QGIS window, click on the <code>Statistical Summary</code> tool button. A new panel will open on the bottom left corner of the QGIS window.</li>
</ol>
<p><img src="images/lab_3/lab3_fig4_summ_panel.jpg" class="img-fluid"></p>
<ol start="29" class="example" type="1">
<li>Select the “Rivers” layer as input, then select the <code>KILOMETERS</code> attribute on the drop-down menu. You will get a table with several summary statistics calculated for all features in the layer.</li>
</ol>
<div class="callout callout-style-default callout-important callout-titled" title="Stop and Think">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Stop and Think
</div>
</div>
<div class="callout-body-container callout-body">
<p>What are the longest, shortest, and mean kilometre lengths in the dataset?</p>
</div>
</div>
<div class="callout callout-style-simple callout-important no-icon callout-titled" title="Click for answer">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-14-contents" aria-controls="callout-14" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click for answer
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-14" class="callout-14-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Max: 9207.1 km; Min: 194.9 km; Mean: 2663.6 km</p>
</div>
</div>
</div>
<ol start="30" class="example" type="1">
<li><p>Now repeat the attribute selection you did before using the expression <code>"KILOMETERS" &gt; 5000</code>, and then return to the <code>Statistical Summary</code> panel. Then check the <code>Selected Features Only</code> box at the bottom of the window. Now the stats will be re-calculated for the selected features only.</p></li>
<li><p>The <code>Statistical Summary</code> panel is smart enough to know how to summarise different <em>data types</em>. For example, select the <code>SYSTEM</code> attribute, and see how the stats change - now it gives you how many features in total (<code>Count</code>), how many unique values (<code>Count(Distinct)</code>), how many missing values (<code>Count(Missing)</code>), the <code>Minimum</code> and <code>Maximum</code> string values (they don’t have a clear meaning here), the least (<code>Minority</code>) and most (<code>Majority</code>) common unique values, and the <code>Minimum length</code> and <code>Maximum length</code> in number of characters.</p></li>
</ol>
<div class="callout callout-style-default callout-important callout-titled" title="Stop and Think">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Stop and Think
</div>
</div>
<div class="callout-body-container callout-body">
<p>Why do you get a blank value for <code>Majority</code> and a 0 for <code>Minimum Lenght</code>?</p>
</div>
</div>
<div class="callout callout-style-simple callout-important no-icon callout-titled" title="Click for answer">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-16-contents" aria-controls="callout-16" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click for answer
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-16" class="callout-16-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>For the rivers dataset, <code>Majority</code> is blank and <code>Minimum length</code> is 0 because we have several <code>NULL</code> (missing) values. They have zero length, and they are in fact the most common unique value.</p>
</div>
</div>
</div>
</section>
<section id="guided-exercise-4-calculating-new-attributes" class="level2" data-number="3.6">
<h2 data-number="3.6" class="anchored" data-anchor-id="guided-exercise-4-calculating-new-attributes"><span class="header-section-number">3.6</span> Guided Exercise 4: Calculating new attributes</h2>
<p>Another powerful way to derive information from vector attributes is to make calculations involving multiple attributes. For that, we can use the <code>Field Calculator</code> tool (<img src="https://docs.qgis.org/3.34/en/_images/mActionCalculateField.png" class="img-fluid">), accessible either from the <code>Attribute table</code> or the main QGIS toolbar.</p>
<ol start="32" class="example" type="1">
<li><p>Before your start, make sure you clear your selections.</p></li>
<li><p>Go back to the Attribute Table window for the Rivers layer and click on the Field Calculator button to open it. It should look like this:</p></li>
</ol>
<p><img src="images/lab_3/lab3_fig3_field_calculator.jpg" class="img-fluid"></p>
<ol start="34" class="example" type="1">
<li><p>On the new window, make sure the <code>Only update selected features</code> option is <strong>not</strong> checked. Then name the new field <code>Mi_to_Km</code>, and change the output <em>data type</em> to <code>Decimal Number</code>. <code>Output field length</code> tells you the maximum number of digits that can be stored per attribute value, and the <code>Precision</code> field tells you how many of these digits should be decimal places.</p></li>
<li><p>On the expression window, write <code>"MILES" / "KILOMETERS"</code>. Note the warning at the bottom. Now click on <code>OK</code>.</p></li>
<li><p>Now <strong>turn off editing mode</strong> by clicking on the Toggle Editing (<img src="https://docs.qgis.org/3.34/en/_images/mActionToggleEditing.png" class="img-fluid">) button in the Attribute Table. When asked, confirm you want to save the layer changes.</p></li>
</ol>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p>Turning on editing mode is one of the <strong>most dangerous</strong> options in QGIS, as it lets you freely change both the geometry and the attribute values of a layer. Using the <code>Field calculator</code> automatically puts you on editing mode, so always make sure you turn it off immediately after you have finished a calculation. Once you make any changes and then save the changes, <em>there is no turning back</em>. I’ll often first export a copy of the layer if I need to do any edits, so I aways have the original as a backup if something goes wrong. We’ll revisit editing mode on week 4, when we learn how to digitise and edit geometries by hand.</p>
</div>
</div>
<div class="callout callout-style-default callout-important callout-titled" title="Stop and Think">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Stop and Think
</div>
</div>
<div class="callout-body-container callout-body">
<p>Does the Miles to Km proportion you calculated seem right?</p>
</div>
</div>
<div class="callout callout-style-simple callout-important no-icon callout-titled" title="Click for answer">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-19-contents" aria-controls="callout-19" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Click for answer
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-19" class="callout-19-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Yes, 1 Mile = 1.609 kilometres.</p>
</div>
</div>
</div>
<ol start="37" class="example" type="1">
<li>This new attribute you calculated is not very useful. Let us get rid of it. Put the attribute table back into editing mode, then click on the <code>Delete Field</code> button (<img src="https://docs.qgis.org/3.34/en/_images/mActionDeleteAttribute.png" class="img-fluid">), and select your <code>Mi_to_Km</code> field. Click <code>OK</code>. It’s gone! Remember to save the changes and exit edit mode.</li>
</ol>
<p>Tip: if you want to rename an attribute, create a new one with the new name and just use the name of the old one as the expression on the <code>Field Calculator</code>. It will copy all values to the new attribute. Then remove the old one.</p>
<ol start="38" class="example" type="1">
<li>We will continue working with this data in the next lab. If you want to keeo your project, this is the best way to do it: on your computer’s file explorer, find the root folder for the project (<code>lab_3</code>, or whatever you have named it as). Then right click on it and select (on Windows) <code>Compress to Zip file</code>. That will create a new zipfile of the folder contents, with the same name as the folder. Then you can copy this zip file to your OneDrive folder or to an external drive.</li>
</ol>
<p>Good job, we have now finished our first guided tour of vector attributes. We will revisit it in the next lab, when we also learn about geometry-based selections.</p>
<p>Make sure you have a go at the independent exercise below, to make sure you feel comfortable with attribute selections, calculations and summaries. You will keep using these skills for the rest of the module (and your GIS life).</p>
</section>
<section id="independent-exercise" class="level2" data-number="3.7">
<h2 data-number="3.7" class="anchored" data-anchor-id="independent-exercise"><span class="header-section-number">3.7</span> Independent Exercise</h2>
<p>Using the earthquakes layer you downloaded (<code>global_earthquakes_2011.gpkg</code>), do the following:</p>
<ol type="1">
<li><p>Find out how many earthquakes of magnitude equal or larger than 7 have occurred in the Northern Hemisphere in 2011.</p></li>
<li><p>What was the average magnitude of all earthquakes that occurred in Japan in 2011? (Tip: make sure you enlarge the <code>event</code> column of the attribute table to the whole values).</p></li>
<li><p>Create a new <code>Text (string)</code> attribute that indicates if an earthquake is located on the western (<code>W</code>) or eastern (<code>E</code>) hemisphere.</p></li>
</ol>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./sec_w2_vectors.html" class="pagination-link" aria-label="Week 2 - Vector data">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Week 2 - Vector data</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./lab_vectors_2.html" class="pagination-link" aria-label="Lab 4: Working with vector geometries">
        <span class="nav-page-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Lab 4: Working with vector geometries</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>